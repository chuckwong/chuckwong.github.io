<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>EPI 5.1 | The Dutch National Flag Problem | 猫呆 Forkercat | Blog</title><meta name="author" content="Junhao Wang"><meta name="copyright" content="Junhao Wang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Reference: EPI 5.1 Description: The quicksort algorithm would have a bad performance when the array contains many duplicates because the subarrays may differ greatly in size. One solution is reorder">
<meta property="og:type" content="website">
<meta property="og:title" content="EPI 5.1 | The Dutch National Flag Problem">
<meta property="og:url" content="http://www.junhaow.com/lc/problems/array/in-place-removal-and-swapping/epi_5_1-the-dutch-national-flag-problem.html">
<meta property="og:site_name" content="猫呆 Forkercat | Blog">
<meta property="og:description" content="Reference: EPI 5.1 Description: The quicksort algorithm would have a bad performance when the array contains many duplicates because the subarrays may differ greatly in size. One solution is reorder">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://www.junhaow.com/img/banner/banner_1.jpg">
<meta property="article:published_time" content="2020-04-17T20:45:11.804Z">
<meta property="article:modified_time" content="2019-11-19T04:37:15.000Z">
<meta property="article:author" content="Junhao Wang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.junhaow.com/img/banner/banner_1.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://www.junhaow.com/lc/problems/array/in-place-removal-and-swapping/epi_5_1-the-dutch-national-flag-problem"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-146643833-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-146643833-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '11/18/2019 20:37'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">50</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">118</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/studynotes/"><i class="fa-fw fas fa-pencil-alt"></i><span> Study Notes</span></a></div><div class="menus_item"><a class="site-page" href="/lc/"><i class="fa-fw fas fa-list"></i><span> LeetCode Book</span></a></div><div class="menus_item"><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games I've Played</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-grin-squint"></i><span> About Me</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-home-page" id="page-header" style="background-image: url('/img/banner/banner_1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">猫呆 Forkercat | Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/studynotes/"><i class="fa-fw fas fa-pencil-alt"></i><span> Study Notes</span></a></div><div class="menus_item"><a class="site-page" href="/lc/"><i class="fa-fw fas fa-list"></i><span> LeetCode Book</span></a></div><div class="menus_item"><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games I've Played</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-grin-squint"></i><span> About Me</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="page-site-info"><h1 id="site-title">EPI 5.1 | The Dutch National Flag Problem</h1></div></header><main class="layout" id="content-inner"><div id="page"><div id="article-container"><br>

<p>Reference: <span class="gray">EPI 5.1</span></p>
<p><strong>Description:</strong></p>
<p>The quicksort algorithm would have a bad performance when the array contains many duplicates because the subarrays may differ greatly in size.</p>
<p>One solution is reordering or shuffling the array before sorting. Another solution is known as Dutch national flag partitioning since the Dutch national flag consists of three horizontal bands (red, white, blue).</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/61a7y.png" title="The Dutch National Flag"></p>
<p>Let say an example <code>[0, 1, 2, 0, 2, 1, 1]</code>, and the pivot index is $3$ (<code>A[3] = 0</code>), so the correct partitioning is <code>[0, 0, 1, 2, 2, 1, 1]</code>. The elements larger than $0$ should be after $0$, but the ordering does not matter.</p>
<p>If the pivot index is $1$ (<code>A[1] = 1</code>), so the correct partitioning is <code>[0, 0, 1, 1, 1, 2, 2]</code>.</p>
<p>We have three groups: <code>smaller</code>, <code>equal</code>, <code>larger</code>. To simply the problem we have a enum class as follows:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Color</span> </span>&#123; RED, WHITE, BLUE &#125;</span><br><span class="line"><span class="comment">// their ordinal()   0     1     2</span></span><br></pre></td></tr></table></figure>

<p>We use <code>RED</code> to denote elements in the <code>smaller</code> group. They could be duplicates or different elements, but that is okay as long as they are less than the <code>WHITE</code> elements in the <code>equal</code> group.</p>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<p>Write a problem that takes an array <code>A</code> and an index <code>i</code> into <code>A</code>, and rearranges the elements such that all elements less than <code>A[i]</code> (the “pivot”) appear first, followed by elements equal to the pivot, followed by elements greater than the pivot.</p>
</blockquote>
<p><strong>Note:</strong> The problem is trivial to solve with $O(N)$ extra space. We can put elements into three arrays and then merge them.</p>
<h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><h3 id="Brute-Force"><a href="#Brute-Force" class="headerlink" title="Brute-Force"></a>Brute-Force</h3><p>We can avoid the extra space. In the first pass, we iterate through the array and seek an element smaller than the pivot. As soon as we find it, we move it to the subarray of smaller elements via swapping. In the second pass, we do the same thing but moving the larger element to the subarray of larger elements.</p>
<p><strong>Note:</strong> In the second pass, we can stop when hitting an element smaller than the pivot, because smaller elements should all lie on the left part of the array.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">dutchFlagPartition</span><span class="params">(<span class="keyword">int</span> pivotIndex, List&lt;Color&gt; A)</span> </span>&#123;</span><br><span class="line">  Color pivot = A.get(pivotIndex);</span><br><span class="line">  <span class="comment">// First pass: group elements smaller than pivot.</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.size(); ++i) &#123;</span><br><span class="line">    <span class="comment">// Look for a smaller element</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; A.size(); ++j) &#123;</span><br><span class="line">      <span class="keyword">if</span> (A.get(j).ordinal() &lt; pivot.ordinal()) &#123;</span><br><span class="line">        Collections.swap(A, i, j);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Second pass: group elements larger than pivot.</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = A.size()  - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">    <span class="comment">// Stop when hitting an element smaller than the pivot.</span></span><br><span class="line">    <span class="keyword">if</span> (A.get(i).ordinal() &lt; pivot.ordinal()) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">      <span class="keyword">if</span> (A.get(j).ordinal() &gt; pivot.ordinal()) &#123;</span><br><span class="line">        Collections.swap(A, i, j);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Time:</strong> $O(N^2)$<br><strong>Space:</strong> $O(1)$</p>
<p>The worst case occurs when the pivot is in the middle and all elements on its left are larger and the elements on its right are smaller, for example <code>[5, 6, 9, 7, &lt;5&gt;, 3, 2, 4, 1]</code>. As for the first element (<code>i = 0</code>), <code>j</code> has to go through half of the array, which takes $O(N/2)$ time, to find element <code>3</code>.</p>
<h3 id="Two-Passes"><a href="#Two-Passes" class="headerlink" title="Two Passes"></a>Two Passes</h3><p>We can improve the time complexity by making a single pass to move smaller elements to the beginning and by making another pass starting from the end to move larger elements to the end.</p>
<p>Alternatively, in the second pass, we can instead move elements which are equal to the pivot, so we don’t need an extra variable to store the current index.</p>
<p><strong>Note:</strong> The element in the original <code>pivotIndex</code> may change when the pivot element is swapped. It does not affect the result since we have backed up the pivot at the beginning of the program, so the value of pivot won’t change.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Example:  2  6  3  7  &lt;5&gt;  3  2  7  1</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">dutchFlagPartition</span><span class="params">(<span class="keyword">int</span> pivotIndex, List&lt;Color&gt; A)</span> </span>&#123;</span><br><span class="line">  Color pivot = A.get(pivotIndex); <span class="comment">// back up the pivot</span></span><br><span class="line">  <span class="comment">// First pass</span></span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.size(); ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (A.get(i).ordinal() &lt; pivot.ordinal()) &#123;</span><br><span class="line">      Collections.swap(A, i, count++);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="comment">// now &quot;count&quot; is pointing to first position of the &quot;equal&quot; group</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Second pass - Move elements equal to pivot</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = count; i &lt; A.size(); ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (A.get(i).ordinal() == pivot.ordinal()) &#123;</span><br><span class="line">      Collections.swap(A, i, count++);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// larger elements are automatically arranged.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Time:</strong> $O(N)$<br><strong>Space:</strong> $O(1)$</p>
<h3 id="One-Pass"><a href="#One-Pass" class="headerlink" title="One Pass"></a>One Pass</h3><p>Similar to the two-pass approach, the difference is that it performs classification into elements <code>less than</code>, <code>equal to</code>, and <code>greater than</code> the pivot in a single pass. We can do this by maintaining four subarrays: <code>smaller</code>, <code>equal</code>, <code>unclassified</code>, <code>larger</code>. In the code, we use three pointers <code>smaller</code>, <code>equal</code>, <code>larger</code> to denote the elements in the four subarrays.</p>
<p>The explanation is in the comments. Notice the <code>equal</code> always points to the incoming unclassified element. And the elements before <code>smaller</code> and the elements after <code>larger</code> are finalized.</p>
<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>   <span class="number">6</span>   <span class="number">3</span>   <span class="number">7</span>  &lt;<span class="number">5</span>&gt;  <span class="number">3</span>   <span class="number">2</span>   <span class="number">7</span>   <span class="number">1</span></span><br><span class="line">sm                              lg</span><br><span class="line">eq</span><br><span class="line"><span class="number">2</span>   <span class="number">6</span>   <span class="number">3</span>   <span class="number">7</span>  &lt;<span class="number">5</span>&gt;  <span class="number">3</span>   <span class="number">2</span>   <span class="number">7</span>   <span class="number">1</span></span><br><span class="line">    sm                          lg</span><br><span class="line">    eq</span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>   <span class="number">3</span>   <span class="number">7</span>  &lt;<span class="number">5</span>&gt;  <span class="number">3</span>   <span class="number">2</span>   <span class="number">7</span>   <span class="number">6</span></span><br><span class="line">    sm                      lg</span><br><span class="line">    eq</span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>   <span class="number">3</span>   <span class="number">7</span>  &lt;<span class="number">5</span>&gt;  <span class="number">3</span>   <span class="number">2</span>   <span class="number">7</span>   <span class="number">6</span></span><br><span class="line">        sm                  lg</span><br><span class="line">        eq</span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>   <span class="number">3</span>   <span class="number">7</span>  &lt;<span class="number">5</span>&gt;  <span class="number">3</span>   <span class="number">2</span>   <span class="number">7</span>   <span class="number">6</span></span><br><span class="line">            sm              lg</span><br><span class="line">            eq</span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>   <span class="number">3</span>   <span class="number">7</span>  &lt;<span class="number">5</span>&gt;  <span class="number">3</span>   <span class="number">2</span>   <span class="number">7</span>   <span class="number">6</span></span><br><span class="line">            sm          lg</span><br><span class="line">            eq</span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>   <span class="number">3</span>   <span class="number">2</span>  &lt;<span class="number">5</span>&gt;  <span class="number">3</span>   <span class="number">7</span>   <span class="number">7</span>   <span class="number">6</span></span><br><span class="line">            sm      lg</span><br><span class="line">            eq</span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>   <span class="number">3</span>   <span class="number">2</span>  &lt;<span class="number">5</span>&gt;  <span class="number">3</span>   <span class="number">7</span>   <span class="number">7</span>   <span class="number">6</span></span><br><span class="line">                sm  lg</span><br><span class="line">                eq</span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>   <span class="number">3</span>   <span class="number">2</span>  &lt;<span class="number">5</span>&gt;  <span class="number">3</span>   <span class="number">7</span>   <span class="number">7</span>   <span class="number">6</span></span><br><span class="line">                sm  lg</span><br><span class="line">                    eq</span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>   <span class="number">3</span>   <span class="number">2</span>   <span class="number">3</span>  &lt;<span class="number">5</span>&gt;  <span class="number">7</span>   <span class="number">7</span>   <span class="number">6</span></span><br><span class="line">                    sm</span><br><span class="line">                    lg</span><br><span class="line">                        eq       <span class="comment">// end</span></span><br></pre></td></tr></table></figure>

<p><strong>Note:</strong> This is my solution based on <code>larger = A.size() - 1</code> and <code>while (equal &lt;= larger)</code>. The solution in the book is based on <code>larger = A.size()</code> and <code>while (equal &lt; larger)</code>. They are equivalent.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">dutchFlagPartition</span><span class="params">(<span class="keyword">int</span> pivotIndex, List&lt;Color&gt; A)</span> </span>&#123;</span><br><span class="line">  Color pivot = A.get(pivotIndex);</span><br><span class="line">  <span class="keyword">int</span> smaller = <span class="number">0</span>, equal = <span class="number">0</span>, larger = A.size() - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (equal &lt;= larger) &#123;</span><br><span class="line">    <span class="comment">// A.get(equal) is the incoming unclassified element</span></span><br><span class="line">    <span class="keyword">if</span> (A.get(equal).ordinal() &lt; pivot.ordinal()) &#123;</span><br><span class="line">      Collections.swap(A, equal++, smaller++);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (A.get(equal).ordinal() &gt; pivot.ordinal()) &#123;</span><br><span class="line">      Collections.swap(A, equal, larger--); <span class="comment">// equal not changing since its element is not processed</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// A.get(equal).ordinal() == pivot.ordinal()</span></span><br><span class="line">      equal += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Time:</strong> $O(N)$ since each time at least one of the pointers is moved and each subarray is either expended by one or shrunk by one.<br><strong>Space:</strong> $O(1)$</p>
<h2 id="Variant-1"><a href="#Variant-1" class="headerlink" title="Variant 1"></a>Variant 1</h2><p>Bring duplicate elements all together, but the ordering is not required.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">variant1</span><span class="params">(List&lt;Color&gt; A)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (A.size() == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (count &lt; A.size()) &#123;</span><br><span class="line">    Color curr = A.get(count);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = count; i &lt; A.size(); ++i) &#123;</span><br><span class="line">      <span class="keyword">if</span> (A.get(i).ordinal() == curr.ordinal()) &#123;</span><br><span class="line">        Collections.swap(A, i, count++);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Time:</strong> $O(N)$<br><strong>Space:</strong> $O(1)$</p>
</div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Junhao Wang</div><div class="author-info__description">Debug the old world, bug the new world!</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">50</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">118</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/junhaowww"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://twitter.com/junhaowww" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a><a class="social-icon" href="https://www.linkedin.com/in/junhaowww" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a><a class="social-icon" href="https://www.douban.com/people/maodai" target="_blank" title="豆瓣（Book）"><i class="fa fa-book"></i></a><a class="social-icon" href="mailto:junhaowanggg@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-bolt"></i><span>Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            <a class="card-more-btn" href="/categories/" title="More">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Anything/"><span class="card-category-list-name">Anything</span><span class="card-category-list-count">10</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/C/"><span class="card-category-list-name">C</span><span class="card-category-list-count">18</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Math/"><span class="card-category-list-name">Math</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Music/"><span class="card-category-list-name">Music</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/OS/"><span class="card-category-list-name">OS</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python/"><span class="card-category-list-name">Python</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Reading-Notes/"><span class="card-category-list-name">Reading Notes</span><span class="card-category-list-count">5</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/i/" style="font-size: 1.1em; color: #999">++i</a> <a href="/tags/ANSI-C/" style="font-size: 1.1em; color: #999">ANSI C</a> <a href="/tags/Abstract-Class/" style="font-size: 1.1em; color: #999">Abstract Class</a> <a href="/tags/Argument/" style="font-size: 1.1em; color: #999">Argument</a> <a href="/tags/AutoLayout/" style="font-size: 1.1em; color: #999">AutoLayout</a> <a href="/tags/C/" style="font-size: 1.5em; color: #99a9bf">C</a> <a href="/tags/C-Traps-and-Pitfalls/" style="font-size: 1.5em; color: #99a9bf">C Traps and Pitfalls</a> <a href="/tags/C11/" style="font-size: 1.1em; color: #999">C11</a> <a href="/tags/C89/" style="font-size: 1.1em; color: #999">C89</a> <a href="/tags/C90/" style="font-size: 1.1em; color: #999">C90</a> <a href="/tags/C99/" style="font-size: 1.1em; color: #999">C99</a> <a href="/tags/CPU-%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/" style="font-size: 1.1em; color: #999">CPU 工作模式</a> <a href="/tags/Calculus/" style="font-size: 1.1em; color: #999">Calculus</a> <a href="/tags/Compute-Shader/" style="font-size: 1.1em; color: #999">Compute Shader</a> <a href="/tags/Covariant/" style="font-size: 1.1em; color: #999">Covariant</a> <a href="/tags/English/" style="font-size: 1.1em; color: #999">English</a> <a href="/tags/Expert-C-Programming/" style="font-size: 1.5em; color: #99a9bf">Expert C Programming</a> <a href="/tags/GCD/" style="font-size: 1.1em; color: #999">GCD</a> <a href="/tags/GRE/" style="font-size: 1.1em; color: #999">GRE</a> <a href="/tags/Grass/" style="font-size: 1.1em; color: #999">Grass</a> <a href="/tags/Hexo/" style="font-size: 1.1em; color: #999">Hexo</a> <a href="/tags/Interface/" style="font-size: 1.1em; color: #999">Interface</a> <a href="/tags/Iteration/" style="font-size: 1.1em; color: #999">Iteration</a> <a href="/tags/Java/" style="font-size: 1.5em; color: #99a9bf">Java</a> <a href="/tags/K-R-C/" style="font-size: 1.1em; color: #999">K&R C</a> <a href="/tags/LinkedList/" style="font-size: 1.1em; color: #999">LinkedList</a> <a href="/tags/Logic/" style="font-size: 1.1em; color: #999">Logic</a> <a href="/tags/Mac/" style="font-size: 1.5em; color: #99a9bf">Mac</a> <a href="/tags/Markdown/" style="font-size: 1.1em; color: #999">Markdown</a> <a href="/tags/Mou/" style="font-size: 1.1em; color: #999">Mou</a> <a href="/tags/Multivarible-Calculus/" style="font-size: 1.1em; color: #999">Multivarible Calculus</a> <a href="/tags/Probability/" style="font-size: 1.1em; color: #999">Probability</a> <a href="/tags/Protected-Mode/" style="font-size: 1.1em; color: #999">Protected Mode</a> <a href="/tags/Python/" style="font-size: 1.1em; color: #999">Python</a> <a href="/tags/Real-Mode/" style="font-size: 1.1em; color: #999">Real Mode</a> <a href="/tags/Recursion/" style="font-size: 1.1em; color: #999">Recursion</a> <a href="/tags/Shader/" style="font-size: 1.1em; color: #999">Shader</a> <a href="/tags/Sky/" style="font-size: 1.1em; color: #999">Sky</a> <a href="/tags/Stack/" style="font-size: 1.1em; color: #999">Stack</a> <a href="/tags/TypeFu/" style="font-size: 1.1em; color: #999">TypeFu</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">50</div></div><div class="webinfo-item"><div class="item-name">Total Count :</div><div class="item-count">82.3k</div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-04-11T20:53:54.905Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2015 - 2021 By Junhao Wang</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">return 0;</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'http://www.junhaow.com/lc/problems/array/in-place-removal-and-swapping/epi_5_1-the-dutch-national-flag-problem.html'
    this.page.identifier = 'lc/problems/array/in-place-removal-and-swapping/epi_5_1-the-dutch-national-flag-problem.html'
    this.page.title = 'EPI 5.1 | The Dutch National Flag Problem'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://junhaow.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Disqus' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[link]') // replace url
    content = content.replace(/<code>.*?<\/code>/gi, '[code]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    fetch('https://disqus.com/api/3.0/forums/listPosts.json?forum=junhaow&related=thread&limit=6&api_key=9AouxDFpQCAlmHWv0HK3jV1Pp4Yq4T7kGncBGbAzFOXAeZTSKkt9YWshqSYb68Rq')
      .then(response => response.json())
      .then(data => {
        const disqusArray = data.response.map(item => {
          return {
            'avatar': item.author.avatar.cache,
            'content': changeContent(item.message),
            'nick': item.author.name,
            'url': item.url,
            'date': item.createdAt
          }
        })

        saveToLocal.set('disqus-newest-comments', JSON.stringify(disqusArray), 10/(60*24))
        generateHtml(disqusArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "Unable to get the data, please make sure the settings are correct."
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'No Comment'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('disqus-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>