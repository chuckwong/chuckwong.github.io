<!DOCTYPE html>
<html lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:300,300italic,400,400italic,700,700italic|Bitter:300,300italic,400,400italic,700,700italic|Menlo:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-bounce.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.junhaow.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Reference: LeetCodeDifficulty: Easy Problem You are given a binary tree in which each node contains an integer value. Find the number of paths that sum to a given value.   The path does not need to">
<meta property="og:type" content="website">
<meta property="og:title" content="437. Path Sum III">
<meta property="og:url" content="http://www.junhaow.com/lc/problems/tree/sum-and-path/437_path-sum-iii.html">
<meta property="og:site_name" content="B_L_OO_GGG">
<meta property="og:description" content="Reference: LeetCodeDifficulty: Easy Problem You are given a binary tree in which each node contains an integer value. Find the number of paths that sum to a given value.   The path does not need to">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/trddy.jpg">
<meta property="article:published_time" content="2020-04-17T20:45:12.480Z">
<meta property="article:modified_time" content="2019-07-05T01:03:47.000Z">
<meta property="article:author" content="Junhao Wang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/trddy.jpg">

<link rel="canonical" href="http://www.junhaow.com/lc/problems/tree/sum-and-path/437_path-sum-iii">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>437. Path Sum III | B_L_OO_GGG
</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-146643833-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-146643833-1');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">B_L_OO_GGG</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Sumomo mo momo mo no uchi</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-inbox fa-fw"></i>Archives<span class="badge">50</span></a>

  </li>
        <li class="menu-item menu-item-studynotes">

    <a href="/studynotes/" rel="section"><i class="fa fa-pencil-alt fa-fw"></i>Study Notes</a>

  </li>
        <li class="menu-item menu-item-lc">

    <a href="/lc/" rel="section"><i class="fa fa-th fa-fw"></i>LeetCode Book</a>

  </li>
        <li class="menu-item menu-item-games">

    <a href="/games/" rel="section"><i class="fa fa-gamepad fa-fw"></i>Games I've Played</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-grin-squint fa-fw"></i>About Me</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
  
  

          <div class="content page posts-expand">
            

    
    
    
    <div class="post-block" lang="en">
      <header class="post-header">

<h1 class="post-title" itemprop="name headline">437. Path Sum III
</h1>

<div class="post-meta">
  
  <ul class="breadcrumb">
          
            <li><a href="/lc/">LC</a></li>
            <li><a href="/lc/problems/">PROBLEMS</a></li>
            <li><a href="/lc/problems/tree/">TREE</a></li>
            <li><a href="/lc/problems/tree/sum-and-path/">SUM-AND-PATH</a></li>
            <li>437_PATH-SUM-III</li>
          
  </ul>

</div>

</header>

      
      
      
      <div class="post-body">
          <br>

<p>Reference: <a target="_blank" rel="noopener" href="https://leetcode.com/problems/path-sum-iii/">LeetCode</a><br>Difficulty: <span class="green">Easy</span></p>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<p>You are given a binary tree in which each node contains an integer value. Find the number of paths that sum to a given value.</p>
</blockquote>
<blockquote>
<p>The path does not need to start or end at the root or a leaf, but it must go downwards (traveling only from parent nodes to child nodes).</p>
</blockquote>
<blockquote>
<p>The tree has no more than 1,000 nodes and the values are in the range -1,000,000 to 1,000,000.</p>
</blockquote>
<p><strong>Example:</strong> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root = [<span class="number">10</span>,<span class="number">5</span>,-<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="keyword">null</span>,<span class="number">11</span>,<span class="number">3</span>,-<span class="number">2</span>,<span class="keyword">null</span>,<span class="number">1</span>], sum = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">      <span class="number">10</span></span><br><span class="line">     /  \</span><br><span class="line">    <span class="number">5</span>   -<span class="number">3</span></span><br><span class="line">   / \    \</span><br><span class="line">  <span class="number">3</span>   <span class="number">2</span>   <span class="number">11</span></span><br><span class="line"> / \   \</span><br><span class="line"><span class="number">3</span>  -<span class="number">2</span>   <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Return <span class="number">3.</span> The paths that sum to <span class="number">8</span> are:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>  <span class="number">5</span> -&gt; <span class="number">3</span></span><br><span class="line"><span class="number">2.</span>  <span class="number">5</span> -&gt; <span class="number">2</span> -&gt; <span class="number">1</span></span><br><span class="line"><span class="number">3.</span> -<span class="number">3</span> -&gt; <span class="number">11</span></span><br></pre></td></tr></table></figure>

<p><strong>Follow up:</strong> </p>
<ul>
<li>Reduce the time complexity.</li>
</ul>
<h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><blockquote>
<p>By <a target="_blank" rel="noopener" href="https://leetcode.com/problems/path-sum-iii/discuss/91889/Simple-Java-DFS">fudonglai</a>:<br>写递归的技巧是：明白一个函数的作用并相信它能完成这个任务，千万不要跳进这个函数里面企图探究更多细节，否则就会陷入无穷的细节无法自拔。你就算浑身是铁，能压几个栈？<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzU0MDg5OTYyOQ==&mid=100000105&idx=1&sn=83337f6a4486d4433378491a2ae395dc&chksm=7b33612b4c44e83d7afe591454829ff3e26253bdebd8304e5eb87d4083668cb0712a2c0b8096#rd">more</a></p>
<p>按照前面说的技巧，先来定义清楚每个递归函数应该做的事：</p>
<p>pathSum 函数：给他一个节点和一个目标值，他返回以这个节点为根的树中，和为目标值的路径总数。<br>count 函数：给他一个节点和一个目标值，他返回以这个节点为根的树中，能凑出几个以该节点为路径开头，和为目标值的路径总数。</p>
</blockquote>
<p><strong>Methods:</strong></p>
<ol>
<li>Typical Recursion<ul>
<li>First, we should define each recursive function’s job.</li>
<li><code>pathSum(x, target)</code>: Return the number of paths that satisfy <code>target</code> requirement in a tree whose root is <code>x</code>.</li>
<li><code>count(x, target)</code>: Return the number of paths that satisfy <code>target</code> requirement in a tree whose root <strong>must be</strong> <code>x</code>, the head of those paths.</li>
<li><strong>Time:</strong> <code>11 ms</code><ul>
<li>In each level in tree, as you go down, $N$ is halved, and finally you call <code>count(x, target)</code> for the leaves whose cost is $T(1)$ (not all the same $N$). Each layer does $O(N)$, and in the best case there are $\log{N}$ layers.</li>
<li>According to the master theorem, <ul>
<li><code>pathSum()</code>: $T(N) = 2T(N/2) + O(N) = O(N\log{N})$</li>
<li><code>count()</code>: $T(N) = 2T(N/2) + O(1)$</li>
</ul>
</li>
<li>Best: $O(N\log{N})$</li>
<li>Worst: $O(N^2)$</li>
</ul>
</li>
<li><strong>Space:</strong> $O(h)$</li>
</ul>
</li>
<li>HashMap + Prefix Sum (<a target="_blank" rel="noopener" href="https://leetcode.com/problems/path-sum-iii/discuss/91878/">tankztc &amp; kekezi</a>)<ul>
<li><strong>Time:</strong> $O(N)$ <code>4 ms</code></li>
<li><strong>Space:</strong> $O(N)$</li>
<li>The idea is similar as Two Sum, using <code>HashMap</code> to store keys (the prefix sum) and values (how many ways to get to this prefix sum). </li>
<li>The <code>prefix sum</code> stores the sum from the root to the current node in the recursion.</li>
<li>Whenever we reach a node, we check if <code>prefix sum - target</code> exists in the HashMap. <ul>
<li>If it does, we added up the ways of <code>prefix sum - target</code> into result.</li>
<li>For example:<ul>
<li>In one path we have: <code>[1, 2, -1, -1, 2]</code>,</li>
<li>then the prefix sum will be: <code>[1, 3,  2,  1, 3]</code>.</li>
<li>Let’s say we want to find target sum $2$, then we have $4$ paths which are <code>2</code>, <code>1,2,-1</code>, <code>2,-1,-1,2</code>, and <code>2</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>
<li>The sum from any node in the middle of the path to the current node<ul>
<li>$=$ (the sum from the root to the current node) $-$ (the prefix sum of the node in the middle)</li>
</ul>
</li>
<li>We want the difference above equal to the target value. In addition, we need to know how many differences are equal to the target value.</li>
<li>Use <code>HashMap</code>. The <code>value</code> of map stores the frequency of all possible sum in the path to the current node. If the difference we want exists, there must exist a node in the middle of the path, such that from this node to the current node, the sum is equal to the target value.</li>
<li>There might be multiple nodes in the middle that satisfy the requirement. In each recursion, the map stores all information we need to calculate the number of ranges that sum up to target (start from a middle node and end by the current node).</li>
<li>To get the total number of a path count, we add up the number of valid paths ended by <code>each</code> node in the tree.</li>
<li>Each recursion returns the total count of valid paths in the subtree rooted at the current node. And this sum can be divided into three parts:<ul>
<li>The total number of valid paths in the subtree rooted at the current node’s left child.</li>
<li>The total number of valid paths in the subtree rooted at the current node’s right child.</li>
<li>The number of valid paths ended by the current node.</li>
</ul>
</li>
<li>The interesting part of this solution is that the prefix is counted from root to leaves, and the result of total count is calculated from the bottom to the top.</li>
</ul>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><h3 id="Typical-Recursion"><a href="#Typical-Recursion" class="headerlink" title="Typical Recursion"></a>Typical Recursion</h3><h4 id="Incorrect-Version"><a href="#Incorrect-Version" class="headerlink" title="Incorrect Version"></a>Incorrect Version</h4><p>First, let’s examine <strong>an incorrect version</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pathSum</span><span class="params">(TreeNode root, <span class="keyword">int</span> sum)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> pathSum(root, sum, sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">pathSum</span><span class="params">(TreeNode root, <span class="keyword">int</span> sum, <span class="keyword">int</span> oldSum)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// root</span></span><br><span class="line">  <span class="keyword">int</span> r0 = root.val == sum ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// left</span></span><br><span class="line">  <span class="keyword">int</span> r1 = pathSum(root.left, sum - root.val, oldSum);</span><br><span class="line">  <span class="keyword">int</span> r2 = pathSum(root.left, oldSum, oldSum); <span class="comment">// start from left</span></span><br><span class="line">  <span class="comment">// right</span></span><br><span class="line">  <span class="keyword">int</span> r3 = pathSum(root.right, sum - root.val, oldSum);</span><br><span class="line">  <span class="keyword">int</span> r4 = pathSum(root.right, oldSum, oldSum);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> r0 + r1 + r2 + r3 + r4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Input = [<span class="number">1</span>,<span class="keyword">null</span>,<span class="number">2</span>,<span class="keyword">null</span>,<span class="number">3</span>]</span><br><span class="line">Output = <span class="number">2</span> (the code outputs <span class="number">3</span>)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"> \</span><br><span class="line">  <span class="number">2</span></span><br><span class="line">   \</span><br><span class="line">    <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>Call Stack:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">p(<span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">   r0=<span class="number">0</span>, r1=<span class="number">0</span>, r2=<span class="number">0</span></span><br><span class="line">   r3 = p(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// continue with node 1</span></span><br><span class="line">           r0=<span class="number">1</span>, r1=<span class="number">0</span>, r2=<span class="number">0</span></span><br><span class="line">           r3 = p(<span class="number">3</span>, <span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">                   r0=<span class="number">0</span>, r1=<span class="number">0</span>, r2=<span class="number">0</span>, r3=<span class="number">0</span></span><br><span class="line">                   = <span class="number">0</span></span><br><span class="line">           r4 = p(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>) <span class="comment">// here</span></span><br><span class="line">                   r0=<span class="number">1</span>, r1=<span class="number">0</span>, r2=<span class="number">0</span>, r3=<span class="number">0</span></span><br><span class="line">                   = <span class="number">1</span></span><br><span class="line">           = r0 + r4 = <span class="number">2</span></span><br><span class="line">   r4 = p(<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>) <span class="comment">// start over at node 2</span></span><br><span class="line">           r0=<span class="number">0</span>, r1=<span class="number">0</span>, r2=<span class="number">0</span></span><br><span class="line">           r3 = p(<span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line">                   r0=<span class="number">0</span>,r1=<span class="number">0</span>,r2=<span class="number">0</span>,r3=<span class="number">0</span></span><br><span class="line">                   = <span class="number">0</span></span><br><span class="line">           r4 = p(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>) <span class="comment">// here</span></span><br><span class="line">                   r0=<span class="number">1</span>, r1=<span class="number">0</span>, r2=<span class="number">0</span>, r3=<span class="number">0</span></span><br><span class="line">                   = <span class="number">1</span></span><br><span class="line">           = r4 = <span class="number">1</span></span><br><span class="line">   r3 + r4 = <span class="number">3</span></span><br><span class="line">= <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>We can see that there are repeated calculations.</p>
<ul>
<li><code>p(3, 3, 3)</code> called by <code>p(2, 2, 3)</code> called by <code>p(1, 3, 3)</code>.</li>
<li><code>p(3, 3, 3)</code> called by <code>p(2, 3, 3)</code> called by <code>p(1, 3, 3)</code>.</li>
</ul>
<h4 id="Correct-Version"><a href="#Correct-Version" class="headerlink" title="Correct Version"></a>Correct Version</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pathSum(): How many paths in a tree whose head is root satisfy?</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pathSum</span><span class="params">(TreeNode root, <span class="keyword">int</span> sum)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> rootNum = count(root, sum);  <span class="comment">// root as a leading head of any paths</span></span><br><span class="line">  <span class="keyword">int</span> leftNum = pathSum(root.left, sum); <span class="comment">// don&#x27;t need to know the details</span></span><br><span class="line">  <span class="keyword">int</span> rightNum = pathSum(root.right, sum);</span><br><span class="line">  <span class="keyword">return</span> rootNum + leftNum + rightNum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// count(): How many paths whose head is root satisfy?</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">(TreeNode root, <span class="keyword">int</span> sum)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> rootNum = (root.val == sum) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> leftNum = count(root.left, sum - root.val);</span><br><span class="line">  <span class="keyword">int</span> rightNum = count(root.right, sum - root.val);</span><br><span class="line">  <span class="keyword">return</span> rootNum + leftNum + rightNum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>








<h3 id="HashMap-Prefix-Sum"><a href="#HashMap-Prefix-Sum" class="headerlink" title="HashMap + Prefix Sum"></a>HashMap + Prefix Sum</h3><p><strong>Note:</strong></p>
<ul>
<li>I am dead.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pathSum</span><span class="params">(TreeNode root, <span class="keyword">int</span> sum)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  HashMap&lt;Integer, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  map.put(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> findPathSum(root, <span class="number">0</span>, sum, map);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findPathSum</span><span class="params">(TreeNode curr, <span class="keyword">int</span> sum, <span class="keyword">int</span> target, Map&lt;Integer, Integer&gt; map)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (curr == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// update the prefix sum by adding the current value</span></span><br><span class="line">  sum += curr.val;</span><br><span class="line">  <span class="comment">// get the number of valid paths, ended by the current node</span></span><br><span class="line">  <span class="keyword">int</span> numPathToCurr = map.getOrDefault(sum - target, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">// update the map with the current sum, so the map is good to be passed to the next recursion</span></span><br><span class="line">  map.put(sum, map.getOrDefault(sum, <span class="number">0</span>) + <span class="number">1</span>); <span class="comment">// prefix sum</span></span><br><span class="line">  <span class="comment">// add the 3 parts</span></span><br><span class="line">  <span class="keyword">int</span> res = numPathToCurr + findPathSum(curr.left, sum, target, map) + findPathSum(curr.right, sum, target, map);</span><br><span class="line">  <span class="comment">// restore the map, as the recursion goes from the bottom to the top</span></span><br><span class="line">  map.put(sum, map.get(sum) - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/trddy.jpg"></p>

      </div>
      
      
      
    </div>
    
  <ul class="breadcrumb">
          
            <li><a href="/lc/">LC</a></li>
            <li><a href="/lc/problems/">PROBLEMS</a></li>
            <li><a href="/lc/problems/tree/">TREE</a></li>
            <li><a href="/lc/problems/tree/sum-and-path/">SUM-AND-PATH</a></li>
            <li>437_PATH-SUM-III</li>
          
  </ul>

    
    
    


          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Problem"><span class="nav-number">1.</span> <span class="nav-text">Problem</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Analysis"><span class="nav-number">2.</span> <span class="nav-text">Analysis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Code"><span class="nav-number">3.</span> <span class="nav-text">Code</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Typical-Recursion"><span class="nav-number">3.1.</span> <span class="nav-text">Typical Recursion</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Incorrect-Version"><span class="nav-number">3.1.1.</span> <span class="nav-text">Incorrect Version</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Correct-Version"><span class="nav-number">3.1.2.</span> <span class="nav-text">Correct Version</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HashMap-Prefix-Sum"><span class="nav-number">3.2.</span> <span class="nav-text">HashMap + Prefix Sum</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Junhao Wang"
      src="/images/cat_with_glasses.jpg">
  <p class="site-author-name" itemprop="name">Junhao Wang</p>
  <div class="site-description" itemprop="description">Debug the old world, bug the new world!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">50</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">118</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://twitter.com/junhaowww" title="Twitter → https://twitter.com/junhaowww" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/junhaowww" title="GitHub → https://github.com/junhaowww" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/junhaowww/" title="LinkedIn → https://www.linkedin.com/in/junhaowww/" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.douban.com/people/maodai/" title="豆瓣 (Book) → https://www.douban.com/people/maodai/" rel="noopener" target="_blank"><i class="fa fa-book fa-fw"></i>豆瓣 (Book)</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.jianshu.com/u/41865efdad5d/" title="https://www.jianshu.com/u/41865efdad5d/" rel="noopener" target="_blank">Xiaofud</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.davex.pw/" title="https://www.davex.pw/" rel="noopener" target="_blank">DaveX</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://" title="http://" rel="noopener" target="_blank">alexfan.xyz</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Junhao Wang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://junhaow.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "http://www.junhaow.com/lc/problems/tree/sum-and-path/437_path-sum-iii.html";
    this.page.identifier = "lc/problems/tree/sum-and-path/437_path-sum-iii.html";
    this.page.title = "437. Path Sum III";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://junhaow.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
