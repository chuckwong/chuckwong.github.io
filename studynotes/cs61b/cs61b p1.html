<!DOCTYPE html>




<html class="theme-next pisces" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-bounce.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,300italic,400,400italic,700,700italic|Bitter:300,300italic,400,400italic,700,700italic|Bitter:300,300italic,400,400italic,700,700italic|Menlo:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="junhaow, maodai">










<meta name="description" content="Focus: there is a problem; there is a way (it is a problem-solution tutorial). IntListIntList - Naked Recursive Structure Code: IntListEx.java IntList is a naked recursive data structure. When you c">
<meta property="og:type" content="website">
<meta property="og:title" content="CS 61B | Part 1 | List (Linked List &amp; Array List)">
<meta property="og:url" content="http://www.junhaow.com/studynotes/cs61b/cs61b p1.html">
<meta property="og:site_name" content="B_L_OO_GGG">
<meta property="og:description" content="Focus: there is a problem; there is a way (it is a problem-solution tutorial). IntListIntList - Naked Recursive Structure Code: IntListEx.java IntList is a naked recursive data structure. When you c">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/2kh5r.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/vxkux.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/sqev7.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/xasoy.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/xzc01.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/ivf0p.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/6eyic.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/b6as2.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/tce8u.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/v8n1c.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/ydb6i.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/i5kb8.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/eph4z.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/lrcux.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/ck60s.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/a3ihq.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/uqnk8.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/bcb9e.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/3tvoz.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/sqb13.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/tywpv.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/1xzg8.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/q64j6.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/vm8d7.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/5hwre.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/3wavc.jpg">
<meta property="og:updated_time" content="2020-03-26T05:22:15.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CS 61B | Part 1 | List (Linked List &amp; Array List)">
<meta name="twitter:description" content="Focus: there is a problem; there is a way (it is a problem-solution tutorial). IntListIntList - Naked Recursive Structure Code: IntListEx.java IntList is a naked recursive data structure. When you c">
<meta name="twitter:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/2kh5r.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.junhaow.com/studynotes/cs61b/cs61b p1.html">





  <title>CS 61B | Part 1 | List (Linked List & Array List) | B_L_OO_GGG</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-146643833-1', 'auto');
  ga('send', 'pageview');
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">


  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">B_L_OO_GGG</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Sumomo mo momo mo no uchi</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home


            

            

            

            

            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-inbox"></i> <br>
            
            Archives


            

            
              <span class="badge">50</span>
            

            

            

            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-studynotes">
          <a href="/studynotes/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-pencil"></i> <br>
            
            Study Notes


            

            

            
              <span class="badge">6</span>
            

            

            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-lc">
          <a href="/lc/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            LeetCode Book


            

            

            

            
              <span class="badge badge-lc">251 / âˆ</span>
            

            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-games">
          <a href="/games/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-gamepad"></i> <br>
            
            Games I've Played


            

            

            

            

            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-address-card"></i> <br>
            
            About Me


            

            

            

            

            
              <span class="badge-about">ğŸ‘‹</span>
            

          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h1 class="post-title" itemprop="name headline">CS 61B | Part 1 | List (Linked List & Array List)</h1>



</header>

      
      
      
      <div class="post-body">
        
        
          <p><br></p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/2kh5r.jpg" alt=""></p>
<p><code>Focus</code>: there is a problem; there is a way (it is a problem-solution tutorial).</p>
<h2 id="IntList"><a href="#IntList" class="headerlink" title="IntList"></a>IntList</h2><p>IntList - Naked Recursive Structure</p>
<p><strong>Code:</strong> <a href="https://github.com/junhaowww/cs61b-sp18/blob/master/classcode/w2/IntListEx.java" target="_blank" rel="noopener">IntListEx.java</a></p>
<p>IntList is a <code>naked recursive</code> data structure.</p>
<p>When you create a <code>public</code> member (i.e. method or variable), be careful, because youâ€™re effectively committing to supporting that memberâ€™s behavior exactly as it is now, forever.</p>
<p><strong>Lab 2 (IntList) Code:</strong></p>
<p>sqaureList &amp; catenate &amp; decatenate (iterative + recursive)</p>
<p><a href="https://github.com/junhaowww/cs61b-sp18/blob/master/lab2/Intlist/IntList.java" target="_blank" rel="noopener">IntList.java</a></p>
<p><code>å­˜å‚¨ç‰©ç†ç»“æ„/å½¢å¼</code>ï¼š</p>
<ul>
<li>List åˆ—è¡¨/çº¿æ€§è¡¨ï¼ˆSequenceï¼‰<ul>
<li>Array æ•°ç»„/é¡ºåºå­˜å‚¨ (ArrayList or AList)</li>
<li>Linked List é“¾è¡¨/é“¾å¼å­˜å‚¨ (LList, SLList, DLList)</li>
</ul>
</li>
</ul>
<p><code>é€»è¾‘ç»“æ„ï¼ˆæ“ä½œï¼‰</code>ï¼šï¼ˆå¯é€šè¿‡ä¸Šè€…å®ç°ï¼‰</p>
<ul>
<li>Queue é˜Ÿåˆ—</li>
<li>Stack æ ˆ</li>
</ul>
<h2 id="SLList"><a href="#SLList" class="headerlink" title="SLList"></a>SLList</h2><p>Add Bureaucracy to IntList</p>
<p>Basic Operations: <a href="https://github.com/junhaowww/cs61b-sp18/blob/master/classcode/w2/SLList.java" target="_blank" rel="noopener">SLList.java</a></p>
<h3 id="Nested-Class"><a href="#Nested-Class" class="headerlink" title="Nested Class"></a>Nested Class</h3><p>Note: There is a <code>static</code> modifier.</p>
<p><strong>Code:</strong> <a href="https://github.com/junhaowww/cs61b-sp18/blob/master/classcode/w2/Government.java" target="_blank" rel="noopener">Government.java</a> (code is below)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Government</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> treasury = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Thief and Explorer both know Government but not the instance object of Government */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Thief</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doStuff</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      Government tmp = <span class="keyword">null</span>; <span class="comment">// ok</span></span><br><span class="line">      tmp.treasury = <span class="number">0</span>; <span class="comment">// ok - specific object</span></span><br><span class="line">      treasury = <span class="number">0</span>; <span class="comment">// error - cannot access instance member</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Explorer</span> </span>&#123; <span class="comment">// ok</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doStuff</span><span class="params">(Government a, Government b)</span> </span>&#123;</span><br><span class="line">      Government favorite = Government.greaterTreasury(a, b);</span><br><span class="line">      System.out.println(<span class="string">"The best government has treasury "</span> + favorite.treasury);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>IntNode: <code>nested class</code> &amp; <code>static class</code>.</p>
<p><code>static nested class</code>: This saves a bit of memory, because each IntNode no longer needs to keep track of how to access its enclosing SLList (the specific instance, class &amp; other instances are accessible still).</p>
<h3 id="Sentinel"><a href="#Sentinel" class="headerlink" title="Sentinel"></a>Sentinel</h3><p><strong>Code:</strong> <a href="https://github.com/junhaowww/cs61b-sp18/blob/master/classcode/w2/SLList_Sentinel.java" target="_blank" rel="noopener">SLList_Sentinel.java</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Original - Without Sentinel */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  size += <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (first == <span class="keyword">null</span>) &#123;</span><br><span class="line">    first = <span class="keyword">new</span> IntNode(x, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  IntNode p = first;</span><br><span class="line">  <span class="keyword">while</span> (p.next != <span class="keyword">null</span>) &#123; <span class="comment">// need to stop at the last one</span></span><br><span class="line">    p = p.next;</span><br><span class="line">  &#125;</span><br><span class="line">  p.next = <span class="keyword">new</span> IntNode(x, <span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>With an <code>SLList</code>, we can now represent an empty list. We simply set <code>first</code> to <code>null</code> and <code>size</code> to <code>0</code>. However, we have introduced some <code>bugs or variants</code>; namely, because <code>first</code> is now <code>null</code>, any method that tries to access a property of <code>first</code> (like <code>first.item</code>) will return a <code>NullPointerException</code>.</p>
<p><strong>Solution:</strong></p>
<ul>
<li>Renamed first to be <code>sentinel</code></li>
<li>sentinel is never null, its <code>next</code> always points to sentinel node if the list is empty</li>
<li>Its item needs to be some integer (whatever)</li>
</ul>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/vxkux.jpg" alt=""></p>
<blockquote>
<p>A list head solves this problem. It is a list node that contains no actual data. A reference or pointer to the list is always a pointer to the head node. The first element of the list is always head.next. Usually the existence of the head is hidden in the class that implements a â€œlinked list with head.â€ (<a href="https://stackoverflow.com/questions/4973713/what-is-the-head-of-a-linked-list" target="_blank" rel="noopener">link</a>)</p>
<p>å“¨å…µé¡¾åæ€ä¹‰æœ‰å·¡é€»ã€æ£€æŸ¥çš„åŠŸèƒ½ï¼Œåœ¨æˆ‘ä»¬ç¨‹åºä¸­é€šè¿‡å¢åŠ å“¨å…µç»“ç‚¹å¾€å¾€èƒ½å¤Ÿ<code>ç®€åŒ–è¾¹ç•Œæ¡ä»¶</code>ï¼Œä»è€Œé˜²æ­¢å¯¹ç‰¹æ®Šæ¡ä»¶çš„åˆ¤æ–­ï¼Œä½¿ä»£ç æ›´ä¸ºç®€ä¾¿ä¼˜é›…ï¼Œåœ¨<code>é“¾è¡¨</code>ä¸­åº”ç”¨æœ€ä¸ºå…¸å‹ã€‚</p>
<p>å•é“¾è¡¨ä¸­çš„å“¨å…µç»“ç‚¹ï¼šé¦–å…ˆè®¨è®ºå“¨å…µç»“ç‚¹åœ¨å•é“¾è¡¨ä¸­çš„è¿ç”¨ï¼Œå¦‚æœä¸åŠ å“¨å…µç»“ç‚¹åœ¨è¿›è¡Œ<code>å¤´å°¾åˆ é™¤å’Œæ’å…¥</code>æ—¶éœ€è¦è¿›è¡Œç‰¹æ®Šåˆ¤æ–­ã€‚(<a href="https://www.w3xue.com/exp/article/201810/2262.html" target="_blank" rel="noopener">link</a>)</p>
</blockquote>
<ul>
<li>addFirst (no effect)</li>
<li><p>getFirst (no effect)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (sentinel.next == <span class="keyword">null</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> sentinel.next.item; <span class="comment">/* sentinel.next could be null */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong> Could be addressed by adding the second sentinel or make the first sentinel point to itself.</p>
</li>
<li><p>deleteFirst (no effect)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">deleteFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (sentinel.next == <span class="keyword">null</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>addLast (has effect)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IntNode p = sentinel; <span class="comment">/* if p.next is null, while-loop won't be executed */</span></span><br><span class="line"><span class="keyword">while</span> (p.next != <span class="keyword">null</span>) &#123; p = p.next; &#125; <span class="comment">/* p is not null */</span></span><br><span class="line">p.next = <span class="keyword">new</span> IntNode(x, <span class="keyword">null</span>);</span><br><span class="line">size += <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Invariant"><a href="#Invariant" class="headerlink" title="Invariant"></a>Invariant</h3><p>An <code>invariant</code> is a <code>fact</code> about a data structure that is <strong>guaranteed to be true</strong> (assuming there are no bugs in your code).</p>
<p>A <code>SLList</code> with a sentinel node has at least the following <code>invariants</code> / <code>guarantees</code>:</p>
<ul>
<li>The <code>sentinel</code> reference always points to a sentinel node.<ul>
<li>which means we can use this node (access its <code>item</code> and <code>next</code>)</li>
</ul>
</li>
<li>The first item (if it exists), is always at <code>sentinel.next.item</code>.</li>
<li>The <code>size</code> variable is always the total number of items that have been added.</li>
<li>Sentinel is <code>null</code> if the list is empty.</li>
</ul>
<p>Invariants make it easier to <strong>reason about code</strong>, and also give you specific goals to strive for in making sure your code works.</p>
<h3 id="Slow-removeLast"><a href="#Slow-removeLast" class="headerlink" title="Slow removeLast"></a>Slow removeLast</h3><p>Cache the last pointer! But itâ€™ll make code more complicated.</p>
<ul>
<li>For example: <code>addFirst</code> should update <code>last</code> for the first item in the list, but not in other cases.<ul>
<li>Itâ€™d better to use <code>circular sentinel</code> or <code>two sentinels</code>.</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> IntNode last;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  last.next = <span class="keyword">new</span> IntNode(x, <span class="keyword">null</span>);</span><br><span class="line">  last = last.next;</span><br><span class="line">  size += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Compare <code>addLast</code>, <code>getLast</code>, and <code>removeLast</code>, which one is the slowest?</p>
<p><strong>Answer:</strong> removeLast. Because <code>last</code> has no access to the previous nodeâ€™s next.</p>
<h2 id="DLList"><a href="#DLList" class="headerlink" title="DLList"></a>DLList</h2><p>What if we add a last pointer (just like the first node)? Not good enough.</p>
<h3 id="Doubly-Go-Back"><a href="#Doubly-Go-Back" class="headerlink" title="Doubly (Go Back)"></a>Doubly (Go Back)</h3><p>We only know the last node, but we need information to do:</p>
<ul>
<li>Set last 2nd nodeâ€™s next to null</li>
<li>Set last pointer</li>
</ul>
<p><strong>Solution: Add .prev</strong></p>
<p>DLList (doubly linked list)</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/sqev7.jpg" alt="" title="Summary of Improvements (so far)"></p>
<h3 id="Sentinel-Upgrade"><a href="#Sentinel-Upgrade" class="headerlink" title="Sentinel Upgrade"></a>Sentinel Upgrade</h3><p><code>Back pointers</code> allow a list to support adding, getting, and removing the front and back of a list in <code>constant time</code>.</p>
<p>There is a <code>subtle issue</code> with this design where the last pointer sometimes points at the sentinel node (empty list), and sometimes at a real node (special case).</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/xasoy.jpg" alt="" title="sentinel and last point to the same node"></p>
<p>Because the list is not <code>circular</code>! Here are some code for taking care of the last node.</p>
<ul>
<li><p>addFirst</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* L.addFirst(x) */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFirst</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  IntNode newNode = <span class="keyword">new</span> IntNode(x, sentinel.next);</span><br><span class="line">  <span class="comment">/* Set the prev of new node */</span></span><br><span class="line">  newNode.prev = sentinel;</span><br><span class="line">  <span class="comment">/* Set the prev of the previous first node - newNode.next may be null */</span></span><br><span class="line">  <span class="keyword">if</span> (newNode.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">    newNode.next.prev = newNode;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* Update Last */</span></span><br><span class="line">  last = sentinel.prev;</span><br><span class="line">  <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">    last = newNode;</span><br><span class="line">  &#125; <span class="comment">/* Otherwise, last stays the same */</span></span><br><span class="line">  size += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>getFirst</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* L.getFirst() */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* if size == 0, just return -1 */</span></span><br><span class="line">  <span class="keyword">if</span> (size == <span class="number">0</span>) &#123; <span class="comment">/* or sentinel == last */</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* if size &gt;= 1 */</span></span><br><span class="line">  <span class="keyword">return</span> sentinel.next.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>removeFirst</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* L.removeFirst() */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span> removeFirst &#123;</span><br><span class="line">  <span class="comment">/* if size == 0, just return -1 */</span></span><br><span class="line">  <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  IntNode removedNode = sentinel.next;</span><br><span class="line">  sentinel.next = removedNode.next; <span class="comment">/* it's maybe null */</span></span><br><span class="line">  <span class="comment">/* if size == 1, last is still pointing to removedNode */</span></span><br><span class="line">  <span class="keyword">if</span> (size == <span class="number">1</span>) &#123;</span><br><span class="line">    last = sentinel;</span><br><span class="line">  &#125; <span class="comment">/* Otherwise if size &gt; 2, last stays the same  */</span></span><br><span class="line">  size -= <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> removedNode.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>addLast</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* L.addLast(x) */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  IntNode newLast = <span class="keyword">new</span> IntNode(x, <span class="keyword">null</span>);</span><br><span class="line">  <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">    sentinel.next = newLast;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    last.prev.next = newLast; <span class="comment">/* not okay if size == 0 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  newLast.prev = last;</span><br><span class="line">  last = newLast;</span><br><span class="line">  size += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>getLast</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* L.getLast() */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getLast</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="comment">/* You may think what if we set sentinel.item to -1, so we don't need the "if" anymore (just return last.item) */</span></span><br><span class="line">    <span class="comment">/* However, it's just okay with getLast. What about other methods? It's not consistent! */</span></span><br><span class="line">    <span class="comment">/* last may point to sentinel and a real node both, while */</span></span><br><span class="line">    <span class="comment">/* sentinel.next always points to the first real node or null */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> last.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>removeLast</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* L.removeLast() */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">removeLast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (size == <span class="number">0</span>) &#123; <span class="comment">/* last.prev == null */</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* okay with size &gt;= 1 */</span></span><br><span class="line">  <span class="keyword">int</span> retItem = last.item; <span class="comment">/* the2ndLastNode may be sentinel */</span></span><br><span class="line">  IntNode the2ndLastNode = last.prev; <span class="comment">/* the2ndLastNode  */</span></span><br><span class="line">  the2ndLastNode.next = <span class="keyword">null</span>;</span><br><span class="line">  last = the2ndLastNode;</span><br><span class="line">  size -= <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> retItem;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>Solution:</strong> </p>
<p>Note: There is no <code>last</code> node here, since it breaks invariants.</p>
<ul>
<li><p>Add a <code>2nd sentinel</code> node to the back of the list.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/xzc01.jpg" alt=""></p>
</li>
<li><p>Use <code>circular sentinel</code> approach</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/ivf0p.jpg" alt=""><br>(Be careful of what the pointers are pointing at!)</p>
</li>
</ul>
<p>Both the two-sentinel and circular sentinel approaches work and result in code that is <code>free of ugly special cases</code>, though I personally find the circular approach to be cleaner and more aesthetically beautiful.</p>
<h3 id="Generic-Feature"><a href="#Generic-Feature" class="headerlink" title="Generic Feature"></a>Generic Feature</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DLList</span>&lt;<span class="title">BleepBlorp</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> IntNode sentinel;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntNode</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> IntNode prev;</span><br><span class="line">    <span class="keyword">public</span> BleepBlorp item;</span><br><span class="line">    <span class="keyword">public</span> IntNode next;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="AList"><a href="#AList" class="headerlink" title="AList"></a>AList</h2><h3 id="Array-In-Java"><a href="#Array-In-Java" class="headerlink" title="Array In Java"></a>Array In Java</h3><p><strong>Java Array:</strong> Arrays are a special kind of object which consists of a <code>numbered sequence</code> of memory boxes with <code>fixed</code> integer length.</p>
<p>Unlike other classes, arrays do not have methods.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Can omit the new if you are also declaring a variable</span></span><br><span class="line"><span class="keyword">int</span>[] w = &#123;<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/6eyic.jpg" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.arraycopy(b,  <span class="number">0</span>,  x,  <span class="number">3</span>,  <span class="number">2</span>);</span><br><span class="line"><span class="comment">//               src si  des di  len</span></span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong> Bound checking only happens in runtime.</p>
<p><strong>2D Array:</strong></p>
<p>Notice the difference:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[][] pascalsTriangle; <span class="comment">/* 1 array */</span></span><br><span class="line">pascalsTriangle = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">4</span>][]; <span class="comment">/* 4 null values */</span></span><br><span class="line"><span class="keyword">int</span>[] rowZero = pascalsTriangle[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">pascalsTriangle[<span class="number">0</span>] = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>&#125;;</span><br><span class="line">pascalsTriangle[<span class="number">1</span>] = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">pascalsTriangle[<span class="number">2</span>] = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">pascalsTriangle[<span class="number">3</span>] = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span>[][] pascalAgain = <span class="keyword">new</span> <span class="keyword">int</span>[][]&#123;&#123;<span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;&#125;; <span class="comment">/* 1 array */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 5 arrays */</span></span><br><span class="line"><span class="keyword">int</span>[][] matrix = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">4</span>][<span class="number">4</span>]; <span class="comment">/* 4 references to 4 zero arrays */</span></span><br></pre></td></tr></table></figure>
<h3 id="Performance-Puzzle"><a href="#Performance-Puzzle" class="headerlink" title="Performance Puzzle"></a>Performance Puzzle</h3><p>Performance Puzzle in Linked List:</p>
<p>It turns out that no matter how clever you are, the <code>get</code> method will usually be slower than <code>getBack</code> if weâ€™re using the doubly linked list structure.</p>
<p>This is because, since we only have references to the first and last items of the list, weâ€™ll always need to walk through the list from the front or back to get to the item that weâ€™re trying to retrieve.</p>
<p>In other words, our worst case execution time for <code>get</code> is linear in the size of the entire list. This in contrast to the runtime for <code>getBack</code>, which is constant, no matter the size of the list.</p>
<p><strong>The Way in which you should think:</strong></p>
<ul>
<li>Work out a <code>small example</code></li>
<li>Abstract the <code>pattern</code></li>
<li>Come up with <code>invariants</code><ul>
<li><code>addLast</code>: The next item we want to add, will go into position <code>size</code>.<ul>
<li>Remember to do <code>size += 1</code>.</li>
</ul>
</li>
<li><code>getLast</code>: The item we want to return is in position <code>size - 1</code>.</li>
<li><code>size</code>: The number of items in the list should be <code>size</code>.</li>
</ul>
</li>
</ul>
<p>Try to write <code>removeLast</code>. Before starting, decide which of <code>size</code>, <code>items</code>, and <code>items[i]</code> needs to change so that our <strong>invariants are preserved</strong> after the operation, i.e. so that future calls to our methods provide the user of the list class with the behavior they expect.</p>
<ul>
<li><code>size</code> should be decreased</li>
<li><code>items</code> should not be changed</li>
<li><code>items[i]</code> should not be changed (no need to â€œdestroyâ€ it)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AList</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">removeLast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> x = getLast();</span><br><span class="line">  size -= <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Resizing"><a href="#Resizing" class="headerlink" title="Resizing"></a>Resizing</h3><h4 id="Issue-1"><a href="#Issue-1" class="headerlink" title="Issue #1"></a>Issue #1</h4><p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/b6as2.jpg" alt=""></p>
<p>Raw implementation:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (size &gt;= items.length) &#123;</span><br><span class="line">    <span class="keyword">int</span>[] a = <span class="keyword">new</span> <span class="keyword">int</span>[size + <span class="number">100</span>];</span><br><span class="line">    System.arraycopy(items, <span class="number">0</span>, a, <span class="number">0</span>, size); <span class="comment">/* or items.length */</span></span><br><span class="line">    items = a;</span><br><span class="line">  &#125;</span><br><span class="line">  items[size] = x;</span><br><span class="line">  size += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Better encapsulation:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (size &gt;= items.length) &#123;</span><br><span class="line">    resize(size + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  items[size] = x;</span><br><span class="line">  size += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Resize the underlying array to the target capacity. */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span>[] a = <span class="keyword">new</span> <span class="keyword">int</span>[capacity];</span><br><span class="line">  System.arraycopy(items, <span class="number">0</span>, a, <span class="number">0</span>, size); <span class="comment">/* or items.length */</span></span><br><span class="line">  items = a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/tce8u.jpg" alt=""></p>
<p><strong>Geometric Resizing</strong></p>
<p>We can fix our performance problems by growing the size of our array by a <code>multiplicative amount</code>, rather than an <code>additive amount</code>.</p>
<p>Unusably bad (additive amount):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertBack</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (size == items.length) &#123;</span><br><span class="line">    resize(size + RFACTOR);</span><br><span class="line">  &#125;</span><br><span class="line">  items[size] = x;</span><br><span class="line">  size += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Great performance (multiplicative amount):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertBack</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (size == items.length) &#123;</span><br><span class="line">    resize(size * RFACTOR); <span class="comment">// = 2 will bring about great improvement</span></span><br><span class="line">  &#125;</span><br><span class="line">  items[size] = x;</span><br><span class="line">  size += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Issue-2"><a href="#Issue-2" class="headerlink" title="Issue #2"></a>Issue #2</h4><p>Suppose we have a very rare situation occur which causes us to:</p>
<ul>
<li>Insert 1,000,000,000 items</li>
<li>Then remove 990,000,000 items</li>
</ul>
<p>Our data structure will handle this spike of events as well as it could, but afterwards there is a problem.</p>
<p>An AList should not only be efficient in time, but also efficient in space.</p>
<ul>
<li>Define the <code>usage ratio</code> as R = size / items.length</li>
<li>Typical solution: Half array size when <code>R &lt; 0.25</code></li>
</ul>
<p>Later we will consider tradeoffs between time and space efficiency for a variety of algorithms and data structures.</p>
<h3 id="Generic-Array"><a href="#Generic-Array" class="headerlink" title="Generic Array"></a>Generic Array</h3><p>In Java, generic array is not supported. We need to do the casting</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">AList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  items = (T[]) <span class="keyword">new</span> Object[<span class="number">100</span>];</span><br><span class="line">  size = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Nulling-Out-Deleted-Items"><a href="#Nulling-Out-Deleted-Items" class="headerlink" title="Nulling Out Deleted Items"></a>Nulling Out Deleted Items</h3><p>Unlike integer based ALists, we actually want to null out deleted items. Since Java only destroys unwanted objects when the last reference has been lost. Save memory.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">removeLast</span><span class="params">()</span> </span>&#123; </span><br><span class="line">  <span class="keyword">if</span> (size == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">  size -= <span class="number">1</span>;</span><br><span class="line">  T removedItem = items[size];</span><br><span class="line">  items[size] = <span class="keyword">null</span>; <span class="comment">// here</span></span><br><span class="line">  <span class="keyword">return</span> removedItem;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Obscurantism"><a href="#Obscurantism" class="headerlink" title="Obscurantism"></a>Obscurantism</h3><p>We talk of <code>layers of abstraction</code> often in computer science. We also rely on obscurantism. The user of a class does not and should not know how it works.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/v8n1c.jpg" alt="" title="I like the picture"></p>
<p>In Java, we may use <code>private</code> to hide details.</p>
<h2 id="Discussion-3"><a href="#Discussion-3" class="headerlink" title="Discussion 3"></a>Discussion 3</h2><h3 id="SLList-1"><a href="#SLList-1" class="headerlink" title="SLList"></a>SLList</h3><p>The SLList allows us to hide away the <code>inner workings</code> of the linked list and also allows us to store <code>meta-information</code> about the list as a whole such as the size.</p>
<h3 id="Sentinel-Nodes"><a href="#Sentinel-Nodes" class="headerlink" title="Sentinel Nodes"></a>Sentinel Nodes</h3><p>How do we represent an empty linked list? Set first to null?</p>
<p><code>Goal of sentinel</code>: Make code as simple as generic as possible so we donâ€™t have to have any special cases. (avoid pesky null checks)</p>
<h3 id="DLList-1"><a href="#DLList-1" class="headerlink" title="DLList"></a>DLList</h3><p>One thing that a list should support is <code>remove(int i)</code> which removes the node whose item is <code>i</code>. With <code>SLList</code> with sentinel, what would we have to do to remove a link?</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/ydb6i.jpg" alt=""></p>
<ul>
<li>Save a reference to this node</li>
<li>Remove its â€œnextâ€ pointer (i)</li>
<li>Jump to the node before</li>
<li>Reassign next to the node after</li>
</ul>
<p>We had to traverse the list <code>TWICE</code> in order to do the job. So we add a <code>previous</code> link as well. (donâ€™t quite understandâ€¦ what if I traverse a node ahead)</p>
<h3 id="AList-1"><a href="#AList-1" class="headerlink" title="AList"></a>AList</h3><p>Even with the super sophisticated doubly linked list, itâ€™ll take a long time to traverse through the list. So we go back to <code>arrays</code>.</p>
<p>But the bad thing about arrays is that you canâ€™t efficiently add or remove items.</p>
<p>Letâ€™s write a list class that takes advantage of both an <code>array&#39;s constant access time</code> and a <code>linked lists adding and removing feature</code>.</p>
<p>AList is a list whose underlying structure is an <code>array</code>.</p>
<h2 id="Ex-D2-Guide"><a href="#Ex-D2-Guide" class="headerlink" title="Ex (D2 + Guide)"></a>Ex (D2 + Guide)</h2><h3 id="Ex-1-Osmosis-addAdjacent"><a href="#Ex-1-Osmosis-addAdjacent" class="headerlink" title="Ex 1 (Osmosis - addAdjacent)"></a>Ex 1 (Osmosis - addAdjacent)</h3><p>Problem: <a href="http://www.kartikkapur.com/documents/mt1.pdf#page=7" target="_blank" rel="noopener">Osmosis</a></p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/i5kb8.jpg" alt=""></p>
<p>Iterative:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** addAdjacent(L) */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAdjacent</span><span class="params">(IntList p)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* if p == null, p.rest will no longer execute */</span></span><br><span class="line">  <span class="keyword">if</span> (p.rest == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="comment">/* size &lt;= 1 */</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * p.rest != null</span></span><br><span class="line"><span class="comment">   * p ends at the last node finally</span></span><br><span class="line"><span class="comment">   * loop through 1st ~ last 2nd node</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">while</span> (p.rest != <span class="keyword">null</span>) &#123; <span class="comment">/* p ends at the last node */</span></span><br><span class="line">    <span class="keyword">if</span> (p.first == p.rest.first) &#123;</span><br><span class="line">      <span class="comment">/* merge */</span></span><br><span class="line">      p.first *= <span class="number">2</span>;</span><br><span class="line">      p.rest = p.rest.rest; <span class="comment">/* it's okay if it is null */</span></span><br><span class="line">      <span class="comment">/* Notice: no ++ here */</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      p = p.rest;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Recursive (interesting!):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAdjacent</span><span class="params">(IntList p)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (p == <span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line">  adj(p, p.rest);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// helper function - pass previous node recursively</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">adj</span><span class="params">(IntList prev, IntList current)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (current == <span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span> (prev.first == current.first) &#123; <span class="comment">/* same as prev */</span></span><br><span class="line">    prev.first *= <span class="number">2</span>;</span><br><span class="line">    prev.rest = current.rest; <span class="comment">/* maybe null */</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    adj(current, current.rest);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Ex-2-Square-Insertion"><a href="#Ex-2-Square-Insertion" class="headerlink" title="Ex 2 (Square Insertion)"></a>Ex 2 (Square Insertion)</h3><p>Modify the IntList class so that every time you add a value you â€œsquareâ€ the IntList. For example, upon the insertion of 5, the below IntList would transform from:</p>
<p><code>1 =&gt; 2</code> to <code>1 =&gt; 1 =&gt; 2 =&gt; 4 =&gt; 5</code></p>
<p>and if 7 was added to the latter IntList, it would become</p>
<p>1 =&gt; 1 =&gt; 1 =&gt; 1 =&gt; 2 =&gt; 4 =&gt; 4 =&gt; 16 =&gt; 5 =&gt; 25 =&gt; 7</p>
<p>Additionally, you are provided the constraint that you <code>can only access the size()</code> function one time during the entire process of adding a node.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Square Insertion */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLastAndSquare</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  IntList p = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">while</span> (p.rest != <span class="keyword">null</span>) &#123; <span class="comment">/* p won't be null */</span></span><br><span class="line">    IntList squareNode = <span class="keyword">new</span> IntList(p.first * p.first, p.rest);</span><br><span class="line">    p.rest = squareNode;</span><br><span class="line">    p = p.rest.rest;</span><br><span class="line">  &#125; <span class="comment">/* p stops at the last node */</span></span><br><span class="line">  <span class="comment">/* add node of x */</span></span><br><span class="line">  IntList newNode = <span class="keyword">new</span> IntList(x, <span class="keyword">null</span>);</span><br><span class="line">  <span class="comment">/* square the last node  */</span></span><br><span class="line">  IntList squareNode = <span class="keyword">new</span> IntList(p.first * p.first, newNode); <span class="comment">/* p.rest is null */</span></span><br><span class="line">  p.rest = squareNode;</span><br><span class="line">  <span class="comment">/* if use while (p != null), need an extra pointer to the previous node (to remember) */</span></span><br><span class="line">  size += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>But I donâ€™t access the size() function.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Recursively */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLastAndSquare</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  helper(<span class="keyword">this</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> IntList <span class="title">helper</span><span class="params">(IntList L, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (L == <span class="keyword">null</span>) &#123; <span class="comment">// the last node</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> IntList(x, <span class="keyword">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  IntList squared = <span class="keyword">new</span> IntList(x * x, L.rest);</span><br><span class="line">  L.rest = squared;</span><br><span class="line">  squared.rest = helper(square.rest, x);</span><br><span class="line">  <span class="keyword">return</span> L</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Ex-3-Arrrrghrays"><a href="#Ex-3-Arrrrghrays" class="headerlink" title="Ex 3 (Arrrrghrays)"></a>Ex 3 (Arrrrghrays)</h3><p>Problem: <a href="http://www.kartikkapur.com/documents/mt1.pdf#page=10" target="_blank" rel="noopener">link</a><br>Code: <a href="https://github.com/junhaowww/cs61b-sp18/blob/master/classcode/w2/Arrrrghrays.java" target="_blank" rel="noopener">Arrrrghrays.java</a></p>
<p>ç¬¬ä¸€åˆ—ä¸ä¼šå‘ç”Ÿé‡å¤ï¼Œå› ä¸ºåŠ å…¥çš„æ—¶å€™å·²ç»æœç»è¿™ç§æƒ…å†µäº†ã€‚</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/eph4z.png" alt=""></p>
<p>Note: for every <code>p[i]</code>, <code>j</code> will start over!</p>
<p><strong>The 1st half of the problem took me half a day to think aboutâ€¦ â€˜cause I thought I was required to implement sorting in this function :(</strong></p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/lrcux.jpg" alt="" title="ç”»ä¸ªå›¾æ‰å¥½ç†è§£"></p>
<p>The 2nd half of the problem took me another half a day to think aboutâ€¦ â€˜cause I was not sure about:</p>
<ul>
<li><code>groupByLat</code>, <code>sortByLat</code>, <code>sortHalfLong</code> should be in what kind of orders?<ul>
<li>Since the parameter of <code>sortByLat</code> is <code>Piece[][]</code>, it should follow <code>groupByLat</code>.</li>
</ul>
</li>
<li>The most confusing one is <code>sortHalfLong</code>, because there could be 2 situations (the length is <code>even</code> or <code>odd</code>). I spent a lot of time on the implementation of the function, but I kind of misinterpreted its purpose.</li>
<li>In the solution, each <code>row</code> has the same <code>latitude</code>, so we need to halfsoft it by <code>longitude</code>â€¦ okayâ€¦ I seeâ€¦ It provides <code>halfsoft</code> on purposeâ€¦ so we have a chance to practice <code>System.arraycopy</code></li>
<li><code>System.arraycopy(src, srcPos, dest, destPos, length)</code><ul>
<li><code>upper</code>, <code>lower</code>, <code>mid</code> (learn this pattern)<ul>
<li>length = 3 (odd)<ul>
<li>upper = (3.0 / 2 = 1.5) = 2</li>
<li>lower = (3.0 / 2 = 1.5) = 1</li>
<li>(0 ~ lower is the 1st half, upper could be the length of it)</li>
</ul>
</li>
<li>length = 4 (even)<ul>
<li>upper = (4.0 / 2 = 2.0) = 2</li>
<li>lower = (4.0 / 2 = 2.0) = 2</li>
<li>For even numbers, upper and lower are the same</li>
</ul>
</li>
</ul>
</li>
<li>System.arraycopy(halfsort, 0,     tmp, lower, upper);</li>
<li>System.arraycopy(halfsort, upper, tmp, 0,     lower);</li>
</ul>
</li>
<li><p>You know what. I am confused again, so Iâ€™d better test it out.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span>[] a = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">  <span class="keyword">int</span>[] b = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">int</span> upper = (<span class="keyword">int</span>) Math.ceil((<span class="keyword">double</span>) a.length / <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">int</span> lower = (<span class="keyword">int</span>) Math.floor((<span class="keyword">double</span>) b.length / <span class="number">2</span>);</span><br><span class="line">  System.arraycopy(a, <span class="number">0</span>, b, lower, upper);</span><br><span class="line">  System.arraycopy(a, upper, b, <span class="number">0</span>, lower);</span><br><span class="line"></span><br><span class="line">  System.out.println(<span class="string">"a: "</span> + Arrays.toString(a));</span><br><span class="line">  System.out.println(<span class="string">"b: "</span> + Arrays.toString(b));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The output is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[1, 2, 3] // the provided &quot;even number&quot; version: [0, 2, 4, 9]</span><br><span class="line">[3, 1, 2] // the provided &quot;even number&quot; version: [4, 9, 0, 2]</span><br><span class="line">// I thought it should be [3, 2, 1]  dead~</span><br><span class="line">// So I am totally wrong about it.</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>By now, I am clear about the intention of the problem.</p>
<h3 id="Ex-4-HighOrderFunctionsAndArrays"><a href="#Ex-4-HighOrderFunctionsAndArrays" class="headerlink" title="Ex 4 (HighOrderFunctionsAndArrays)"></a>Ex 4 (HighOrderFunctionsAndArrays)</h3><p>Problem: <a href="https://tbp.berkeley.edu/exams/4695/download/#page=9" target="_blank" rel="noopener">link</a><br>Code: <a href="https://github.com/junhaowww/cs61b-sp18/blob/master/classcode/w2/HigherOrderFunctionsAndArrays.java" target="_blank" rel="noopener">HigherOrderFunctionsAndArrays.java</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(String s1, String s2)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ((s1 == <span class="keyword">null</span>) &amp;&amp; (s2 == <span class="keyword">null</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (s1 == <span class="keyword">null</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (s2 == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> s1.length() - s2.length();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String[][] step(String[][] arr) &#123;</span><br><span class="line">  <span class="comment">/* Recall: All String references in stepped are null by</span></span><br><span class="line"><span class="comment">  default, so the edges are correct on initialization */</span></span><br><span class="line">  String[][] stepped = <span class="keyword">new</span> String[arr.length][arr[<span class="number">0</span>].length];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; arr.length - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; arr[<span class="number">0</span>].length - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">      String[] temp = <span class="keyword">new</span> String[<span class="number">9</span>];</span><br><span class="line">      <span class="comment">// LengthComparator lc = new LengthComparator();</span></span><br><span class="line">      <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> k = -<span class="number">1</span>; k &lt;= <span class="number">1</span>; k += <span class="number">1</span>) &#123; <span class="comment">/* horizontally */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> m = -<span class="number">1</span>; m &lt;= <span class="number">1</span>; m += <span class="number">1</span>) &#123; <span class="comment">/* vertically */</span></span><br><span class="line">          <span class="comment">// int index = (k + 1) * 3 + (m + 1);</span></span><br><span class="line">          <span class="comment">// temp[index] = arr[i + k][j + m];</span></span><br><span class="line">          temp[count] = arr[i + k][j + m];</span><br><span class="line">          count += <span class="number">1</span>; <span class="comment">/** nice! (mapping) */</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// stepped[i][j] = max(temp, lc);</span></span><br><span class="line">      stepped[i][j] = max(temp, <span class="keyword">new</span> LengthComparator());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> stepped;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Ex-5-Squaring-a-List"><a href="#Ex-5-Squaring-a-List" class="headerlink" title="Ex 5 (Squaring a List)"></a>Ex 5 (Squaring a List)</h3><p>Mutative / Non-mutative + Recursive / Iterative</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Non-mutative (new) - Recursive */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IntList <span class="title">square_re</span><span class="params">(IntList L)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (L == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> IntList(L.first * L.first, square_re(L.rest));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Non-mutative - Iterative */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IntList <span class="title">square</span><span class="params">(IntList L)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (L == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  IntList p = <span class="keyword">new</span> IntList(L.first * L.first, <span class="keyword">null</span>);</span><br><span class="line">  IntList ret = p;</span><br><span class="line">  L = L.rest;</span><br><span class="line">  <span class="keyword">while</span> (L != <span class="keyword">null</span>) &#123;</span><br><span class="line">    p.rest = <span class="keyword">new</span> IntList(L.first * L.first, <span class="keyword">null</span>);</span><br><span class="line">    p = p.rest;</span><br><span class="line">    L = L.rest;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Mutative - Recursive */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IntList <span class="title">squareMutative_re</span><span class="params">(IntList L)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (L == <span class="keyword">null</span>) &#123; <span class="keyword">return</span> <span class="keyword">null</span>; &#125;</span><br><span class="line">  L.first = L.first * L.first;</span><br><span class="line">  L.rest = squareMutative_re(L.rest);</span><br><span class="line">  <span class="keyword">return</span> L;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Mutative - Iterative */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IntList <span class="title">squareMutative</span><span class="params">(IntList L)</span> </span>&#123;</span><br><span class="line">  IntList p = L;</span><br><span class="line">  <span class="keyword">while</span> (p != <span class="keyword">null</span>) &#123;</span><br><span class="line">    p.first = p.first * p.first;</span><br><span class="line">    p = p.rest;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Ex-Discussion-3"><a href="#Ex-Discussion-3" class="headerlink" title="Ex (Discussion 3)"></a>Ex (Discussion 3)</h2><h3 id="Ex-1-insert"><a href="#Ex-1-insert" class="headerlink" title="Ex 1 (insert)"></a>Ex 1 (insert)</h3><p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/ck60s.jpg" alt=""></p>
<p>Data Structure (Note that no size field):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SLList</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">IntNode</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> item;</span><br><span class="line">    IntNode next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  IntNode first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="My-Way"><a href="#My-Way" class="headerlink" title="My Way"></a>My Way</h4><p><strong>Recursive:</strong></p>
<p>Later, I wrote a <code>recursive</code> version. More succinct!</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// size == 3</span></span><br><span class="line"><span class="comment">// if pos == 0, first</span></span><br><span class="line"><span class="comment">// if pos == 3, last</span></span><br><span class="line"><span class="comment">// if pos &gt;  3, last</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> item, <span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// better check size first; but in this case, no size field</span></span><br><span class="line">  first = insert(first, item, pos);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> IntNode <span class="title">insert</span><span class="params">(IntNode x, <span class="keyword">int</span> item, <span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (pos &lt;= <span class="number">0</span> || x == <span class="keyword">null</span>) &#123; <span class="comment">// consider invalid pos</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> IntNode(item, x); <span class="comment">// return connects to prev</span></span><br><span class="line">  &#125;</span><br><span class="line">  x.next = insert(x.next, item, pos - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Iterative:</strong></p>
<p>It is too complicated. Remember the <code>insert pattern</code> I summarize.</p>
<p>This is the code using another <code>count</code> variable. <strong>Donâ€™t look at it.</strong> Go for the version in the Solution section.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> item, <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (position == <span class="number">0</span> || first == <span class="keyword">null</span>) &#123;</span><br><span class="line">    addFirst(item); <span class="keyword">return</span>;</span><br><span class="line">  &#125; <span class="comment">/** position &gt;= 1 &amp;&amp; first != null */</span></span><br><span class="line"></span><br><span class="line">  IntNode p1 = <span class="keyword">null</span>;  <span class="comment">/* prev node */</span></span><br><span class="line">  IntNode p2 = first; <span class="comment">/* p1 p2 (ahead) */</span></span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (count &lt; position) &#123;</span><br><span class="line">    p1 = p2;</span><br><span class="line">    p2 = p2.next;</span><br><span class="line">    count += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (p2 == <span class="keyword">null</span>) &#123; <span class="comment">/* hit the end */</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  p1.next = <span class="keyword">new</span> IntNode(item, p1.next);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Answer"><a href="#Answer" class="headerlink" title="Answer"></a>Answer</h4><p>You donâ€™t need <code>extra pointer</code> to remember the previous node. In <code>insert</code> cases, you just need to look ahead, which means <code>currentNode</code> (also the one <code>ptr</code> finally stops at) is the one at <code>pos - 1</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0 1 2 (index)  always use 2~3 nodes to test</span></span><br><span class="line"><span class="comment">// 3 6 2 </span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Case 1: pos == 1, &lt;currentNode&gt; stops at pos 0</span></span><br><span class="line"><span class="comment"> * Case 2: pos == 2, &lt;currentNode&gt; stops at pos 1</span></span><br><span class="line"><span class="comment"> * Case 3: pos &gt;= 3, &lt;currentNode&gt; stops at pos 2 (ending)</span></span><br><span class="line"><span class="comment"> * ----------------------------------------------</span></span><br><span class="line"><span class="comment"> * If pos is valid: &lt;while&gt; stops when pos hits 1</span></span><br><span class="line"><span class="comment"> * If pos is invalid (&gt;3): &lt;while&gt; stops when &lt;currentNode.next&gt; is null</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> item, <span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/** </span></span><br><span class="line"><span class="comment">   * Guarantee [first] is not null, and we are not gonna insert node at (pos 0) since there is no (pos - 1) here. </span></span><br><span class="line"><span class="comment">   * Unless a &lt;sentinel&gt; is used</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">if</span> (first == <span class="keyword">null</span> || pos == <span class="number">0</span>) &#123; <span class="comment">// consider pos == 0</span></span><br><span class="line">    addFirst(item);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// consider pos == 1</span></span><br><span class="line">  IntNode currentNode = first; <span class="comment">// won't be null</span></span><br><span class="line">  <span class="keyword">while</span> (pos &gt; <span class="number">1</span> &amp;&amp; currentNode.next != <span class="keyword">null</span>) &#123; <span class="comment">// why pos &gt; 1? If pos is 1, currentNode should not move at all.</span></span><br><span class="line">    pos -= <span class="number">1</span>;</span><br><span class="line">    currentNode = currentNode.next;</span><br><span class="line">  &#125;</span><br><span class="line">  IntNode newNode = <span class="keyword">new</span> IntNode(item, currentNode.next);</span><br><span class="line">  currentNode.next = newNode;  <span class="comment">// lastNode.next = newNode</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Count-code-patterns"><a href="#Count-code-patterns" class="headerlink" title="Count code patterns:"></a>Count code patterns:</h4><p><code>count &gt; 0</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> count = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">while</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="comment">// 3 =&gt; 2 =&gt; 1 (3 times)</span></span><br><span class="line">  count -= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Equivalent to <code>count &gt;= 1</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> count = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">while</span> (count &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="comment">// 3 =&gt; 2 =&gt; 1 (3 times)</span></span><br><span class="line">  count -= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Ex-1-5-insert-extra"><a href="#Ex-1-5-insert-extra" class="headerlink" title="Ex 1.5 (insert extra)"></a>Ex 1.5 (insert extra)</h3><p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/a3ihq.jpg" alt=""></p>
<p>My solution (answer)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] insert(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> item, <span class="keyword">int</span> position) &#123;</span><br><span class="line">  <span class="keyword">int</span>[] newArr = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length + <span class="number">1</span>];</span><br><span class="line">  <span class="comment">/** copy items before  */</span></span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; position; i++) &#123;</span><br><span class="line">    newArr[i] = arr[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/** insert */</span></span><br><span class="line">  newArr[i] = item;</span><br><span class="line">  i++;</span><br><span class="line">  <span class="comment">/** copy the items after */</span></span><br><span class="line">  <span class="keyword">for</span> (; i &lt; newArr.length; i++) &#123;</span><br><span class="line">    newArr[i] = arr[i - <span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newArr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Ex-2-reverse"><a href="#Ex-2-reverse" class="headerlink" title="Ex 2 (reverse)"></a>Ex 2 (reverse)</h3><p><strong>Iterative version</strong></p>
<p>Use the same data structures above. Reverse elements using the existing IntNode objects (you should not use <code>new</code>).</p>
<h4 id="My-Way-1"><a href="#My-Way-1" class="headerlink" title="My Way"></a>My Way</h4><p><strong>Note:</strong> Similar to the solution. Just use one extra variable but make it clearer.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/uqnk8.png" alt="" title="My Drawing"></p>
<p><code>p != null</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (first == <span class="keyword">null</span> || first.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  IntNode prev = <span class="keyword">null</span>;</span><br><span class="line">  IntNode p = first;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (p != <span class="keyword">null</span>) &#123;</span><br><span class="line">    IntNode temp = p.next;  <span class="comment">// record the next</span></span><br><span class="line">    p.next = prev;  <span class="comment">// reverse</span></span><br><span class="line">    prev = p;  <span class="comment">// update prev</span></span><br><span class="line">    p = temp;  <span class="comment">// go to next</span></span><br><span class="line">  &#125;</span><br><span class="line">  first = prev;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>p.next != null</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (first == <span class="keyword">null</span> || first.next == <span class="keyword">null</span>) &#123; <span class="comment">// size = 0 or 1</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  IntNode prev = <span class="keyword">null</span>;</span><br><span class="line">  IntNode p = first;  <span class="comment">// first and first.next are not null</span></span><br><span class="line">  <span class="keyword">while</span> (p.next != <span class="keyword">null</span>) &#123;  <span class="comment">// since p should stop at the last node</span></span><br><span class="line">    IntNode temp = p.next;  <span class="comment">// record the next</span></span><br><span class="line">    p.next = prev;  <span class="comment">// reverse</span></span><br><span class="line">    prev = p;  <span class="comment">// update prev</span></span><br><span class="line">    p = temp;  <span class="comment">// go to next</span></span><br><span class="line">  &#125; <span class="comment">/* p finally stops at the last node */</span></span><br><span class="line">  p.next = prev;</span><br><span class="line">  first = p</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Answer-1"><a href="#Answer-1" class="headerlink" title="Answer"></a>Answer</h4><p>The answer just uses the <code>first</code> as my <code>prev</code>, but it turns out to be a bit confusing.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/bcb9e.png" alt="" title="My Drawing"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// first -1-&gt; ptr -2-&gt; ptr.next (temp) -3-&gt; ptr.next.next</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (first == <span class="keyword">null</span> || first.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  IntNode ptr = first.next;  <span class="comment">/* if no ".next", there will be a bug */</span></span><br><span class="line">  first.next = <span class="keyword">null</span>; <span class="comment">/* -1-&gt; */</span></span><br><span class="line">  <span class="comment">/* How to determine the condition?</span></span><br><span class="line"><span class="comment">   * If ptr is pointing at the last node, we still need to work on it.</span></span><br><span class="line"><span class="comment">   * Although ptr.next is null, we need to change it to the last 2nd node.</span></span><br><span class="line"><span class="comment">   * The nice thing is: first is set at the same time.</span></span><br><span class="line"><span class="comment">   * Next round, ptr is null. So we can go with ptr != null</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">while</span> (ptr != <span class="keyword">null</span>) &#123;</span><br><span class="line">    IntNode temp = ptr.next;</span><br><span class="line">    ptr.next = first; <span class="comment">/* -2-&gt; */</span></span><br><span class="line">    first = ptr; <span class="comment">/* changing -3-&gt; needs first */</span></span><br><span class="line">    ptr = temp;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Ex-2-5-reverse-extra-Challenging"><a href="#Ex-2-5-reverse-extra-Challenging" class="headerlink" title="Ex 2.5 (reverse extra - Challenging)"></a>Ex 2.5 (reverse extra - Challenging)</h3><p>Write a second version that uses recursion.</p>
<p><strong>Combine my way and the answer:</strong></p>
<p>It is a very interesting way of using recursion.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/3tvoz.png" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (first == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  first = helper(first); <span class="comment">// helper must return the last node!</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  node#0   node#1   node#2   ...   last node</span></span><br><span class="line"><span class="comment">//             x      current</span></span><br><span class="line"><span class="comment">//    x      current</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> IntList <span class="title">helper</span><span class="params">(IntList x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x == <span class="keyword">null</span> || x.next == <span class="keyword">null</span>) &#123; <span class="comment">// reach the last node</span></span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">  &#125;</span><br><span class="line">  IntList last = helper(x.next);</span><br><span class="line">  IntList current = x.next;</span><br><span class="line">  current.next = x;</span><br><span class="line">  x.next = <span class="keyword">null</span>; <span class="comment">// originally points to what current now points to</span></span><br><span class="line">  <span class="keyword">return</span> last; <span class="comment">// last node</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Same as above (Just do it again when I am reviewing):</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/sqb13.png" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// could be skipped (same code)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (first == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>; <span class="comment">// size = 0</span></span><br><span class="line">  first = reverseHelper(first); <span class="comment">// helper must return the last node</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> IntList <span class="title">reverseHelper</span><span class="params">(IntList x)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ok with size = 1</span></span><br><span class="line">  <span class="keyword">if</span> (x == <span class="keyword">null</span> || x.next == <span class="keyword">null</span>) &#123; <span class="comment">// x finally stops at the last node</span></span><br><span class="line">    <span class="keyword">return</span> x; <span class="comment">// return the last node to first in the reverse()</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// FOCUS (In the graph)</span></span><br><span class="line">  IntList newHead = reverseHelper(x.next); <span class="comment">// newHead points to the last node</span></span><br><span class="line">  IntList nextOfX = x.next;</span><br><span class="line">  nextOfX.next = x; <span class="comment">// reverse (nextOfX.next.next = x)</span></span><br><span class="line">  x.next = <span class="keyword">null</span>; <span class="comment">// it would be set correctly in next round</span></span><br><span class="line">  <span class="comment">// or you can write: if (x == first) x.next = null; NOT NECESSARY</span></span><br><span class="line">  <span class="keyword">return</span> newHead; <span class="comment">// need to return the last node</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Ex-3-Array-reverse"><a href="#Ex-3-Array-reverse" class="headerlink" title="Ex 3 (Array reverse)"></a>Ex 3 (Array reverse)</h3><p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/tywpv.jpg" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// consider size = 0, 1, 2, 3</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// index:  0  1  2  3  4  5</span></span><br><span class="line">  <span class="comment">// even : [ ][ ][ ][x][ ][ ] size = 6</span></span><br><span class="line">  <span class="comment">// odd  : [ ][ ][x][ ][ ]  size = 5</span></span><br><span class="line">  <span class="keyword">int</span> mid = a.length / <span class="number">2</span>; <span class="comment">/* think over it for even and odd cases */</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mid; i += <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">int</span> j = a.length - i - <span class="number">1</span>; <span class="comment">// mirror element</span></span><br><span class="line">    <span class="keyword">int</span> temp = a[i];</span><br><span class="line">    a[i] = a[j];</span><br><span class="line">    a[j] = temp;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Ex-3-5-Array-Reverse-Extra"><a href="#Ex-3-5-Array-Reverse-Extra" class="headerlink" title="Ex 3.5 (Array Reverse Extra)"></a>Ex 3.5 (Array Reverse Extra)</h3><p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/1xzg8.png" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] replicate(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">  <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> num : arr) &#123;</span><br><span class="line">    total += num;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span>[] newArr = <span class="keyword">new</span> <span class="keyword">int</span>[total];</span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> num : arr) &#123;</span><br><span class="line">    <span class="keyword">int</span> count = num;</span><br><span class="line">    <span class="keyword">while</span> (count &gt; <span class="number">0</span>) &#123; <span class="comment">// count loop</span></span><br><span class="line">      newArr[i] = num;</span><br><span class="line">      i++;</span><br><span class="line">      count--;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newArr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Ex-Exam-Prep-3"><a href="#Ex-Exam-Prep-3" class="headerlink" title="Ex (Exam Prep 3)"></a>Ex (Exam Prep 3)</h2><h3 id="Ex-1-Skippify"><a href="#Ex-1-Skippify" class="headerlink" title="Ex 1 (Skippify)"></a>Ex 1 (Skippify)</h3><p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/q64j6.jpg" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">skippify</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  IntList p = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">int</span> skipNum = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (p != <span class="keyword">null</span>) &#123;</span><br><span class="line">    IntList theNext = p.next;</span><br><span class="line">    <span class="keyword">int</span> count = skipNum;</span><br><span class="line">    <span class="keyword">while</span> (theNext != <span class="keyword">null</span> &amp;&amp; count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      theNext = theNext.next;</span><br><span class="line">      count -= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    p.next = theNext;</span><br><span class="line">    p = theNext;</span><br><span class="line">    skipNum += <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>vs. (similar)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">skippify</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  IntList p = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">int</span> skipNum = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (p != <span class="keyword">null</span>) &#123;</span><br><span class="line">    IntList next = p.rest;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> = <span class="number">0</span>; i &lt; skipNum; i += <span class="number">1</span>) &#123; <span class="comment">// skip</span></span><br><span class="line">      <span class="keyword">if</span> (next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      next = next.rest; <span class="comment">// find the next</span></span><br><span class="line">    &#125; <span class="comment">// next stops at yellow node</span></span><br><span class="line">    p.rest = next; <span class="comment">// cut and connect</span></span><br><span class="line">    p = next;</span><br><span class="line">    skipNum += <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Ex-2-Remove-Duplicates"><a href="#Ex-2-Remove-Duplicates" class="headerlink" title="Ex 2 (Remove Duplicates)"></a>Ex 2 (Remove Duplicates)</h3><p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/vm8d7.jpg" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">removeDuplicate</span><span class="params">(IntList p)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (p == <span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (p.next == <span class="keyword">null</span>) &#123; <span class="comment">// since I need to use p.next in the loop</span></span><br><span class="line">    <span class="comment">// since in the last node, no need to check anymore</span></span><br><span class="line">    <span class="keyword">if</span> (p.item == p.next.item) &#123; <span class="comment">// found duplicate</span></span><br><span class="line">      p.next = p.next.next; <span class="comment">// no need to update p</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// not duplicate</span></span><br><span class="line">      p = p.next;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Midterm-1-Notes"><a href="#Midterm-1-Notes" class="headerlink" title="Midterm 1 - Notes"></a>Midterm 1 - Notes</h2><p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/5hwre.jpg" alt="" title="KeyGate - Method Selection Problem"></p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/3wavc.jpg" alt="" title="Sans - Especially for c, consider the case [1, 2, 3] and y = [2]"></p>
<p>Array:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Non-destructively creates a copy of x that contains no y.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] sans(<span class="keyword">int</span>[] x, <span class="keyword">int</span> y) &#123;</span><br><span class="line">  <span class="keyword">int</span>[] xclean = <span class="keyword">new</span> <span class="keyword">int</span>[x.length];</span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; x.length; i += <span class="number">1</span>) &#123; <span class="comment">// filter</span></span><br><span class="line">    <span class="keyword">if</span> (x[i] == y) <span class="keyword">continue</span>;</span><br><span class="line">    xclean[count] = x[i];</span><br><span class="line">    count += <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span>[] ret = <span class="keyword">new</span> <span class="keyword">int</span>[count];</span><br><span class="line">  System.arrayCopy(xlcean, <span class="number">0</span>, ret, <span class="number">0</span>, count);</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>IntList:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Same requirement</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IntList <span class="title">ilsans</span><span class="params">(IntList x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (x.item == y) &#123; <span class="comment">// y</span></span><br><span class="line">    <span class="keyword">return</span> ilsans(x.next, y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// not y</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> IntList(x.item, ilsans(x.next, y));</span><br><span class="line">    <span class="comment">// IntList ret = new IntList(x.item, x.next);</span></span><br><span class="line">    <span class="comment">// ilsans(x.next, y);</span></span><br><span class="line">    <span class="comment">// return ret;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>IntList (Destructive):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">y = 3</span><br><span class="line">x</span><br><span class="line">1  3  5  7</span><br></pre></td></tr></table></figure>
<p>Bad code (duplicate code):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Destructive</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IntList <span class="title">dilsans</span><span class="params">(IntList x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (x.item == y) <span class="keyword">return</span> dilsans(x.next, y); <span class="comment">// y</span></span><br><span class="line">  dilsans(x.next, y); <span class="comment">// not y</span></span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Good code (using <code>x.next = ...</code> to connect)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IntList <span class="title">dilsans</span><span class="params">(IntList x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  x.next = dilsans(x.next, y);</span><br><span class="line">  <span class="keyword">if</span> (x.item == y) &#123; <span class="comment">// y</span></span><br><span class="line">    <span class="keyword">return</span> x.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x; <span class="comment">// not y</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Integer-Cache-Lab-3"><a href="#Integer-Cache-Lab-3" class="headerlink" title="Integer Cache (Lab 3)"></a>Integer Cache (Lab 3)</h2><p>Reference: <a href="https://stackoverflow.com/questions/1700081/why-is-128-128-false-but-127-127-is-true-when-comparing-integer-wrappers-in-ja" target="_blank" rel="noopener">Why is 128==128 false but 127==127 is true when comparing Integer wrappers in Java?</a></p>
<p>Problem:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Integer a1 = <span class="keyword">new</span> Integer.valueOf(<span class="number">127</span>);</span><br><span class="line">Integer a2 = <span class="keyword">new</span> Integer.valueOf(<span class="number">127</span>);</span><br><span class="line">a1 == a2;      <span class="comment">// true</span></span><br><span class="line">a1.equals(a2); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">Integer a3 = <span class="keyword">new</span> Integer.valueOf(<span class="number">128</span>);</span><br><span class="line">Integer a4 = <span class="keyword">new</span> Integer.valueOf(<span class="number">128</span>);</span><br><span class="line">a3 == a4;      <span class="comment">// false</span></span><br><span class="line">a3.equals(a4); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>Explanation:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Java 1.6 source code</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title">valueOf</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (i &gt;= -<span class="number">128</span> &amp;&amp; i &lt;= IntegerCache.high) &#123; <span class="comment">// IntegerCache.high = 127</span></span><br><span class="line">    <span class="keyword">return</span> IntegerCache.cache[i + <span class="number">128</span>];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Integer(i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Therefore, we can manage our integers within the range of $[-128, 127)$ to achieve better performance, or by setting the system property to change the behavior:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Djava.lang.Integer.IntegerCache.high = <span class="number">999</span></span><br></pre></td></tr></table></figure>
        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/cat_with_glasses.jpg" alt="Junhao Wang">
            
              <p class="site-author-name" itemprop="name">Junhao Wang</p>
              <p class="site-description motion-element" itemprop="description">Debug the old world, bug the new world!</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">50</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">118</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://www.facebook.com/chuckwangg" target="_blank" title="Facebook">
                      
                        <i class="fa fa-fw fa-facebook"></i>Facebook</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/junhaowww" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.linkedin.com/in/junhaowww/" target="_blank" title="LinkedIn">
                      
                        <i class="fa fa-fw fa-linkedin"></i>LinkedIn</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.douban.com/people/maodai/" target="_blank" title="è±†ç“£ (Book)">
                      
                        <i class="fa fa-fw fa-book"></i>è±†ç“£ (Book)</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.jianshu.com/u/41865efdad5d/" title="Xiaofud" target="_blank">Xiaofud</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.davex.pw/" title="DaveX" target="_blank">DaveX</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://alexfan.xyz/" title="alexfan.xyz" target="_blank">alexfan.xyz</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#IntList"><span class="nav-number">1.</span> <span class="nav-text">IntList</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SLList"><span class="nav-number">2.</span> <span class="nav-text">SLList</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nested-Class"><span class="nav-number">2.1.</span> <span class="nav-text">Nested Class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sentinel"><span class="nav-number">2.2.</span> <span class="nav-text">Sentinel</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Invariant"><span class="nav-number">2.3.</span> <span class="nav-text">Invariant</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Slow-removeLast"><span class="nav-number">2.4.</span> <span class="nav-text">Slow removeLast</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DLList"><span class="nav-number">3.</span> <span class="nav-text">DLList</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Doubly-Go-Back"><span class="nav-number">3.1.</span> <span class="nav-text">Doubly (Go Back)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sentinel-Upgrade"><span class="nav-number">3.2.</span> <span class="nav-text">Sentinel Upgrade</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Generic-Feature"><span class="nav-number">3.3.</span> <span class="nav-text">Generic Feature</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AList"><span class="nav-number">4.</span> <span class="nav-text">AList</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Array-In-Java"><span class="nav-number">4.1.</span> <span class="nav-text">Array In Java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Performance-Puzzle"><span class="nav-number">4.2.</span> <span class="nav-text">Performance Puzzle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Resizing"><span class="nav-number">4.3.</span> <span class="nav-text">Resizing</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Issue-1"><span class="nav-number">4.3.1.</span> <span class="nav-text">Issue #1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Issue-2"><span class="nav-number">4.3.2.</span> <span class="nav-text">Issue #2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Generic-Array"><span class="nav-number">4.4.</span> <span class="nav-text">Generic Array</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nulling-Out-Deleted-Items"><span class="nav-number">4.5.</span> <span class="nav-text">Nulling Out Deleted Items</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Obscurantism"><span class="nav-number">4.6.</span> <span class="nav-text">Obscurantism</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Discussion-3"><span class="nav-number">5.</span> <span class="nav-text">Discussion 3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SLList-1"><span class="nav-number">5.1.</span> <span class="nav-text">SLList</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sentinel-Nodes"><span class="nav-number">5.2.</span> <span class="nav-text">Sentinel Nodes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DLList-1"><span class="nav-number">5.3.</span> <span class="nav-text">DLList</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AList-1"><span class="nav-number">5.4.</span> <span class="nav-text">AList</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ex-D2-Guide"><span class="nav-number">6.</span> <span class="nav-text">Ex (D2 + Guide)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-1-Osmosis-addAdjacent"><span class="nav-number">6.1.</span> <span class="nav-text">Ex 1 (Osmosis - addAdjacent)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-2-Square-Insertion"><span class="nav-number">6.2.</span> <span class="nav-text">Ex 2 (Square Insertion)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-3-Arrrrghrays"><span class="nav-number">6.3.</span> <span class="nav-text">Ex 3 (Arrrrghrays)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-4-HighOrderFunctionsAndArrays"><span class="nav-number">6.4.</span> <span class="nav-text">Ex 4 (HighOrderFunctionsAndArrays)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-5-Squaring-a-List"><span class="nav-number">6.5.</span> <span class="nav-text">Ex 5 (Squaring a List)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ex-Discussion-3"><span class="nav-number">7.</span> <span class="nav-text">Ex (Discussion 3)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-1-insert"><span class="nav-number">7.1.</span> <span class="nav-text">Ex 1 (insert)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#My-Way"><span class="nav-number">7.1.1.</span> <span class="nav-text">My Way</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Answer"><span class="nav-number">7.1.2.</span> <span class="nav-text">Answer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Count-code-patterns"><span class="nav-number">7.1.3.</span> <span class="nav-text">Count code patterns:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-1-5-insert-extra"><span class="nav-number">7.2.</span> <span class="nav-text">Ex 1.5 (insert extra)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-2-reverse"><span class="nav-number">7.3.</span> <span class="nav-text">Ex 2 (reverse)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#My-Way-1"><span class="nav-number">7.3.1.</span> <span class="nav-text">My Way</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Answer-1"><span class="nav-number">7.3.2.</span> <span class="nav-text">Answer</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-2-5-reverse-extra-Challenging"><span class="nav-number">7.4.</span> <span class="nav-text">Ex 2.5 (reverse extra - Challenging)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-3-Array-reverse"><span class="nav-number">7.5.</span> <span class="nav-text">Ex 3 (Array reverse)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-3-5-Array-Reverse-Extra"><span class="nav-number">7.6.</span> <span class="nav-text">Ex 3.5 (Array Reverse Extra)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ex-Exam-Prep-3"><span class="nav-number">8.</span> <span class="nav-text">Ex (Exam Prep 3)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-1-Skippify"><span class="nav-number">8.1.</span> <span class="nav-text">Ex 1 (Skippify)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ex-2-Remove-Duplicates"><span class="nav-number">8.2.</span> <span class="nav-text">Ex 2 (Remove Duplicates)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Midterm-1-Notes"><span class="nav-number">9.</span> <span class="nav-text">Midterm 1 - Notes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Integer-Cache-Lab-3"><span class="nav-number">10.</span> <span class="nav-text">Integer Cache (Lab 3)</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Junhao Wang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>








        
<div class="busuanzi-count">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://junhaow.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://www.junhaow.com/studynotes/cs61b/cs61b p1.html';
          this.page.identifier = 'studynotes/cs61b/cs61b p1.html';
          this.page.title = 'CS 61B | Part 1 | List (Linked List & Array List)';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://junhaow.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
    
      flOptions = {};
      
          flOptions.iconStyle = "box";
      
          flOptions.boxForm = "horizontal";
      
          flOptions.position = "middleRight";
      
          flOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

  

  
  


  

  


</body>
</html>
