<!DOCTYPE html>




<html class="theme-next pisces" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-bounce.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,300italic,400,400italic,700,700italic|Bitter:300,300italic,400,400italic,700,700italic|Bitter:300,300italic,400,400italic,700,700italic|Menlo:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="junhaow, maodai">










<meta name="description" content="Python åŸºç¡€ç¼–ç é—®é¢˜ ASCIIç¼–ç æ˜¯1ä¸ªå­—èŠ‚ï¼Œè€ŒUnicodeç¼–ç é€šå¸¸æ˜¯2ä¸ªå­—èŠ‚ ä½¿ç”¨UTF-8æœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯ï¼ŒASCIIç¼–ç å®é™…ä¸Šå¯ä»¥è¢«çœ‹æˆæ˜¯UTF-8ç¼–ç çš„ä¸€éƒ¨åˆ†ã€‚ è®¡ç®—æœºå†…å­˜ç¼–ç ç»Ÿä¸€ä½¿ç”¨Unicode ord()å–å¾—å­—ç¬¦çš„æ•´æ•°è¡¨ç¤º å’Œ chr()æŠŠç›¸åº”çš„ç¼–ç è½¬æ¢ä¸ºå­—ç¬¦ å¦‚æœè¦åœ¨ç½‘ç»œä¸Šä¼ è¾“ï¼Œstrç±»å‹è¦å˜æˆbytesç±»å‹ï¼š å¦‚stré€šè¿‡encode()æ–¹æ³•å¯ä»¥ç¼–ç ä¸ºæŒ‡å®šçš„bytes">
<meta property="og:type" content="website">
<meta property="og:title" content="Python å»–é›ªå³°ç½‘ç«™å­¦ä¹ ç¬”è®°">
<meta property="og:url" content="http://www.junhaow.com/studynotes/python/Python å»–é›ªå³°ç½‘ç«™å­¦ä¹ ç¬”è®°.html">
<meta property="og:site_name" content="B_L_OO_GGG">
<meta property="og:description" content="Python åŸºç¡€ç¼–ç é—®é¢˜ ASCIIç¼–ç æ˜¯1ä¸ªå­—èŠ‚ï¼Œè€ŒUnicodeç¼–ç é€šå¸¸æ˜¯2ä¸ªå­—èŠ‚ ä½¿ç”¨UTF-8æœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯ï¼ŒASCIIç¼–ç å®é™…ä¸Šå¯ä»¥è¢«çœ‹æˆæ˜¯UTF-8ç¼–ç çš„ä¸€éƒ¨åˆ†ã€‚ è®¡ç®—æœºå†…å­˜ç¼–ç ç»Ÿä¸€ä½¿ç”¨Unicode ord()å–å¾—å­—ç¬¦çš„æ•´æ•°è¡¨ç¤º å’Œ chr()æŠŠç›¸åº”çš„ç¼–ç è½¬æ¢ä¸ºå­—ç¬¦ å¦‚æœè¦åœ¨ç½‘ç»œä¸Šä¼ è¾“ï¼Œstrç±»å‹è¦å˜æˆbytesç±»å‹ï¼š å¦‚stré€šè¿‡encode()æ–¹æ³•å¯ä»¥ç¼–ç ä¸ºæŒ‡å®šçš„bytes">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-03-12T03:16:58.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python å»–é›ªå³°ç½‘ç«™å­¦ä¹ ç¬”è®°">
<meta name="twitter:description" content="Python åŸºç¡€ç¼–ç é—®é¢˜ ASCIIç¼–ç æ˜¯1ä¸ªå­—èŠ‚ï¼Œè€ŒUnicodeç¼–ç é€šå¸¸æ˜¯2ä¸ªå­—èŠ‚ ä½¿ç”¨UTF-8æœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯ï¼ŒASCIIç¼–ç å®é™…ä¸Šå¯ä»¥è¢«çœ‹æˆæ˜¯UTF-8ç¼–ç çš„ä¸€éƒ¨åˆ†ã€‚ è®¡ç®—æœºå†…å­˜ç¼–ç ç»Ÿä¸€ä½¿ç”¨Unicode ord()å–å¾—å­—ç¬¦çš„æ•´æ•°è¡¨ç¤º å’Œ chr()æŠŠç›¸åº”çš„ç¼–ç è½¬æ¢ä¸ºå­—ç¬¦ å¦‚æœè¦åœ¨ç½‘ç»œä¸Šä¼ è¾“ï¼Œstrç±»å‹è¦å˜æˆbytesç±»å‹ï¼š å¦‚stré€šè¿‡encode()æ–¹æ³•å¯ä»¥ç¼–ç ä¸ºæŒ‡å®šçš„bytes">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.junhaow.com/studynotes/python/Python å»–é›ªå³°ç½‘ç«™å­¦ä¹ ç¬”è®°.html">





  <title>Python å»–é›ªå³°ç½‘ç«™å­¦ä¹ ç¬”è®° | B_L_OO_GGG</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-146643833-1', 'auto');
  ga('send', 'pageview');
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">


  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">B_L_OO_GGG</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Sumomo mo momo mo no uchi</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home


            

            

            

            

            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-inbox"></i> <br>
            
            Archives


            

            
              <span class="badge">49</span>
            

            

            

            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-studynotes">
          <a href="/studynotes/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-pencil"></i> <br>
            
            Study Notes


            

            

            
              <span class="badge">6</span>
            

            

            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-lc">
          <a href="/lc/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            LeetCode Book


            

            

            

            
              <span class="badge badge-lc">251 / âˆ</span>
            

            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-address-card"></i> <br>
            
            About Me


            

            

            

            

            
              <span class="badge-about">ğŸ‘‹</span>
            

          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h1 class="post-title" itemprop="name headline">Python å»–é›ªå³°ç½‘ç«™å­¦ä¹ ç¬”è®°</h1>



</header>

      
      
      
      <div class="post-body">
        
        
          <p><br></p>
<h2 id="Python-åŸºç¡€"><a href="#Python-åŸºç¡€" class="headerlink" title="Python åŸºç¡€"></a>Python åŸºç¡€</h2><h3 id="ç¼–ç é—®é¢˜"><a href="#ç¼–ç é—®é¢˜" class="headerlink" title="ç¼–ç é—®é¢˜"></a>ç¼–ç é—®é¢˜</h3><ul>
<li>ASCIIç¼–ç æ˜¯1ä¸ªå­—èŠ‚ï¼Œè€ŒUnicodeç¼–ç é€šå¸¸æ˜¯2ä¸ªå­—èŠ‚</li>
<li>ä½¿ç”¨UTF-8æœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯ï¼ŒASCIIç¼–ç å®é™…ä¸Šå¯ä»¥è¢«çœ‹æˆæ˜¯UTF-8ç¼–ç çš„ä¸€éƒ¨åˆ†ã€‚</li>
<li>è®¡ç®—æœºå†…å­˜ç¼–ç ç»Ÿä¸€ä½¿ç”¨Unicode</li>
<li>ord()å–å¾—å­—ç¬¦çš„æ•´æ•°è¡¨ç¤º å’Œ chr()æŠŠç›¸åº”çš„ç¼–ç è½¬æ¢ä¸ºå­—ç¬¦</li>
<li>å¦‚æœè¦åœ¨ç½‘ç»œä¸Šä¼ è¾“ï¼Œstrç±»å‹è¦å˜æˆbytesç±»å‹ï¼š<ul>
<li>å¦‚stré€šè¿‡encode()æ–¹æ³•å¯ä»¥ç¼–ç ä¸ºæŒ‡å®šçš„bytes</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'ABC'</span>.encode(<span class="string">'ascii'</span>)</span><br><span class="line"><span class="string">b'ABC'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'ä¸­æ–‡'</span>.encode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="string">b'\xe4\xb8\xad\xe6\x96\x87'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'ä¸­æ–‡'</span>.encode(<span class="string">'ascii'</span>)</span><br><span class="line">Traceback...</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨len()å¯ä»¥æŸ¥çœ‹stræœ‰å¤šå°‘ä¸ªå­—ç¬¦ï¼Œæˆ–è€…æŸ¥çœ‹bytesæœ‰å¤šå°‘ä¸ªå­—èŠ‚ï¼</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">b'ABC'</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">b'\xe4\xb8\xad\xe6\x96\x87'</span>)</span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">'ä¸­æ–‡'</span>.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure>
<h3 id="tuple-amp-list-amp-dict-amp-set"><a href="#tuple-amp-list-amp-dict-amp-set" class="headerlink" title="tuple &amp; list &amp; dict &amp; set"></a>tuple &amp; list &amp; dict &amp; set</h3><ul>
<li>t = (1) è¡¨ç¤º1ï¼Œè€Œ t = (1,) è¡¨ç¤ºtuple</li>
<li>tupleä¸­çš„listå¯ä»¥æ”¹å˜</li>
<li><p>range</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line">  print(name)</span><br><span class="line">list(range(<span class="number">5</span>))</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœdictçš„keyä¸å­˜åœ¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d[<span class="string">'dead'</span>] <span class="comment"># ä¼šæŠ¥é”™</span></span><br><span class="line">d.get(<span class="string">'dead'</span>, <span class="number">55</span>)  <span class="comment"># 55æ˜¯é»˜è®¤å€¼ï¼Œæ³¨æ„ä¸åŠ ç¬¬äºŒä¸ªå‚æ•°çš„è¯ï¼Œè¿”å›None</span></span><br><span class="line"><span class="string">'dead'</span> <span class="keyword">in</span> d  <span class="comment"># return False</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>dictçš„keyåªè¦æ˜¯ä¸å¯å˜çš„ä¸œè¥¿å°±å¯ä»¥ï¼Œæ¯”å¦‚ æ•°(int) å’Œ str</p>
</li>
<li><p>set æœ¬è´¨ä¸Šå’Œdictä¸€æ ·ï¼Œåªæ˜¯æ²¡æœ‰value</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = set([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">s.add(<span class="number">4</span>)</span><br><span class="line">s.remove(<span class="number">2</span>)</span><br><span class="line">s &amp; s</span><br><span class="line">s | s</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¸å¯å˜å¯¹è±¡ï¼Œå¦‚ str, tuple</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">'abc'</span></span><br><span class="line">b = a.replace(<span class="string">'a'</span>, <span class="string">'A'</span>) <span class="comment"># aä¿æŒä¸å˜</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><ul>
<li>help(abs) å¯ä»¥æŸ¥çœ‹abså‡½æ•°çš„å¸®åŠ©ä¿¡æ¯<h3 id="å‡½æ•°åå…¶å®å°±æ˜¯æŒ‡å‘ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„å¼•ç”¨ï¼Œå®Œå…¨å¯ä»¥æŠŠå‡½æ•°åèµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œç›¸å½“äºèµ·äº†ä¸ªåˆ«å"><a href="#å‡½æ•°åå…¶å®å°±æ˜¯æŒ‡å‘ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„å¼•ç”¨ï¼Œå®Œå…¨å¯ä»¥æŠŠå‡½æ•°åèµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œç›¸å½“äºèµ·äº†ä¸ªåˆ«å" class="headerlink" title="å‡½æ•°åå…¶å®å°±æ˜¯æŒ‡å‘ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„å¼•ç”¨ï¼Œå®Œå…¨å¯ä»¥æŠŠå‡½æ•°åèµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œç›¸å½“äºèµ·äº†ä¸ªåˆ«å"></a>å‡½æ•°åå…¶å®å°±æ˜¯æŒ‡å‘ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„å¼•ç”¨ï¼Œå®Œå…¨å¯ä»¥æŠŠå‡½æ•°åèµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œç›¸å½“äºèµ·äº†ä¸ªåˆ«å</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = abs <span class="comment"># å˜é‡aæŒ‡å‘abså‡½æ•°</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a(<span class="number">-1</span>) <span class="comment"># æ‰€ä»¥ä¹Ÿå¯ä»¥é€šè¿‡aè°ƒç”¨abså‡½æ•°</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="å‚æ•°æ£€æŸ¥ï¼Œå¦‚æœå‚æ•°ç±»å‹ä¸å¯¹ï¼Œè‡ªå®šä¹‰çš„å‡½æ•°ä¸ä¼šæ£€æŸ¥"><a href="#å‚æ•°æ£€æŸ¥ï¼Œå¦‚æœå‚æ•°ç±»å‹ä¸å¯¹ï¼Œè‡ªå®šä¹‰çš„å‡½æ•°ä¸ä¼šæ£€æŸ¥" class="headerlink" title="å‚æ•°æ£€æŸ¥ï¼Œå¦‚æœå‚æ•°ç±»å‹ä¸å¯¹ï¼Œè‡ªå®šä¹‰çš„å‡½æ•°ä¸ä¼šæ£€æŸ¥"></a>å‚æ•°æ£€æŸ¥ï¼Œå¦‚æœå‚æ•°ç±»å‹ä¸å¯¹ï¼Œè‡ªå®šä¹‰çš„å‡½æ•°ä¸ä¼šæ£€æŸ¥</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_abs</span><span class="params">(x)</span>:</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> isinstance(x, (int, float)):</span><br><span class="line">    <span class="keyword">raise</span> TypeError(<span class="string">'bad operand type'</span>)</span><br><span class="line">  <span class="keyword">if</span> x &gt;= <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">return</span> -x</span><br></pre></td></tr></table></figure>
<h3 id="é»˜è®¤å‚æ•°çš„å¤§å‘"><a href="#é»˜è®¤å‚æ•°çš„å¤§å‘" class="headerlink" title="é»˜è®¤å‚æ•°çš„å¤§å‘"></a>é»˜è®¤å‚æ•°çš„å¤§å‘</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bad</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_end</span><span class="params">(L=[])</span>:</span></span><br><span class="line">  L.append(<span class="string">'END'</span>)</span><br><span class="line">  <span class="keyword">return</span> L</span><br><span class="line"><span class="comment"># better</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_end</span><span class="params">(L=None)</span>:</span></span><br><span class="line">  <span class="keyword">if</span> L <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    L = []</span><br><span class="line">  L.append(<span class="string">'END'</span>)</span><br><span class="line">  <span class="keyword">return</span> L</span><br></pre></td></tr></table></figure>
<p>åŸå› è§£é‡Šå¦‚ä¸‹ï¼š<br>Pythonå‡½æ•°åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œé»˜è®¤å‚æ•°Lçš„å€¼å°±è¢«è®¡ç®—å‡ºæ¥äº†ï¼Œå³[]ï¼Œå› ä¸ºé»˜è®¤å‚æ•°Lä¹Ÿæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå®ƒæŒ‡å‘å¯¹è±¡[]ï¼Œæ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¦‚æœæ”¹å˜äº†Lçš„å†…å®¹ï¼Œåˆ™ä¸‹æ¬¡è°ƒç”¨æ—¶ï¼Œé»˜è®¤å‚æ•°çš„å†…å®¹å°±å˜äº†ï¼Œä¸å†æ˜¯å‡½æ•°å®šä¹‰æ—¶çš„[]äº†ã€‚<em>å®šä¹‰é»˜è®¤å‚æ•°è¦ç‰¢è®°ä¸€ç‚¹ï¼šé»˜è®¤å‚æ•°å¿…é¡»æŒ‡å‘ä¸å˜å¯¹è±¡ï¼</em></p>
<h3 id="å¯å˜å‚æ•°"><a href="#å¯å˜å‚æ•°" class="headerlink" title="å¯å˜å‚æ•°"></a>å¯å˜å‚æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(*numbers)</span>:</span>  <span class="comment"># å‡½æ•°å†…numbersæ˜¯ä¸€ä¸ªtuple</span></span><br><span class="line">  sum = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> n <span class="keyword">in</span> numbers:</span><br><span class="line">    sum = sum + n * n</span><br><span class="line">  <span class="keyword">return</span> sum</span><br><span class="line"><span class="comment"># calc(1, 2)  calc()</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœå·²ç»æœ‰ä¸€ä¸ªlistæˆ–è€…tupleï¼Œè¦è°ƒç”¨ä¸€ä¸ªå¯å˜å‚æ•°æ€ä¹ˆåŠï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>calc(*nums)</span><br><span class="line"><span class="number">14</span></span><br></pre></td></tr></table></figure>
<h3 id="å…³é”®å­—å‚æ•°ï¼ˆå‚æ•°åæœªå®šï¼‰"><a href="#å…³é”®å­—å‚æ•°ï¼ˆå‚æ•°åæœªå®šï¼‰" class="headerlink" title="å…³é”®å­—å‚æ•°ï¼ˆå‚æ•°åæœªå®šï¼‰"></a>å…³é”®å­—å‚æ•°ï¼ˆå‚æ•°åæœªå®šï¼‰</h3><p>å…³é”®å­—å‚æ•°å…è®¸ä½ ä¼ å…¥0ä¸ªæˆ–ä»»æ„ä¸ªå«å‚æ•°åçš„å‚æ•°ï¼Œè¿™äº›å…³é”®å­—å‚æ•°åœ¨å‡½æ•°å†…éƒ¨è‡ªåŠ¨ç»„è£…ä¸ºä¸€ä¸ªdictã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span><span class="params">(name, age, **kw)</span>:</span></span><br><span class="line">  print(<span class="string">'name:'</span>, name, <span class="string">'age:'</span>, age, <span class="string">'other:'</span>, kw)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨æ–¹æ³•</span></span><br><span class="line"><span class="comment"># bad</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>extra = &#123;<span class="string">'city'</span>: <span class="string">'Beijing'</span>, <span class="string">'job'</span>: <span class="string">'Engineer'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>person(<span class="string">'Jack'</span>, <span class="number">24</span>, city=extra[<span class="string">'city'</span>], job=extra[<span class="string">'job'</span>])</span><br><span class="line">name: Jack age: <span class="number">24</span> other: &#123;<span class="string">'city'</span>: <span class="string">'Beijing'</span>, <span class="string">'job'</span>: <span class="string">'Engineer'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># better</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>extra = &#123;<span class="string">'city'</span>: <span class="string">'Beijing'</span>, <span class="string">'job'</span>: <span class="string">'Engineer'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>person(<span class="string">'Jack'</span>, <span class="number">24</span>, **extra)</span><br><span class="line">name: Jack age: <span class="number">24</span> other: &#123;<span class="string">'city'</span>: <span class="string">'Beijing'</span>, <span class="string">'job'</span>: <span class="string">'Engineer'</span>&#125;</span><br><span class="line"><span class="comment"># æ³¨æ„kwè·å¾—çš„dictæ˜¯extraçš„ä¸€ä»½æ‹·è´ï¼Œå¯¹kwçš„æ”¹åŠ¨ä¸ä¼šå½±å“åˆ°å‡½æ•°å¤–çš„extra</span></span><br><span class="line"><span class="comment"># æ‰€ä»¥ç›´æ¥ä¼ çš„è¯ä¼ çš„æ˜¯å¼•ç”¨ï¼ˆå› ä¸ºæ˜¯å¯å˜å¯¹è±¡ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### å‘½åå…³é”®å­—å‚æ•°</span></span><br><span class="line">é™åˆ¶ä¼ å…¥å…³é”®å­—å‚æ•°çš„åå­—, ä¸”è¾“å…¥æ—¶å¿…é¡»å†™å‡ºå‚æ•°å</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span><span class="params">(name, age, *, city, job)</span>:</span></span><br><span class="line">  print(name, age, city, job)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå‡½æ•°å®šä¹‰ä¸­å·²ç»æœ‰äº†ä¸€ä¸ªå¯å˜å‚æ•°ï¼Œåé¢è·Ÿç€çš„å‘½åå…³é”®å­—å‚æ•°å°±ä¸å†éœ€è¦ä¸€ä¸ªç‰¹æ®Šåˆ†éš”ç¬¦*äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span><span class="params">(name, age, *args, city, job)</span>:</span></span><br><span class="line">  print(name, age, args, city, job)</span><br></pre></td></tr></table></figure>
<p>å‘½åå…³é”®å­—å‚æ•°å¿…é¡»ä¼ å…¥å‚æ•°åï¼Œè¿™å’Œä½ç½®å‚æ•°ä¸åŒã€‚å¦‚æœæ²¡æœ‰ä¼ å…¥å‚æ•°åï¼Œè°ƒç”¨å°†æŠ¥é”™ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>person(<span class="string">'Jack'</span>, <span class="number">24</span>, <span class="string">'Beijing'</span>, <span class="string">'Engineer'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: person() takes <span class="number">2</span> positional arguments but <span class="number">4</span> were given</span><br></pre></td></tr></table></figure>
<p>ç”±äºè°ƒç”¨æ—¶ç¼ºå°‘å‚æ•°åcityå’Œjobï¼ŒPythonè§£é‡Šå™¨æŠŠè¿™4ä¸ªå‚æ•°å‡è§†ä¸ºä½ç½®å‚æ•°ï¼Œä½†person()å‡½æ•°ä»…æ¥å—2ä¸ªä½ç½®å‚æ•°ã€‚</p>
<h3 id="å‚æ•°ç»„åˆ"><a href="#å‚æ•°ç»„åˆ" class="headerlink" title="å‚æ•°ç»„åˆ"></a>å‚æ•°ç»„åˆ</h3><p>åœ¨Pythonä¸­å®šä¹‰å‡½æ•°ï¼Œå¯ä»¥ç”¨å¿…é€‰å‚æ•°ã€é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°ã€å…³é”®å­—å‚æ•°å’Œå‘½åå…³é”®å­—å‚æ•°ï¼Œè¿™5ç§å‚æ•°éƒ½å¯ä»¥ç»„åˆä½¿ç”¨ã€‚</p>
<p>ä½†æ˜¯è¯·æ³¨æ„ï¼Œå‚æ•°å®šä¹‰çš„é¡ºåºå¿…é¡»æ˜¯ï¼šå¿…é€‰å‚æ•°(positional params)ã€é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°ã€å‘½åå…³é”®å­—å‚æ•°å’Œå…³é”®å­—å‚æ•°ã€‚</p>
<p>æ¯”å¦‚å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼ŒåŒ…å«ä¸Šè¿°è‹¥å¹²ç§å‚æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span><span class="params">(a, b, c=<span class="number">0</span>, *args, **kw)</span>:</span>   <span class="comment"># *args å’Œ **kwä¸­é—´å¯ä»¥æ”¾ d</span></span><br><span class="line">  print(<span class="string">'a ='</span>, a, <span class="string">'b ='</span>, b, <span class="string">'c ='</span>, c, <span class="string">'args ='</span>, args, <span class="string">'kw ='</span>, kw)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f2</span><span class="params">(a, b, c=<span class="number">0</span>, *, d, **kw)</span>:</span></span><br><span class="line">  print(<span class="string">'a ='</span>, a, <span class="string">'b ='</span>, b, <span class="string">'c ='</span>, c, <span class="string">'d ='</span>, d, <span class="string">'kw ='</span>, kw)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f1(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">a = <span class="number">1</span> b = <span class="number">2</span> c = <span class="number">0</span> args = () kw = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f1(<span class="number">1</span>, <span class="number">2</span>, c=<span class="number">3</span>)   <span class="comment"># f1(1, 2, 3) ä¹Ÿå¯ä»¥å§</span></span><br><span class="line">a = <span class="number">1</span> b = <span class="number">2</span> c = <span class="number">3</span> args = () kw = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f1(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'a'</span>, <span class="string">'b'</span>)</span><br><span class="line">a = <span class="number">1</span> b = <span class="number">2</span> c = <span class="number">3</span> args = (<span class="string">'a'</span>, <span class="string">'b'</span>) kw = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f1(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, x=<span class="number">99</span>)</span><br><span class="line">a = <span class="number">1</span> b = <span class="number">2</span> c = <span class="number">3</span> args = (<span class="string">'a'</span>, <span class="string">'b'</span>) kw = &#123;<span class="string">'x'</span>: <span class="number">99</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f2(<span class="number">1</span>, <span class="number">2</span>, d=<span class="number">99</span>, ext=<span class="literal">None</span>)</span><br><span class="line">a = <span class="number">1</span> b = <span class="number">2</span> c = <span class="number">0</span> d = <span class="number">99</span> kw = &#123;<span class="string">'ext'</span>: <span class="literal">None</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦™</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>args = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>kw = &#123;<span class="string">'d'</span>: <span class="number">99</span>, <span class="string">'x'</span>: <span class="string">'#'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f1(*args, **kw)</span><br><span class="line">a = <span class="number">1</span> b = <span class="number">2</span> c = <span class="number">3</span> args = (<span class="number">4</span>,) kw = &#123;<span class="string">'d'</span>: <span class="number">99</span>, <span class="string">'x'</span>: <span class="string">'#'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>args = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>kw = &#123;<span class="string">'d'</span>: <span class="number">88</span>, <span class="string">'x'</span>: <span class="string">'#'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f2(*args, **kw)</span><br><span class="line">a = <span class="number">1</span> b = <span class="number">2</span> c = <span class="number">3</span> d = <span class="number">88</span> kw = &#123;<span class="string">'x'</span>: <span class="string">'#'</span>&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œå¯¹äºä»»æ„å‡½æ•°ï¼Œéƒ½å¯ä»¥é€šè¿‡ç±»ä¼¼func(<em>args,*</em>kw)çš„å½¢å¼è°ƒç”¨å®ƒï¼Œæ— è®ºå®ƒçš„å‚æ•°æ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚</p>
<h3 id="å°¾é€’å½’"><a href="#å°¾é€’å½’" class="headerlink" title="å°¾é€’å½’"></a>å°¾é€’å½’</h3><p>åœ¨è®¡ç®—æœºç§‘å­¦é‡Œï¼Œå°¾è°ƒç”¨æ˜¯æŒ‡ä¸€ä¸ªå‡½æ•°é‡Œçš„æœ€åä¸€ä¸ªåŠ¨ä½œæ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„æƒ…å½¢ï¼šå³è¿™ä¸ªè°ƒç”¨çš„è¿”å›å€¼ç›´æ¥è¢«å½“å‰å‡½æ•°è¿”å›çš„æƒ…å½¢ã€‚</p>
<p>å°¾è°ƒç”¨çš„é‡è¦æ€§åœ¨äºå®ƒå¯ä»¥ä¸åœ¨è°ƒç”¨æ ˆä¸Šé¢æ·»åŠ ä¸€ä¸ªæ–°çš„å †æ ˆå¸§â€”â€”è€Œæ˜¯æ›´æ–°å®ƒï¼Œå¦‚åŒè¿­ä»£ä¸€èˆ¬ã€‚å°¾é€’å½’å› è€Œå…·æœ‰ä¸¤ä¸ªç‰¹å¾ï¼š</p>
<ul>
<li>è°ƒç”¨è‡ªèº«å‡½æ•°(Self-called)ï¼›</li>
<li>è®¡ç®—ä»…å ç”¨å¸¸é‡æ ˆç©ºé—´(Stack Space)ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># éå°¾é€’å½’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact</span><span class="params">(n)</span>:</span></span><br><span class="line">  <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">return</span> n * fact(n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°¾é€’å½’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact</span><span class="params">(n)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> fact_iter(n, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact_iter</span><span class="params">(num, product)</span>:</span></span><br><span class="line">  <span class="keyword">if</span> npum == <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">return</span> product</span><br><span class="line">  <span class="keyword">return</span> fact_iter(num - <span class="number">1</span>, num * product)</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå«åš å°¾è°ƒç”¨æ¶ˆé™¤ã€å°¾è°ƒç”¨ä¼˜åŒ–ã€‚è¿™è®©ç¨‹åºå‘˜å¯ä»¥ç”¨é€’å½’å–ä»£å¾ªç¯è€Œä¸ä¸§å¤±æ€§èƒ½ã€‚<br>å°¾é€’å½’äº‹å®ä¸Šå’Œå¾ªç¯æ˜¯ç­‰ä»·çš„ï¼Œæ²¡æœ‰å¾ªç¯è¯­å¥çš„ç¼–ç¨‹è¯­è¨€åªèƒ½é€šè¿‡å°¾é€’å½’å®ç°å¾ªç¯ã€‚</p>
<h2 id="é«˜çº§ç‰¹æ€§"><a href="#é«˜çº§ç‰¹æ€§" class="headerlink" title="é«˜çº§ç‰¹æ€§"></a>é«˜çº§ç‰¹æ€§</h2><p>1è¡Œä»£ç èƒ½å®ç°çš„åŠŸèƒ½ï¼Œå†³ä¸å†™5è¡Œä»£ç ã€‚è¯·å§‹ç»ˆç‰¢è®°ï¼Œä»£ç è¶Šå°‘ï¼Œå¼€å‘æ•ˆç‡è¶Šé«˜ã€‚</p>
<h3 id="åˆ‡ç‰‡"><a href="#åˆ‡ç‰‡" class="headerlink" title="åˆ‡ç‰‡"></a>åˆ‡ç‰‡</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>L = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L[:<span class="number">3</span>]  <span class="comment"># å–å‡ºå‰3ä¸ªå…ƒç´   L[-10:] å10ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L[<span class="number">-1</span>]  <span class="comment"># 5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L[<span class="number">-1</span>:] <span class="comment"># [5]</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L[:<span class="number">-1</span>] <span class="comment"># [1,2,3,4]</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L[<span class="number">-2</span>:<span class="number">-1</span>]  <span class="comment"># [4]</span></span><br><span class="line"><span class="comment"># L[0:3]è¡¨ç¤ºï¼Œä»ç´¢å¼•0å¼€å§‹å–ï¼Œç›´åˆ°ç´¢å¼•3ä¸ºæ­¢ï¼Œä½†ä¸åŒ…æ‹¬ç´¢å¼•3ã€‚ã€Œè‹¥ä»0å¼€å§‹å¯ç†è§£3ä¸ºä¸ªæ•°ã€‚ã€‚ã€</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L[:<span class="number">10</span>:<span class="number">2</span>]   <span class="comment"># å‰10ä¸ªæ•°ï¼Œæ¯2ä¸ªå–ä¸€ä¸ª</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L[:]   <span class="comment"># = copy.copy(L)  åˆ‡ç‰‡éƒ½æ˜¯æµ…å¤åˆ¶</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>)[:<span class="number">3</span>]   <span class="comment"># è¿”å›çš„ç»“æœè¿˜æ˜¯tuple</span></span><br></pre></td></tr></table></figure>
<p>å­—ç¬¦ä¸²â€™xxxâ€™ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ç§listï¼Œæ¯ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ã€‚å› æ­¤ï¼Œå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ç”¨åˆ‡ç‰‡æ“ä½œï¼Œåªæ˜¯æ“ä½œç»“æœä»æ˜¯å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'ABCDEFG'</span>[:<span class="number">3</span>]</span><br><span class="line"><span class="string">'ABC'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'ABCDEFG'</span>[::<span class="number">2</span>]</span><br><span class="line"><span class="string">'ACEG'</span></span><br></pre></td></tr></table></figure>
<p>è®¾è®¡ä¸€ä¸ªtrimå‡½æ•°ç»ƒä¹ </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trim</span><span class="params">(s)</span>:</span></span><br><span class="line">  <span class="keyword">while</span> s[:<span class="number">1</span>] == <span class="string">' '</span>:  <span class="comment"># è¿™é‡Œé’ˆå¯¹å­—ç¬¦ä¸²å¯ä»¥æ¯”è¾ƒ</span></span><br><span class="line">    s = s[<span class="number">1</span>:]</span><br><span class="line">  <span class="keyword">while</span> s[<span class="number">-1</span>:] == <span class="string">' '</span>:</span><br><span class="line">    s = s[:<span class="number">-1</span>]</span><br><span class="line">  <span class="keyword">return</span> s</span><br></pre></td></tr></table></figure>
<h3 id="è¿­ä»£"><a href="#è¿­ä»£" class="headerlink" title="è¿­ä»£"></a>è¿­ä»£</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œdictè¿­ä»£çš„æ˜¯keyã€‚å¦‚æœè¦è¿­ä»£valueï¼Œå¯ä»¥ç”¨ for value in d.values()ï¼›å¦‚æœè¦åŒæ—¶è¿­ä»£keyå’Œvalueï¼Œå¯ä»¥ç”¨ for k, v in d.items()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Iterable</span><br><span class="line">isinstance(<span class="string">'abc'</span>, Iterable)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">True</span></span><br></pre></td></tr></table></figure>
<p>æœ€åä¸€ä¸ªå°é—®é¢˜ï¼Œå¦‚æœè¦å¯¹listå®ç°ç±»ä¼¼Javaé‚£æ ·çš„ä¸‹æ ‡å¾ªç¯æ€ä¹ˆåŠï¼ŸPythonå†…ç½®çš„enumerateå‡½æ•°å¯ä»¥æŠŠä¸€ä¸ªlistå˜æˆç´¢å¼•-å…ƒç´ å¯¹ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨forå¾ªç¯ä¸­åŒæ—¶è¿­ä»£ç´¢å¼•å’Œå…ƒç´ æœ¬èº«ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i, value <span class="keyword">in</span> enumerate([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>]):</span><br><span class="line"><span class="meta">... </span>  print(i, value)</span><br><span class="line">...</span><br><span class="line"><span class="number">0</span> A</span><br><span class="line"><span class="number">1</span> B</span><br><span class="line"><span class="number">2</span> C</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥è¿™æ ·ã€‚ã€‚ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> x, y <span class="keyword">in</span> [(<span class="number">1</span>, <span class="number">1</span>), (<span class="number">2</span>, <span class="number">4</span>), (<span class="number">3</span>, <span class="number">9</span>)]:</span><br><span class="line"><span class="meta">... </span>  print(x, y)</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">4</span></span><br><span class="line"><span class="number">3</span> <span class="number">9</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ—è¡¨ç”Ÿæˆå¼-Lisp-Comprehensions"><a href="#åˆ—è¡¨ç”Ÿæˆå¼-Lisp-Comprehensions" class="headerlink" title="åˆ—è¡¨ç”Ÿæˆå¼ Lisp Comprehensions"></a>åˆ—è¡¨ç”Ÿæˆå¼ Lisp Comprehensions</h3><p>ç”Ÿæˆlistå¯ä»¥ç”¨ list(range(1, 11))</p>
<p>æˆ–è€…ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[x * x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">11</span>)]</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¦æœ‰ifæ¡ä»¶</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[x * x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">11</span>) <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">0</span>]</span><br><span class="line">[<span class="number">4</span>, <span class="number">16</span>, <span class="number">36</span>, <span class="number">64</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸¤å±‚å¾ªç¯</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[m + n <span class="keyword">for</span> m <span class="keyword">in</span> <span class="string">'ABC'</span> <span class="keyword">for</span> n <span class="keyword">in</span> <span class="string">'XYZ'</span>]</span><br><span class="line">[<span class="string">'AX'</span>, <span class="string">'AY'</span>, <span class="string">'AZ'</span>, <span class="string">'BX'</span>, <span class="string">'BY'</span>, <span class="string">'BZ'</span>, <span class="string">'CX'</span>, <span class="string">'CY'</span>, <span class="string">'CZ'</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os <span class="comment"># å¯¼å…¥osæ¨¡å—ï¼Œæ¨¡å—çš„æ¦‚å¿µåé¢è®²åˆ°</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[d <span class="keyword">for</span> d <span class="keyword">in</span> os.listdir(<span class="string">'.'</span>)] <span class="comment"># os.listdirå¯ä»¥åˆ—å‡ºæ–‡ä»¶å’Œç›®å½•</span></span><br><span class="line">[<span class="string">'.emacs.d'</span>, <span class="string">'.ssh'</span>, <span class="string">'.Trash'</span>, <span class="string">'Adlm'</span>, <span class="string">'Applications'</span>, <span class="string">'Desktop'</span>, <span class="string">'Documents'</span>, <span class="string">'Downloads'</span>, <span class="string">'Library'</span>, <span class="string">'Movies'</span>, <span class="string">'Music'</span>, <span class="string">'Pictures'</span>, <span class="string">'Public'</span>, <span class="string">'VirtualBox VMs'</span>, <span class="string">'Workspace'</span>, <span class="string">'XCode'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—è¡¨ç”Ÿæˆå¼ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå˜é‡æ¥ç”Ÿæˆlist</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'x'</span>: <span class="string">'A'</span>, <span class="string">'y'</span>: <span class="string">'B'</span>, <span class="string">'z'</span>: <span class="string">'C'</span> &#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[k + <span class="string">'='</span> + v <span class="keyword">for</span> k, v <span class="keyword">in</span> d.items()]</span><br><span class="line">[<span class="string">'y=B'</span>, <span class="string">'x=A'</span>, <span class="string">'z=C'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠä¸€ä¸ªlistä¸­æ‰€æœ‰çš„å­—ç¬¦ä¸²å˜æˆå°å†™</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L = [<span class="string">'Hello'</span>, <span class="string">'World'</span>, <span class="string">'IBM'</span>, <span class="string">'Apple'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[s.lower() <span class="keyword">for</span> s <span class="keyword">in</span> L]</span><br><span class="line">[<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="string">'ibm'</span>, <span class="string">'apple'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªæœ‰è¶£</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[s.lower() <span class="keyword">if</span> isinstance(s, str) <span class="keyword">else</span> s <span class="keyword">for</span> s <span class="keyword">in</span> L]</span><br><span class="line"><span class="comment"># [s.lower() for s in L1 if isinstance(s, str) else s for s in L1] é”™çš„</span></span><br></pre></td></tr></table></figure>
<h3 id="ç”Ÿæˆå™¨"><a href="#ç”Ÿæˆå™¨" class="headerlink" title="ç”Ÿæˆå™¨"></a>ç”Ÿæˆå™¨</h3><p>å¦‚æœåˆ—è¡¨å…ƒç´ å¯ä»¥æŒ‰ç…§æŸç§ç®—æ³•æ¨ç®—å‡ºæ¥ï¼Œé‚£æˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨å¾ªç¯çš„è¿‡ç¨‹ä¸­ä¸æ–­æ¨ç®—å‡ºåç»­çš„å…ƒç´ å‘¢ï¼Ÿè¿™æ ·å°±ä¸å¿…åˆ›å»ºå®Œæ•´çš„listï¼Œä»è€ŒèŠ‚çœå¤§é‡çš„ç©ºé—´ã€‚åœ¨Pythonä¸­ï¼Œè¿™ç§ä¸€è¾¹å¾ªç¯ä¸€è¾¹è®¡ç®—çš„æœºåˆ¶ï¼Œç§°ä¸ºç”Ÿæˆå™¨ï¼šgeneratorã€‚ã€Œè§£å†³listå¤§é‡å ç”¨å†…å­˜çš„é—®é¢˜ã€</p>
<p>ç”Ÿæˆæ–¹æ³•ï¼š</p>
<ol>
<li>æŠŠlistç”Ÿæˆå¼æ”¹æˆ()</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(g)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(g)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(g)</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> n <span class="keyword">in</span> g:</span><br><span class="line"><span class="meta">... </span>  print(n)</span><br></pre></td></tr></table></figure>
<ol>
<li>æœ‰äº›å¤æ‚çš„å°±æ— æ³•ç”¨1.çš„æ–¹æ³•ç”Ÿæˆï¼Œä½†æ˜¯ç”¨å‡½æ•°æ‰“å°å‡ºæ¥åˆå®¹æ˜“ï¼š</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(max)</span>:</span></span><br><span class="line">  n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">  <span class="keyword">while</span> n &lt; max:</span><br><span class="line">    print(b)   <span class="comment"># yield b</span></span><br><span class="line">    a, b = b, a + b</span><br><span class="line">    n = n + <span class="number">1</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">'done'</span></span><br><span class="line">  <span class="comment"># æ³¨æ„ a, b = b, a + b</span></span><br><span class="line">  <span class="comment"># ç›¸å½“äº</span></span><br><span class="line">t = (b, a + b) <span class="comment"># tæ˜¯ä¸€ä¸ªtuple</span></span><br><span class="line">a = t[<span class="number">0</span>]</span><br><span class="line">b = t[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>æƒ³è¦æŠŠä¸Šè¿°ä»£ç å˜æˆgeneratorï¼Œåªè¦æŠŠ print(b) å˜æˆ yield b å°±å¯ä»¥äº†</p>
<p>è¿™å°±æ˜¯å®šä¹‰generatorçš„å¦ä¸€ç§æ–¹æ³•ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸­åŒ…å«yieldå…³é”®å­—ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±ä¸å†æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªgenerator.</p>
<p>è¿™é‡Œï¼Œæœ€éš¾ç†è§£çš„å°±æ˜¯generatorå’Œå‡½æ•°çš„æ‰§è¡Œæµç¨‹ä¸ä¸€æ ·ã€‚å‡½æ•°æ˜¯é¡ºåºæ‰§è¡Œï¼Œé‡åˆ°returnè¯­å¥æˆ–è€…æœ€åä¸€è¡Œå‡½æ•°è¯­å¥å°±è¿”å›ã€‚è€Œå˜æˆgeneratorçš„å‡½æ•°ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨next()çš„æ—¶å€™æ‰§è¡Œï¼Œé‡åˆ°yieldè¯­å¥è¿”å›ï¼Œå†æ¬¡æ‰§è¡Œæ—¶ä»ä¸Šæ¬¡è¿”å›çš„yieldè¯­å¥å¤„ç»§ç»­æ‰§è¡Œã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">odd</span><span class="params">()</span>:</span></span><br><span class="line">  print(<span class="string">'step 1'</span>)</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">  print(<span class="string">'step 2'</span>)</span><br><span class="line">  <span class="keyword">yield</span>(<span class="number">3</span>)</span><br><span class="line">  print(<span class="string">'step 3'</span>)</span><br><span class="line">  <span class="keyword">yield</span>(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>o = odd()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(o)</span><br><span class="line">step <span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(o)</span><br><span class="line">step <span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>next(o)</span><br><span class="line">step <span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>ç”¨forå¾ªç¯è°ƒç”¨generatoræ—¶ï¼Œå‘ç°æ‹¿ä¸åˆ°generatorçš„returnè¯­å¥çš„è¿”å›å€¼ã€‚å¦‚æœæƒ³è¦æ‹¿åˆ°è¿”å›å€¼ï¼Œå¿…é¡»æ•è·StopIterationé”™è¯¯ï¼Œè¿”å›å€¼åŒ…å«åœ¨StopIterationçš„valueä¸­ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>g = fib(<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="meta">... </span>  <span class="keyword">try</span>:</span><br><span class="line"><span class="meta">... </span>    x = next(g)</span><br><span class="line"><span class="meta">... </span>    print(<span class="string">'g:'</span>, x)</span><br><span class="line"><span class="meta">... </span>  <span class="keyword">except</span> StopIteration <span class="keyword">as</span> e:</span><br><span class="line"><span class="meta">... </span>    print(<span class="string">'Generator return value:'</span>, e.value)</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">break</span></span><br><span class="line">...</span><br><span class="line">g: <span class="number">1</span></span><br><span class="line">g: <span class="number">1</span></span><br><span class="line">g: <span class="number">2</span></span><br><span class="line">Generator <span class="keyword">return</span> value: done</span><br></pre></td></tr></table></figure>
<h3 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h3><p>å¯è¿­ä»£å¯¹è±¡ï¼šIterableã€Œå¯ç”¨äºforå¾ªç¯ã€</p>
<ul>
<li>é›†åˆæ•°æ®ç±»å‹ï¼Œå¦‚listã€tupleã€dictã€setã€strç­‰ï¼›</li>
<li>generatorï¼ŒåŒ…æ‹¬ç”Ÿæˆå™¨å’Œå¸¦yieldçš„generator functionã€‚</li>
</ul>
<blockquote>
<p>ç”Ÿæˆå™¨æ˜¯åªèƒ½éå†ä¸€æ¬¡çš„ã€‚<br>ç”Ÿæˆå™¨æ˜¯ä¸€ç±»ç‰¹æ®Šçš„è¿­ä»£å™¨ã€‚</p>
</blockquote>
<p>å®Œå…¨ç†è§£Pythonè¿­ä»£å¯¹è±¡ã€è¿­ä»£å™¨ã€ç”Ÿæˆå™¨:<br><a href="https://foofish.net/iterators-vs-generators.html" target="_blank" rel="noopener">https://foofish.net/iterators-vs-generators.html</a></p>
<p>ç”Ÿæˆå™¨ä¸ä½†å¯ä»¥ä½œç”¨äºforå¾ªç¯ï¼Œè¿˜å¯ä»¥è¢«next()å‡½æ•°ä¸æ–­è°ƒç”¨å¹¶è¿”å›ä¸‹ä¸€ä¸ªå€¼ï¼Œç›´åˆ°æœ€åæŠ›å‡ºStopIterationé”™è¯¯è¡¨ç¤ºæ— æ³•ç»§ç»­è¿”å›ä¸‹ä¸€ä¸ªå€¼äº†ã€‚</p>
<p>å¯ä»¥è¢«next()å‡½æ•°è°ƒç”¨å¹¶ä¸æ–­è¿”å›ä¸‹ä¸€ä¸ªå€¼çš„å¯¹è±¡ç§°ä¸ºè¿­ä»£å™¨ï¼šIteratorã€‚ã€Œéƒ½å¯ä»¥ç”¨isinstanceåˆ¤æ–­ã€</p>
<p>æŠŠlistã€dictã€strç­‰Iterableå˜æˆIteratorå¯ä»¥ä½¿ç”¨iter()å‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(iter([]), Iterator)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(iter(<span class="string">'abc'</span>), Iterator)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>
<p>Iteratorçš„è®¡ç®—æ˜¯æƒ°æ€§çš„ï¼Œåªæœ‰åœ¨éœ€è¦è¿”å›ä¸‹ä¸€ä¸ªæ•°æ®æ—¶å®ƒæ‰ä¼šè®¡ç®—ã€‚</p>
<p>Pythonçš„forå¾ªç¯æœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡ä¸æ–­è°ƒç”¨next()å‡½æ•°å®ç°çš„ã€‚</p>
<h2 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h2><p>å‡½æ•°å¼ç¼–ç¨‹è™½ç„¶å¯ä»¥å½’ç»“åˆ°é¢å‘è¿‡ç¨‹çš„ç¨‹åºè®¾è®¡ï¼Œä½†å…¶æ€æƒ³æ›´æ¥è¿‘æ•°å­¦è®¡ç®—ã€‚</p>
<p>å‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯ä¸€ç§æŠ½è±¡ç¨‹åº¦å¾ˆé«˜çš„ç¼–ç¨‹èŒƒå¼ï¼Œçº¯ç²¹çš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„å‡½æ•°æ²¡æœ‰å˜é‡ï¼Œå› æ­¤ï¼Œä»»æ„ä¸€ä¸ªå‡½æ•°ï¼Œåªè¦è¾“å…¥æ˜¯ç¡®å®šçš„ï¼Œè¾“å‡ºå°±æ˜¯ç¡®å®šçš„ï¼Œè¿™ç§çº¯å‡½æ•°æˆ‘ä»¬ç§°ä¹‹ä¸ºæ²¡æœ‰å‰¯ä½œç”¨ã€‚è€Œå…è®¸ä½¿ç”¨å˜é‡çš„ç¨‹åºè®¾è®¡è¯­è¨€ï¼Œç”±äºå‡½æ•°å†…éƒ¨çš„å˜é‡çŠ¶æ€ä¸ç¡®å®šï¼ŒåŒæ ·çš„è¾“å…¥ï¼Œå¯èƒ½å¾—åˆ°ä¸åŒçš„è¾“å‡ºï¼Œå› æ­¤ï¼Œè¿™ç§å‡½æ•°æ˜¯æœ‰å‰¯ä½œç”¨çš„ã€‚</p>
<p>å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯ï¼Œå…è®¸æŠŠå‡½æ•°æœ¬èº«ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°ï¼Œè¿˜å…è®¸è¿”å›ä¸€ä¸ªå‡½æ•°ï¼</p>
<p>Pythonå¯¹å‡½æ•°å¼ç¼–ç¨‹æä¾›éƒ¨åˆ†æ”¯æŒã€‚ç”±äºPythonå…è®¸ä½¿ç”¨å˜é‡ï¼Œå› æ­¤ï¼ŒPythonä¸æ˜¯çº¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ã€‚</p>
<p>Key Principle: All computation is the execution of mathematical functions.</p>
<ul>
<li>Programming paradigm; A mindset</li>
<li><p>Rooted in mathematics</p>
</li>
<li><p>canâ€™t change their inputs</p>
</li>
<li>canâ€™t chagne variables (Immutability)<br>e.g., x = x + 1;  for(i = 0; i &lt; 10; i++)  XXXXXXXXXXXXX</li>
<li>donâ€™t iterate</li>
</ul>
<p>-&gt; Programming without variable assignment; lose some expressability</p>
<p>Not pure / pure func. = return value</p>
<p>Make programming:</p>
<ul>
<li>Programs are logical</li>
<li>Built for distributed computing(no interference between funcitons)</li>
</ul>
<h3 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h3><p>ç¼–å†™é«˜é˜¶å‡½æ•°ï¼Œå°±æ˜¯è®©å‡½æ•°çš„å‚æ•°èƒ½å¤Ÿæ¥æ”¶åˆ«çš„å‡½æ•°ã€‚</p>
<ul>
<li>å˜é‡å¯ä»¥æŒ‡å‘å‡½æ•°</li>
<li>å‡½æ•°åä¹Ÿæ˜¯å˜é‡</li>
<li><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>abs = <span class="number">10</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>abs(<span class="number">-10</span>)</span><br><span class="line">Traceback</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¼ å…¥å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y, f)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> f(x) + f(y)</span><br><span class="line">add(<span class="number">-5</span>, <span class="number">6</span>, abs)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="map-reduce"><a href="#map-reduce" class="headerlink" title="map/reduce"></a>map/reduce</h4><p>æˆ‘ä»¬å…ˆçœ‹mapã€‚map()å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯Iterableï¼Œmapå°†ä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨åˆ°åºåˆ—çš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶æŠŠç»“æœä½œä¸ºæ–°çš„Iteratorè¿”å›ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line"><span class="meta">... </span>  <span class="keyword">return</span> x * x</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r = map(f, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(r)</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>]</span><br></pre></td></tr></table></figure>
<p>ç”±äºç»“æœræ˜¯ä¸€ä¸ªIteratorï¼ŒIteratoræ˜¯æƒ°æ€§åºåˆ—ï¼Œå› æ­¤é€šè¿‡list()å‡½æ•°è®©å®ƒæŠŠæ•´ä¸ªåºåˆ—éƒ½è®¡ç®—å‡ºæ¥å¹¶è¿”å›ä¸€ä¸ªlistã€‚</p>
<p>å†çœ‹reduceçš„ç”¨æ³•ã€‚reduceæŠŠä¸€ä¸ªå‡½æ•°ä½œç”¨åœ¨ä¸€ä¸ªåºåˆ—[x1, x2, x3, â€¦]ä¸Šï¼Œè¿™ä¸ªå‡½æ•°å¿…é¡»æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ŒreduceæŠŠç»“æœç»§ç»­å’Œåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ åšç´¯ç§¯è®¡ç®—ï¼Œå…¶æ•ˆæœå°±æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y)</span>:</span></span><br><span class="line"><span class="meta">... </span>  <span class="keyword">return</span> x + y</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reduce(add, [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>])</span><br><span class="line"><span class="number">25</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(x, y)</span>:</span></span><br><span class="line"><span class="meta">... </span>  <span class="keyword">return</span> x * <span class="number">10</span> + y</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reduce(fn, [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>])</span><br><span class="line"><span class="number">13579</span></span><br></pre></td></tr></table></figure>
<p>å½“ç„¶æ±‚å’Œè¿ç®—å¯ä»¥ç›´æ¥ç”¨Pythonå†…å»ºå‡½æ•°sum()ï¼Œæ²¡å¿…è¦åŠ¨ç”¨reduceã€‚</p>
<p>ä¸¤è€…é…åˆï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(x, y)</span>:</span></span><br><span class="line"><span class="meta">... </span>  <span class="keyword">return</span> x * <span class="number">10</span> + y</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">char2num</span><span class="params">(s)</span>:</span></span><br><span class="line"><span class="meta">... </span>  digits = &#123;<span class="string">'0'</span>: <span class="number">0</span>, <span class="string">'1'</span>: <span class="number">1</span>, <span class="string">'2'</span>: <span class="number">2</span>, <span class="string">'3'</span>: <span class="number">3</span>, <span class="string">'4'</span>: <span class="number">4</span>, <span class="string">'5'</span>: <span class="number">5</span>, <span class="string">'6'</span>: <span class="number">6</span>, <span class="string">'7'</span>: <span class="number">7</span>, <span class="string">'8'</span>: <span class="number">8</span>, <span class="string">'9'</span>: <span class="number">9</span>&#125;</span><br><span class="line"><span class="meta">... </span>  <span class="keyword">return</span> digits[s]</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reduce(fn, map(char2num, <span class="string">'13579'</span>))</span><br><span class="line"><span class="number">13579</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†è¿›ä¸€æ­¥æ•´ç†æˆä¸€ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2int</span><span class="params">(s)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">10</span> + y</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">char2num</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> DIGITS[s]</span><br><span class="line">  <span class="keyword">return</span> reduce(fn, map(char2num, s))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨lambdaå‡½æ•°è¿›ä¸€æ­¥ç®€åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">char2num</span><span class="params">(s)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> DIGITS[s]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2int</span><span class="params">(s)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x * <span class="number">10</span> + y, map(char2num, s))</span><br></pre></td></tr></table></figure>
<p>æ±‚ç§¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prod</span><span class="params">(L)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x * y, L)</span><br></pre></td></tr></table></figure>
<h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>å’Œmap()ä¸åŒçš„æ˜¯ï¼Œfilter()æŠŠä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨äºæ¯ä¸ªå…ƒç´ ï¼Œç„¶åæ ¹æ®è¿”å›å€¼æ˜¯Trueè¿˜æ˜¯Falseå†³å®šä¿ç•™è¿˜æ˜¯ä¸¢å¼ƒè¯¥å…ƒç´ ã€‚</p>
<p>æŠŠä¸€ä¸ªåºåˆ—ä¸­çš„ç©ºå­—ç¬¦ä¸²åˆ æ‰ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">not_empty</span><span class="params">(s)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> s <span class="keyword">and</span> s.strip()</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(filter(not_empty, [<span class="string">'A'</span>, <span class="string">''</span>, <span class="string">'B'</span>, <span class="literal">None</span>, <span class="string">'C'</span>, <span class="string">'  '</span>]))</span><br><span class="line">[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>]</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°filter()å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªIteratorï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæƒ°æ€§åºåˆ—ï¼Œæ‰€ä»¥è¦å¼ºè¿«filter()å®Œæˆè®¡ç®—ç»“æœï¼Œéœ€è¦ç”¨list()å‡½æ•°è·å¾—æ‰€æœ‰ç»“æœå¹¶è¿”å›listã€‚</p>
<h5 id="ç­›é€‰ç´ æ•°"><a href="#ç­›é€‰ç´ æ•°" class="headerlink" title="ç­›é€‰ç´ æ•°"></a>ç­›é€‰ç´ æ•°</h5><p>å…ˆå†™ä¸€ä¸ªä»3å¼€å§‹çš„å¥‡æ•°åºåˆ—ï¼šã€Œç”Ÿæˆå™¨ï¼Œæ˜¯ä¸€ä¸ªæ— é™åºåˆ—ã€</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_odd_iter</span><span class="params">()</span>:</span></span><br><span class="line">  n = <span class="number">1</span></span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    n = n + <span class="number">2</span></span><br><span class="line">    <span class="keyword">yield</span> n</span><br></pre></td></tr></table></figure>
<p>ç­›é€‰å‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_not_divisible</span><span class="params">(n)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">lambda</span> x: x % n &gt; <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>æœ€åï¼Œå®šä¹‰ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œä¸æ–­è¿”å›ä¸‹ä¸€ä¸ªç´ æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">primes</span><span class="params">()</span>:</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">  it = _odd_iter() <span class="comment"># åˆå§‹åºåˆ—</span></span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    n = next(it) <span class="comment"># è¿”å›åºåˆ—çš„ç¬¬ä¸€ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">yield</span> n</span><br><span class="line">    it = filter(_not_divisible(n), it) <span class="comment"># æ„é€ æ–°åºåˆ—</span></span><br></pre></td></tr></table></figure>
<h5 id="ç­›é€‰å›æ•°"><a href="#ç­›é€‰å›æ•°" class="headerlink" title="ç­›é€‰å›æ•°"></a>ç­›é€‰å›æ•°</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_palindrome</span><span class="params">(n)</span>:</span></span><br><span class="line">  i = <span class="number">0</span></span><br><span class="line">  lg = len(str(n))</span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span> <span class="keyword">and</span> i &lt; lg // <span class="number">2</span>:</span><br><span class="line">    left = n // (<span class="number">10</span> ** (lg - i - <span class="number">1</span>)) % <span class="number">10</span></span><br><span class="line">    right = (n % (<span class="number">10</span> ** (i + <span class="number">1</span>))) // (<span class="number">10</span> ** i)</span><br><span class="line">    <span class="keyword">if</span> left == right:</span><br><span class="line">      i = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´ç²¾ç®€çš„åŠæ³•</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_palindrome</span><span class="params">(n)</span>:</span></span><br><span class="line">  N = str(n)</span><br><span class="line">  <span class="keyword">return</span> N == N[::<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>
<h4 id="sorted"><a href="#sorted" class="headerlink" title="sorted"></a>sorted</h4><p>sorted()å‡½æ•°å¼ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå®ƒå¯ä»¥æ¥æ”¶ä¸€ä¸ªkeyçš„å‡½æ•°æ¥å®ç°è‡ªå®šä¹‰çš„æ’åºã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted([<span class="number">36</span>, <span class="number">5</span>, <span class="number">-12</span>, <span class="number">9</span>, <span class="number">-21</span>], key=abs)</span><br><span class="line">[<span class="number">5</span>, <span class="number">9</span>, <span class="number">-12</span>, <span class="number">-21</span>, <span class="number">36</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted([<span class="string">'bob'</span>, <span class="string">'about'</span>, <span class="string">'Zoo'</span>, <span class="string">'Credit'</span>], key=str.lower)</span><br><span class="line">[<span class="string">'about'</span>, <span class="string">'bob'</span>, <span class="string">'Credit'</span>, <span class="string">'Zoo'</span>]</span><br><span class="line"><span class="comment"># åå‘æ’åº</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted([<span class="string">'bob'</span>, <span class="string">'about'</span>, <span class="string">'Zoo'</span>, <span class="string">'Credit'</span>], key=str.lower, reverse=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h3 id="è¿”å›å‡½æ•°"><a href="#è¿”å›å‡½æ•°" class="headerlink" title="è¿”å›å‡½æ•° ???"></a>è¿”å›å‡½æ•° ???</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lazy_sum</span><span class="params">(*args)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">sum</span><span class="params">()</span>:</span></span><br><span class="line">    ax = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> args:</span><br><span class="line">      ax = ax + n</span><br><span class="line">    <span class="keyword">return</span> ax</span><br><span class="line">  <span class="keyword">return</span> sum</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f1 = lazy_sum(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f2 = lazy_sum(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f1==f2</span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></table></figure>
<p>é—­åŒ…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">()</span>:</span></span><br><span class="line">  fs = []</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></span><br><span class="line">       <span class="keyword">return</span> i*i</span><br><span class="line">    fs.append(f)</span><br><span class="line">  <span class="keyword">return</span> fs</span><br><span class="line"></span><br><span class="line">f1, f2, f3 = count()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f1()</span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f2()</span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f3()</span><br><span class="line"><span class="number">9</span></span><br><span class="line"></span><br><span class="line">å…¨éƒ¨éƒ½æ˜¯<span class="number">9</span>ï¼åŸå› å°±åœ¨äºè¿”å›çš„å‡½æ•°å¼•ç”¨äº†å˜é‡iï¼Œä½†å®ƒå¹¶éç«‹åˆ»æ‰§è¡Œã€‚ç­‰åˆ°<span class="number">3</span>ä¸ªå‡½æ•°éƒ½è¿”å›æ—¶ï¼Œå®ƒä»¬æ‰€å¼•ç”¨çš„å˜é‡iå·²ç»å˜æˆäº†<span class="number">3</span>ï¼Œå› æ­¤æœ€ç»ˆç»“æœä¸º<span class="number">9</span>ã€‚</span><br><span class="line"></span><br><span class="line">è¿”å›é—­åŒ…æ—¶ç‰¢è®°ä¸€ç‚¹ï¼šè¿”å›å‡½æ•°ä¸è¦å¼•ç”¨ä»»ä½•å¾ªç¯å˜é‡ï¼Œæˆ–è€…åç»­ä¼šå‘ç”Ÿå˜åŒ–çš„å˜é‡ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="åŒ¿åå‡½æ•°-lambda"><a href="#åŒ¿åå‡½æ•°-lambda" class="headerlink" title="åŒ¿åå‡½æ•° lambda"></a>åŒ¿åå‡½æ•° lambda</h3><p>å½“æˆ‘ä»¬ä¸éœ€è¦æ˜¾å¼åœ°å®šä¹‰å‡½æ•°æ—¶ï¼Œç›´æ¥ä¼ å…¥åŒ¿åå‡½æ•°æ›´æ–¹ä¾¿ï¼</p>
<p>åŒ¿åå‡½æ•°æœ‰ä¸ªé™åˆ¶ï¼Œå°±æ˜¯åªèƒ½æœ‰ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¸ç”¨å†™returnï¼Œè¿”å›å€¼å°±æ˜¯è¯¥è¡¨è¾¾å¼çš„ç»“æœã€‚</p>
<h3 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h3><p>åœ¨ä»£ç è¿è¡ŒæœŸé—´åŠ¨æ€å¢åŠ åŠŸèƒ½çš„æ–¹å¼ï¼Œç§°ä¹‹ä¸ºâ€œè£…é¥°å™¨â€ï¼ˆDecoratorï¼‰ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿”å›å‡½æ•°çš„é«˜é˜¶å‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(func)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">    print(<span class="string">'call %s():'</span> % func.__name__)</span><br><span class="line">    <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">  <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿä¸Šé¢çš„logï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªdecoratorï¼Œæ‰€ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬è¦å€ŸåŠ©Pythonçš„@è¯­æ³•ï¼ŒæŠŠdecoratorç½®äºå‡½æ•°çš„å®šä¹‰å¤„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span><span class="params">()</span>:</span></span><br><span class="line">  print(<span class="string">'2015-3-25'</span>)</span><br><span class="line"><span class="comment"># è¿™é‡Œç›¸å½“äºæ‰§è¡Œäº† now = log(now)</span></span><br></pre></td></tr></table></figure>
<p>ç”±äºlog()æ˜¯ä¸€ä¸ªdecoratorï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ï¼ŒåŸæ¥çš„now()å‡½æ•°ä»ç„¶å­˜åœ¨ï¼Œåªæ˜¯ç°åœ¨åŒåçš„nowå˜é‡æŒ‡å‘äº†æ–°çš„å‡½æ•°ï¼Œäºæ˜¯è°ƒç”¨now()å°†æ‰§è¡Œæ–°å‡½æ•°ï¼Œå³åœ¨log()å‡½æ•°ä¸­è¿”å›çš„wrapper()å‡½æ•°ã€‚</p>
<p>wrapper()å‡½æ•°çš„å‚æ•°å®šä¹‰æ˜¯(<em>args,*</em>kw)ï¼Œå› æ­¤ï¼Œwrapper()å‡½æ•°å¯ä»¥æ¥å—ä»»æ„å‚æ•°çš„è°ƒç”¨ã€‚åœ¨wrapper()å‡½æ•°å†…ï¼Œé¦–å…ˆæ‰“å°æ—¥å¿—ï¼Œå†ç´§æ¥ç€è°ƒç”¨åŸå§‹å‡½æ•°ã€‚</p>
<p>å¦‚æœdecoratoræœ¬èº«éœ€è¦ä¼ å…¥å‚æ•°ï¼Œé‚£å°±éœ€è¦ç¼–å†™ä¸€ä¸ªè¿”å›decoratorçš„é«˜é˜¶å‡½æ•°ï¼Œå†™å‡ºæ¥ä¼šæ›´å¤æ‚ã€‚æ¯”å¦‚ï¼Œè¦è‡ªå®šä¹‰logçš„æ–‡æœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(text)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">decorator</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">      print(<span class="string">'%s %s():'</span> % (text, func.__name__))</span><br><span class="line">      <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line">  <span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line"><span class="meta">@log('execute')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span><span class="params">()</span>:</span></span><br><span class="line">  print(<span class="string">'2015-3-25'</span>)</span><br><span class="line"><span class="comment"># now = log('execute')(now)</span></span><br></pre></td></tr></table></figure>
<p>æœ€åï¼Œä½¿ç”¨è£…é¥°å™¨åï¼Œ<strong>name</strong>å·²ç»ä»åŸæ¥çš„â€™nowâ€™å˜æˆâ€™wrapperâ€™ã€‚<br>è‹¥ä»£ç ä¾èµ–å‡½æ•°ç­¾åï¼Œè¦è¿™æ ·åšï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">  @functools.wraps(func)  # ä¸éœ€è¦å†™ wrapper.__name__ = func.__name__</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></span><br><span class="line">    print(<span class="string">'call %s():'</span> % func.__name__)</span><br><span class="line">    <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">  <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>
<p>åœ¨é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰çš„è®¾è®¡æ¨¡å¼ä¸­ï¼Œdecoratorè¢«ç§°ä¸ºè£…é¥°æ¨¡å¼ã€‚OOPçš„è£…é¥°æ¨¡å¼éœ€è¦é€šè¿‡ç»§æ‰¿å’Œç»„åˆæ¥å®ç°ï¼Œè€ŒPythoné™¤äº†èƒ½æ”¯æŒOOPçš„decoratorå¤–ï¼Œç›´æ¥ä»è¯­æ³•å±‚æ¬¡æ”¯æŒdecoratorã€‚Pythonçš„decoratorå¯ä»¥ç”¨å‡½æ•°å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨ç±»å®ç°ã€‚</p>
<h3 id="åå‡½æ•°"><a href="#åå‡½æ•°" class="headerlink" title="åå‡½æ•°"></a>åå‡½æ•°</h3><p>å½“å‡½æ•°çš„å‚æ•°ä¸ªæ•°å¤ªå¤šï¼Œéœ€è¦ç®€åŒ–æ—¶ï¼Œä½¿ç”¨functools.partialå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªæ–°å‡½æ•°å¯ä»¥å›ºå®šä½åŸå‡½æ•°çš„éƒ¨åˆ†å‚æ•°ï¼Œä»è€Œåœ¨è°ƒç”¨æ—¶æ›´ç®€å•ã€‚</p>
<p>å‡è®¾è¦è½¬æ¢å¤§é‡çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡éƒ½ä¼ å…¥int(x, base=2)éå¸¸éº»çƒ¦ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬æƒ³åˆ°ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªint2()çš„å‡½æ•°ï¼Œé»˜è®¤æŠŠbase=2ä¼ è¿›å»ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2</span><span class="params">(x, base=<span class="number">2</span>)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> int(x, base)</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ç”¨è‡ªå¸¦çš„å·¥å…·ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> functools</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>int2 = functools.partial(int, base=<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>int2(<span class="string">'1000000'</span>)</span><br><span class="line"><span class="number">64</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>int2(<span class="string">'1010101'</span>)</span><br><span class="line"><span class="number">85</span></span><br></pre></td></tr></table></figure>
<p>åŸç†ï¼š<br>åˆ›å»ºåå‡½æ•°æ—¶ï¼Œå®é™…ä¸Šå¯ä»¥æ¥æ”¶å‡½æ•°å¯¹è±¡ã€<em>argså’Œ*</em>kwè¿™3ä¸ªå‚æ•°ã€‚</p>
<p>å¦‚ int2 = functools.partial(int, base=2)<br>å®é™…ä¸Šæ˜¯ kw = {â€˜baseâ€™: 2}; int(â€˜10010â€™, **kw)</p>
<p>å¦‚ max2 = functools.partial(max, 10)<br>å®é™…ä¸Šæ˜¯ args = (10, â€¦); max(*args) ã€Œmax(10, â€¦)ã€</p>
<h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h2><h3 id="åŒ…-Package"><a href="#åŒ…-Package" class="headerlink" title="åŒ… Package"></a>åŒ… Package</h3><p>å¼•å…¥åŒ…ä»¥è§£å†³æ¨¡å—é—´çš„å†²çªï¼Œè€Œä¸”è‡ªå·±åˆ›å»ºçš„æ¨¡å—æ— è®ºå¦‚ä½•éƒ½ä¸å¯ä»¥å’Œè‡ªå¸¦çš„é‡åã€‚</p>
<p>mycompany<br>â”œâ”€ web<br>â”‚  â”œâ”€ <strong>init</strong>.py<br>â”‚  â”œâ”€ utils.py<br>â”‚  â””â”€ www.py<br>â”œâ”€ <strong>init</strong>.py<br>â”œâ”€ abc.py<br>â””â”€ xyz.py</p>
<p><strong>init</strong>.pyå¯ä»¥æ˜¯ç©ºæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æœ‰Pythonä»£ç ï¼Œå› ä¸º<strong>init</strong>.pyæœ¬èº«å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œè€Œå®ƒçš„æ¨¡å—åå°±æ˜¯mycompanyã€‚</p>
<h3 id="å¯¼å…¥"><a href="#å¯¼å…¥" class="headerlink" title="å¯¼å…¥"></a>å¯¼å…¥</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">' a test module '</span></span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">'haha'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">  args = sys.argv</span><br><span class="line">  <span class="keyword">if</span> len(args)==<span class="number">1</span>:</span><br><span class="line">    print(<span class="string">'Hello, world!'</span>)</span><br><span class="line">  <span class="keyword">elif</span> len(args)==<span class="number">2</span>:</span><br><span class="line">    print(<span class="string">'Hello, %s!'</span> % args[<span class="number">1</span>])</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'Too many arguments!'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">  test()</span><br></pre></td></tr></table></figure>
<p>å½“æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œè¿è¡Œhelloæ¨¡å—æ–‡ä»¶æ—¶ï¼ŒPythonè§£é‡Šå™¨æŠŠä¸€ä¸ªç‰¹æ®Šå˜é‡<strong>name</strong>ç½®ä¸º<strong>main</strong>ï¼Œè€Œå¦‚æœåœ¨å…¶ä»–åœ°æ–¹å¯¼å…¥è¯¥helloæ¨¡å—æ—¶ï¼Œifåˆ¤æ–­å°†å¤±è´¥ï¼Œå› æ­¤ï¼Œè¿™ç§ifæµ‹è¯•å¯ä»¥è®©ä¸€ä¸ªæ¨¡å—é€šè¿‡å‘½ä»¤è¡Œè¿è¡Œæ—¶æ‰§è¡Œä¸€äº›é¢å¤–çš„ä»£ç ï¼Œæœ€å¸¸è§çš„å°±æ˜¯è¿è¡Œæµ‹è¯•ã€‚</p>
<h3 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h3><p>æ­£å¸¸çš„å‡½æ•°å’Œå˜é‡åæ˜¯å…¬å¼€çš„ï¼ˆpublicï¼‰ï¼Œå¯ä»¥è¢«ç›´æ¥å¼•ç”¨ï¼Œæ¯”å¦‚ï¼šabcï¼Œx123ï¼ŒPIç­‰ï¼›</p>
<p>ç±»ä¼¼<strong>xxx</strong>è¿™æ ·çš„å˜é‡æ˜¯ç‰¹æ®Šå˜é‡ï¼Œå¯ä»¥è¢«ç›´æ¥å¼•ç”¨ï¼Œä½†æ˜¯æœ‰ç‰¹æ®Šç”¨é€”ï¼Œæ¯”å¦‚ä¸Šé¢çš„<strong>author</strong>ï¼Œ<strong>name</strong>å°±æ˜¯ç‰¹æ®Šå˜é‡ï¼Œhelloæ¨¡å—å®šä¹‰çš„æ–‡æ¡£æ³¨é‡Šä¹Ÿå¯ä»¥ç”¨ç‰¹æ®Šå˜é‡<strong>doc</strong>è®¿é—®ï¼Œæˆ‘ä»¬è‡ªå·±çš„å˜é‡ä¸€èˆ¬ä¸è¦ç”¨è¿™ç§å˜é‡åï¼›</p>
<p>ç±»ä¼¼_xxxå’Œ<strong>xxxè¿™æ ·çš„å‡½æ•°æˆ–å˜é‡å°±æ˜¯éå…¬å¼€çš„ï¼ˆprivateï¼‰ï¼Œä¸åº”è¯¥è¢«ç›´æ¥å¼•ç”¨ï¼Œæ¯”å¦‚_abcï¼Œ</strong>abcç­‰ï¼›</p>
<p>ä¹‹æ‰€ä»¥æˆ‘ä»¬è¯´ï¼Œprivateå‡½æ•°å’Œå˜é‡â€œä¸åº”è¯¥â€è¢«ç›´æ¥å¼•ç”¨ï¼Œè€Œä¸æ˜¯â€œä¸èƒ½â€è¢«ç›´æ¥å¼•ç”¨ï¼Œæ˜¯å› ä¸ºPythonå¹¶æ²¡æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥å®Œå…¨é™åˆ¶è®¿é—®privateå‡½æ•°æˆ–å˜é‡ï¼Œä½†æ˜¯ï¼Œä»ç¼–ç¨‹ä¹ æƒ¯ä¸Šä¸åº”è¯¥å¼•ç”¨privateå‡½æ•°æˆ–å˜é‡ã€‚</p>
<h3 id="æ¨¡å—æœç´¢"><a href="#æ¨¡å—æœç´¢" class="headerlink" title="æ¨¡å—æœç´¢"></a>æ¨¡å—æœç´¢</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒPythonè§£é‡Šå™¨ä¼šæœç´¢å½“å‰ç›®å½•ã€æ‰€æœ‰å·²å®‰è£…çš„å†…ç½®æ¨¡å—å’Œç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œæœç´¢è·¯å¾„å­˜æ”¾åœ¨sysæ¨¡å—çš„pathå˜é‡ä¸­ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path</span><br><span class="line">[<span class="string">''</span>, <span class="string">'/Library/Frameworks/Python.framework/Versions/3.6/lib/python36.zip'</span>, <span class="string">'/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6'</span>, ..., <span class="string">'/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages'</span>]</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹æ–¹æ³•ï¼š</p>
<ol>
<li>è¿è¡Œæ—¶ä¿®æ”¹ï¼šimport sys     sys.path.append(â€˜â€¦â€™)</li>
<li>è®¾ç½®ç¯å¢ƒå˜é‡ PYTHONPATH<h2 id="é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>é¢å‘å¯¹è±¡ç¼–ç¨‹</h2></li>
</ol>
<p>ä¸‰å¤§ç‰¹ç‚¹ï¼šæ•°æ®å°è£…ã€ç»§æ‰¿å’Œå¤šæ€ï¼ˆæ€»æ˜¯ä¸å°å¿ƒå¿˜äº†ï¼‰</p>
<p>é¢å‘è¿‡ç¨‹çš„ç¨‹åºè®¾è®¡æŠŠè®¡ç®—æœºç¨‹åºè§†ä¸ºä¸€ç³»åˆ—çš„å‘½ä»¤é›†åˆï¼Œå³ä¸€ç»„å‡½æ•°çš„é¡ºåºæ‰§è¡Œã€‚ä¸ºäº†ç®€åŒ–ç¨‹åºè®¾è®¡ï¼Œé¢å‘è¿‡ç¨‹æŠŠå‡½æ•°ç»§ç»­åˆ‡åˆ†ä¸ºå­å‡½æ•°ï¼Œå³æŠŠå¤§å—å‡½æ•°é€šè¿‡åˆ‡å‰²æˆå°å—å‡½æ•°æ¥é™ä½ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚</p>
<p>è€Œé¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡æŠŠè®¡ç®—æœºç¨‹åºè§†ä¸ºä¸€ç»„å¯¹è±¡çš„é›†åˆï¼Œè€Œæ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥æ¥æ”¶å…¶ä»–å¯¹è±¡å‘è¿‡æ¥çš„æ¶ˆæ¯ï¼Œå¹¶å¤„ç†è¿™äº›æ¶ˆæ¯ï¼Œè®¡ç®—æœºç¨‹åºçš„æ‰§è¡Œå°±æ˜¯ä¸€ç³»åˆ—æ¶ˆæ¯åœ¨å„ä¸ªå¯¹è±¡ä¹‹é—´ä¼ é€’ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬è¦å¤„ç†å­¦ç”Ÿçš„æˆç»©è¡¨ï¼Œä¸ºäº†è¡¨ç¤ºä¸€ä¸ªå­¦ç”Ÿçš„æˆç»©ï¼šStudentè¿™ç§æ•°æ®ç±»å‹åº”è¯¥è¢«è§†ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‹¥æœ‰nameå’Œscoreè¿™ä¸¤ä¸ªå±æ€§ï¼ˆPropertyï¼‰ã€‚å¦‚æœè¦æ‰“å°ä¸€ä¸ªå­¦ç”Ÿçš„æˆç»©ï¼Œé¦–å…ˆå¿…é¡»åˆ›å»ºå‡ºè¿™ä¸ªå­¦ç”Ÿå¯¹åº”çš„å¯¹è±¡ï¼Œç„¶åï¼Œç»™å¯¹è±¡å‘ä¸€ä¸ªprint_scoreæ¶ˆæ¯ï¼Œè®©å¯¹è±¡è‡ªå·±æŠŠè‡ªå·±çš„æ•°æ®æ‰“å°å‡ºæ¥ã€‚</p>
<h3 id="ç±»å’Œå®ä¾‹"><a href="#ç±»å’Œå®ä¾‹" class="headerlink" title="ç±»å’Œå®ä¾‹"></a>ç±»å’Œå®ä¾‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, score)</span>:</span></span><br><span class="line">    self.name = name</span><br><span class="line">    self.score = score</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">print_score</span><span class="params">(self)</span>:</span></span><br><span class="line">    print(<span class="string">'%s: %s'</span> % (self.name, self.score))</span><br></pre></td></tr></table></figure>
<p>æœ‰äº†<strong>init</strong>æ–¹æ³•ï¼Œåœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼Œå°±ä¸èƒ½ä¼ å…¥ç©ºçš„å‚æ•°äº†ï¼Œå¿…é¡»ä¼ å…¥ä¸<strong>init</strong>æ–¹æ³•åŒ¹é…çš„å‚æ•°ï¼Œä½†selfä¸éœ€è¦ä¼ ï¼ŒPythonè§£é‡Šå™¨è‡ªå·±ä¼šæŠŠå®ä¾‹å˜é‡ä¼ è¿›å»ã€‚</p>
<p>æ•°æ®å°è£…ï¼šé¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹å°±æ˜¯æ•°æ®å°è£…ã€‚åœ¨ä¸Šé¢çš„Studentç±»ä¸­ï¼Œæ¯ä¸ªå®ä¾‹å°±æ‹¥æœ‰å„è‡ªçš„nameå’Œscoreè¿™äº›æ•°æ®ã€‚è¿™äº›æ•°æ®å’Œé€»è¾‘è¢«â€œå°è£…â€èµ·æ¥äº†ï¼Œè°ƒç”¨å¾ˆå®¹æ˜“ï¼Œä½†å´ä¸ç”¨çŸ¥é“å†…éƒ¨å®ç°çš„ç»†èŠ‚ã€‚</p>
<p>å’Œé™æ€è¯­è¨€ä¸åŒï¼ŒPythonå…è®¸å¯¹å®ä¾‹å˜é‡ç»‘å®šä»»ä½•æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸¤ä¸ªå®ä¾‹å˜é‡ï¼Œè™½ç„¶å®ƒä»¬éƒ½æ˜¯åŒä¸€ä¸ªç±»çš„ä¸åŒå®ä¾‹ï¼Œä½†æ‹¥æœ‰çš„å˜é‡åç§°éƒ½å¯èƒ½ä¸åŒã€‚ã€Œæœ‰æ¯’ã€</p>
<h3 id="è®¿é—®é™åˆ¶"><a href="#è®¿é—®é™åˆ¶" class="headerlink" title="è®¿é—®é™åˆ¶"></a>è®¿é—®é™åˆ¶</h3><p>å®ä¾‹çš„å˜é‡åå¦‚æœä»¥__å¼€å¤´ï¼Œå°±å˜æˆäº†ä¸€ä¸ªç§æœ‰å˜é‡ï¼ˆprivateï¼‰ï¼Œåªæœ‰å†…éƒ¨å¯ä»¥è®¿é—®ï¼Œå¤–éƒ¨ä¸èƒ½è®¿é—®ã€‚</p>
<p>æœ‰äº›æ—¶å€™ï¼Œä½ ä¼šçœ‹åˆ°ä»¥ä¸€ä¸ªä¸‹åˆ’çº¿å¼€å¤´çš„å®ä¾‹å˜é‡åï¼Œæ¯”å¦‚_nameï¼Œè¿™æ ·çš„å®ä¾‹å˜é‡å¤–éƒ¨æ˜¯å¯ä»¥è®¿é—®çš„ï¼Œä½†æ˜¯ï¼ŒæŒ‰ç…§çº¦å®šä¿—æˆçš„è§„å®šï¼Œå½“ä½ çœ‹åˆ°è¿™æ ·çš„å˜é‡æ—¶ï¼Œæ„æ€å°±æ˜¯ï¼Œâ€œè™½ç„¶æˆ‘å¯ä»¥è¢«è®¿é—®ï¼Œä½†æ˜¯ï¼Œè¯·æŠŠæˆ‘è§†ä¸ºç§æœ‰å˜é‡ï¼Œä¸è¦éšæ„è®¿é—®â€ã€‚</p>
<p>åŒä¸‹åˆ’çº¿å¼€å¤´çš„å®ä¾‹å˜é‡æ˜¯ä¸æ˜¯ä¸€å®šä¸èƒ½ä»å¤–éƒ¨è®¿é—®å‘¢ï¼Ÿå…¶å®ä¹Ÿä¸æ˜¯ã€‚ä¸èƒ½ç›´æ¥è®¿é—®<strong>nameæ˜¯å› ä¸ºPythonè§£é‡Šå™¨å¯¹å¤–æŠŠ</strong>nameå˜é‡æ”¹æˆäº†_Student<strong>nameï¼Œæ‰€ä»¥ï¼Œä»ç„¶å¯ä»¥é€šè¿‡_Student</strong>nameæ¥è®¿é—®__nameå˜é‡ã€‚</p>
<p>é”™è¯¯å†™æ³•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart = Student(<span class="string">'Bart Simpson'</span>, <span class="number">59</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart.get_name()</span><br><span class="line"><span class="string">'Bart Simpson'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart.__name = <span class="string">'New Name'</span> <span class="comment"># è®¾ç½®__nameå˜é‡ï¼</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart.__name</span><br><span class="line"><span class="string">'New Name'</span></span><br></pre></td></tr></table></figure>
<p>è¡¨é¢ä¸Šçœ‹ï¼Œå¤–éƒ¨ä»£ç â€œæˆåŠŸâ€åœ°è®¾ç½®äº†<strong>nameå˜é‡ï¼Œä½†å®é™…ä¸Šè¿™ä¸ª</strong>nameå˜é‡å’Œclasså†…éƒ¨çš„<strong>nameå˜é‡ä¸æ˜¯ä¸€ä¸ªå˜é‡ï¼å†…éƒ¨çš„</strong>nameå˜é‡å·²ç»è¢«Pythonè§£é‡Šå™¨è‡ªåŠ¨æ”¹æˆäº†_Student<strong>nameï¼Œè€Œå¤–éƒ¨ä»£ç ç»™bartæ–°å¢äº†ä¸€ä¸ª</strong>nameå˜é‡ã€‚ä¸ä¿¡è¯•è¯•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart.get_name() <span class="comment"># get_name()å†…éƒ¨è¿”å›self.__name</span></span><br><span class="line"><span class="string">'Bart Simpson'</span></span><br></pre></td></tr></table></figure>
<h3 id="ç»§æ‰¿å’Œå¤šæ€"><a href="#ç»§æ‰¿å’Œå¤šæ€" class="headerlink" title="ç»§æ‰¿å’Œå¤šæ€"></a>ç»§æ‰¿å’Œå¤šæ€</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(a, list)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(b, Animal)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(c, Dog)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = Animal()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(b, Dog)</span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></table></figure>
<p>å¤šæ€çš„å¥½å¤„å°±æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦ä¼ å…¥Dogã€Catã€Tortoiseâ€¦â€¦æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ¥æ”¶Animalç±»å‹å°±å¯ä»¥äº†ï¼Œå› ä¸ºDogã€Catã€Tortoiseâ€¦â€¦éƒ½æ˜¯Animalç±»å‹ï¼Œç„¶åï¼ŒæŒ‰ç…§Animalç±»å‹è¿›è¡Œæ“ä½œå³å¯ã€‚ç”±äºAnimalç±»å‹æœ‰run()æ–¹æ³•ï¼Œå› æ­¤ï¼Œä¼ å…¥çš„ä»»æ„ç±»å‹ï¼Œåªè¦æ˜¯Animalç±»æˆ–è€…å­ç±»ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨å®é™…ç±»å‹çš„run()æ–¹æ³•ï¼Œè¿™å°±æ˜¯å¤šæ€çš„æ„æ€ï¼š</p>
<p>å¯¹äºä¸€ä¸ªå˜é‡ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“å®ƒæ˜¯Animalç±»å‹ï¼Œæ— éœ€ç¡®åˆ‡åœ°çŸ¥é“å®ƒçš„å­ç±»å‹ï¼Œå°±å¯ä»¥æ”¾å¿ƒåœ°è°ƒç”¨run()æ–¹æ³•ï¼Œè€Œå…·ä½“è°ƒç”¨çš„run()æ–¹æ³•æ˜¯ä½œç”¨åœ¨Animalã€Dogã€Catè¿˜æ˜¯Tortoiseå¯¹è±¡ä¸Šï¼Œç”±è¿è¡Œæ—¶è¯¥å¯¹è±¡çš„ç¡®åˆ‡ç±»å‹å†³å®šï¼Œè¿™å°±æ˜¯å¤šæ€çœŸæ­£çš„å¨åŠ›ï¼šè°ƒç”¨æ–¹åªç®¡è°ƒç”¨ï¼Œä¸ç®¡ç»†èŠ‚ï¼Œè€Œå½“æˆ‘ä»¬æ–°å¢ä¸€ç§Animalçš„å­ç±»æ—¶ï¼Œåªè¦ç¡®ä¿run()æ–¹æ³•ç¼–å†™æ­£ç¡®ï¼Œä¸ç”¨ç®¡åŸæ¥çš„ä»£ç æ˜¯å¦‚ä½•è°ƒç”¨çš„ã€‚è¿™å°±æ˜¯è‘—åçš„â€œå¼€é—­â€åŸåˆ™ï¼š</p>
<p>å¯¹æ‰©å±•å¼€æ”¾ï¼šå…è®¸æ–°å¢Animalå­ç±»ï¼›</p>
<p>å¯¹ä¿®æ”¹å°é—­ï¼šä¸éœ€è¦ä¿®æ”¹ä¾èµ–Animalç±»å‹çš„run_twice()ç­‰å‡½æ•°ã€‚</p>
<h4 id="é™æ€è¯­è¨€-vs-åŠ¨æ€è¯­è¨€"><a href="#é™æ€è¯­è¨€-vs-åŠ¨æ€è¯­è¨€" class="headerlink" title="é™æ€è¯­è¨€ vs åŠ¨æ€è¯­è¨€"></a>é™æ€è¯­è¨€ vs åŠ¨æ€è¯­è¨€</h4><p>å¯¹äºé™æ€è¯­è¨€ï¼ˆä¾‹å¦‚Javaï¼‰æ¥è¯´ï¼Œå¦‚æœéœ€è¦ä¼ å…¥Animalç±»å‹ï¼Œåˆ™ä¼ å…¥çš„å¯¹è±¡å¿…é¡»æ˜¯Animalç±»å‹æˆ–è€…å®ƒçš„å­ç±»ï¼Œå¦åˆ™ï¼Œå°†æ— æ³•è°ƒç”¨run()æ–¹æ³•ã€‚</p>
<p>å¯¹äºPythonè¿™æ ·çš„åŠ¨æ€è¯­è¨€æ¥è¯´ï¼Œåˆ™ä¸ä¸€å®šéœ€è¦ä¼ å…¥Animalç±»å‹ã€‚æˆ‘ä»¬åªéœ€è¦ä¿è¯ä¼ å…¥çš„å¯¹è±¡æœ‰ä¸€ä¸ªrun()æ–¹æ³•å°±å¯ä»¥äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Timer</span><span class="params">(object)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">    print(<span class="string">'Start...'</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™å°±æ˜¯åŠ¨æ€è¯­è¨€çš„â€œé¸­å­ç±»å‹â€ï¼Œå®ƒå¹¶ä¸è¦æ±‚ä¸¥æ ¼çš„ç»§æ‰¿ä½“ç³»ï¼Œä¸€ä¸ªå¯¹è±¡åªè¦â€œçœ‹èµ·æ¥åƒé¸­å­ï¼Œèµ°èµ·è·¯æ¥åƒé¸­å­â€ï¼Œé‚£å®ƒå°±å¯ä»¥è¢«çœ‹åšæ˜¯é¸­å­ã€‚</p>
<p>Pythonçš„â€œfile-like objectâ€œå°±æ˜¯ä¸€ç§é¸­å­ç±»å‹ã€‚å¯¹çœŸæ­£çš„æ–‡ä»¶å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ªread()æ–¹æ³•ï¼Œè¿”å›å…¶å†…å®¹ã€‚ä½†æ˜¯ï¼Œè®¸å¤šå¯¹è±¡ï¼Œåªè¦æœ‰read()æ–¹æ³•ï¼Œéƒ½è¢«è§†ä¸ºâ€œfile-like objectâ€œã€‚è®¸å¤šå‡½æ•°æ¥æ”¶çš„å‚æ•°å°±æ˜¯â€œfile-like objectâ€œï¼Œä½ ä¸ä¸€å®šè¦ä¼ å…¥çœŸæ­£çš„æ–‡ä»¶å¯¹è±¡ï¼Œå®Œå…¨å¯ä»¥ä¼ å…¥ä»»ä½•å®ç°äº†read()æ–¹æ³•çš„å¯¹è±¡ã€‚</p>
<h3 id="è·å–å¯¹è±¡ä¿¡æ¯"><a href="#è·å–å¯¹è±¡ä¿¡æ¯" class="headerlink" title="è·å–å¯¹è±¡ä¿¡æ¯"></a>è·å–å¯¹è±¡ä¿¡æ¯</h3><ol>
<li>ä½¿ç”¨ type()</li>
</ol>
<p>åˆ¤æ–­åŸºæœ¬æ•°æ®ç±»å‹å¯ä»¥ç›´æ¥å†™intï¼Œstrç­‰ï¼Œä½†å¦‚æœè¦åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å‡½æ•°æ€ä¹ˆåŠï¼Ÿå¯ä»¥ä½¿ç”¨typesæ¨¡å—ä¸­å®šä¹‰çš„å¸¸é‡ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> types</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">()</span>:</span></span><br><span class="line"><span class="meta">... </span>  <span class="keyword">pass</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(fn)==types.FunctionType</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(abs)==types.BuiltinFunctionType</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(<span class="keyword">lambda</span> x: x)==types.LambdaType</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type((x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)))==types.GeneratorType</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>
<ol>
<li>ä½¿ç”¨ isinstance()</li>
</ol>
<p>å¯¹äºclassçš„ç»§æ‰¿å…³ç³»æ¥è¯´ï¼Œä½¿ç”¨type()å°±å¾ˆä¸æ–¹ä¾¿ã€‚æˆ‘ä»¬è¦åˆ¤æ–­classçš„ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨isinstance()å‡½æ•°ã€‚ï¼ˆå…¼å®¹ç»§æ‰¿å…³ç³»ï¼‰</p>
<p>èƒ½ç”¨type()åˆ¤æ–­çš„åŸºæœ¬ç±»å‹ä¹Ÿå¯ä»¥ç”¨isinstance()åˆ¤æ–­ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="string">'a'</span>, str)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="number">123</span>, int)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="string">b'a'</span>, bytes)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¹¶ä¸”è¿˜å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æ˜¯æŸäº›ç±»å‹ä¸­çš„ä¸€ç§ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç å°±å¯ä»¥åˆ¤æ–­æ˜¯å¦æ˜¯listæˆ–è€…tupleï¼š</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], (list, tuple))</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), (list, tuple))</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>
<p>æ€»æ˜¯ä¼˜å…ˆä½¿ç”¨isinstance()åˆ¤æ–­ç±»å‹ï¼Œå¯ä»¥å°†æŒ‡å®šç±»å‹åŠå…¶å­ç±»â€œä¸€ç½‘æ‰“å°½â€ã€‚</p>
<ol>
<li>ä½¿ç”¨ dir()<br>å¦‚æœè¦è·å¾—ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨dir()å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²çš„listï¼Œæ¯”å¦‚ï¼Œè·å¾—ä¸€ä¸ªstrå¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼š</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir(<span class="string">'ABC'</span>)</span><br><span class="line">[<span class="string">'__add__'</span>, <span class="string">'__class__'</span>,..., <span class="string">'__subclasshook__'</span>, <span class="string">'capitalize'</span>, <span class="string">'casefold'</span>,..., <span class="string">'zfill'</span>]</span><br></pre></td></tr></table></figure>
<p><strong>len</strong>æ–¹æ³•è¿”å›é•¿åº¦ã€‚åœ¨Pythonä¸­ï¼Œå¦‚æœä½ è°ƒç”¨len()å‡½æ•°è¯•å›¾è·å–ä¸€ä¸ªå¯¹è±¡çš„é•¿åº¦ï¼Œå®é™…ä¸Šï¼Œåœ¨len()å‡½æ•°å†…éƒ¨ï¼Œå®ƒè‡ªåŠ¨å»è°ƒç”¨è¯¥å¯¹è±¡çš„<strong>len</strong>()æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œä¸‹é¢çš„ä»£ç æ˜¯ç­‰ä»·çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">'ABC'</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'ABC'</span>.__len__()</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥å¯¹äºæˆ‘ä»¬è‡ªå·±å†™çš„ç±»ï¼Œå¦‚æœä¹Ÿæƒ³ç”¨len(myObj)çš„è¯ï¼Œå°±è‡ªå·±å†™ä¸€ä¸ª<strong>len</strong>()æ–¹æ³•ã€‚</p>
<p>ä»…ä»…æŠŠå±æ€§å’Œæ–¹æ³•åˆ—å‡ºæ¥æ˜¯ä¸å¤Ÿçš„ï¼Œé…åˆgetattr()ã€setattr()ä»¥åŠhasattr()ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ“ä½œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(obj, <span class="string">'x'</span>) <span class="comment"># æœ‰å±æ€§'x'å—ï¼Ÿ</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>obj.x</span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(obj, <span class="string">'y'</span>) <span class="comment"># æœ‰å±æ€§'y'å—ï¼Ÿ</span></span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>setattr(obj, <span class="string">'y'</span>, <span class="number">19</span>) <span class="comment"># è®¾ç½®ä¸€ä¸ªå±æ€§'y'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(obj, <span class="string">'y'</span>) <span class="comment"># æœ‰å±æ€§'y'å—ï¼Ÿ</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>getattr(obj, <span class="string">'y'</span>) <span class="comment"># è·å–å±æ€§'y'</span></span><br><span class="line"><span class="number">19</span></span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥è·å¾—å¯¹è±¡çš„æ–¹æ³•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(obj, <span class="string">'power'</span>) <span class="comment"># æœ‰å±æ€§'power'å—ï¼Ÿ</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>getattr(obj, <span class="string">'power'</span>) <span class="comment"># è·å–å±æ€§'power'</span></span><br><span class="line">&lt;bound method MyObject.power of &lt;__main__.MyObject object at <span class="number">0x10077a6a0</span>&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fn = getattr(obj, <span class="string">'power'</span>) <span class="comment"># è·å–å±æ€§'power'å¹¶èµ‹å€¼åˆ°å˜é‡fn</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fn <span class="comment"># fnæŒ‡å‘obj.power</span></span><br><span class="line">&lt;bound method MyObject.power of &lt;__main__.MyObject object at <span class="number">0x10077a6a0</span>&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fn() <span class="comment"># è°ƒç”¨fn()ä¸è°ƒç”¨obj.power()æ˜¯ä¸€æ ·çš„</span></span><br><span class="line"><span class="number">81</span></span><br></pre></td></tr></table></figure>
<h3 id="å®ä¾‹å±æ€§å’Œç±»å±æ€§"><a href="#å®ä¾‹å±æ€§å’Œç±»å±æ€§" class="headerlink" title="å®ä¾‹å±æ€§å’Œç±»å±æ€§"></a>å®ä¾‹å±æ€§å’Œç±»å±æ€§</h3><p>ç±»å±æ€§ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></span><br><span class="line"><span class="meta">... </span>  name = <span class="string">'Student'</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = Student() <span class="comment"># åˆ›å»ºå®ä¾‹s</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(s.name) <span class="comment"># æ‰“å°nameå±æ€§ï¼Œå› ä¸ºå®ä¾‹å¹¶æ²¡æœ‰nameå±æ€§ï¼Œæ‰€ä»¥ä¼šç»§ç»­æŸ¥æ‰¾classçš„nameå±æ€§</span></span><br><span class="line">Student</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(Student.name) <span class="comment"># æ‰“å°ç±»çš„nameå±æ€§</span></span><br><span class="line">Student</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.name = <span class="string">'Michael'</span> <span class="comment"># ç»™å®ä¾‹ç»‘å®šnameå±æ€§</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(s.name) <span class="comment"># ç”±äºå®ä¾‹å±æ€§ä¼˜å…ˆçº§æ¯”ç±»å±æ€§é«˜ï¼Œå› æ­¤ï¼Œå®ƒä¼šå±è”½æ‰ç±»çš„nameå±æ€§</span></span><br><span class="line">Michael</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(Student.name) <span class="comment"># ä½†æ˜¯ç±»å±æ€§å¹¶æœªæ¶ˆå¤±ï¼Œç”¨Student.nameä»ç„¶å¯ä»¥è®¿é—®</span></span><br><span class="line">Student</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> s.name <span class="comment"># å¦‚æœåˆ é™¤å®ä¾‹çš„nameå±æ€§</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(s.name) <span class="comment"># å†æ¬¡è°ƒç”¨s.nameï¼Œç”±äºå®ä¾‹çš„nameå±æ€§æ²¡æœ‰æ‰¾åˆ°ï¼Œç±»çš„nameå±æ€§å°±æ˜¾ç¤ºå‡ºæ¥äº†</span></span><br><span class="line">Student</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ç±»å±æ€§çš„å€¼å¯ä»¥è¢«ä¿®æ”¹ï¼ä½†æ˜¯ç±»å’Œå„ä¸ªå®ä¾‹çš„åŒåç±»å±æ€§éƒ½æ˜¯ç‹¬ç«‹çš„ï¼</p>
<h2 id="é¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹"><a href="#é¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹" class="headerlink" title="é¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹"></a>é¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹</h2><h3 id="ä½¿ç”¨slots"><a href="#ä½¿ç”¨slots" class="headerlink" title="ä½¿ç”¨slots"></a>ä½¿ç”¨<strong>slots</strong></h3><p>é™¤äº†åŠ¨æ€ç»™å®ä¾‹ç»‘å®šæ–¹æ³•å¤–ï¼Œè¿˜å¯ä»¥åŠ¨æ€ç»‘å®šæ–¹æ³•(ä¹Ÿå¯ä»¥ç»™ç±»åŠ¨æ€ç»‘å®šæ–¹æ³•)ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">set_age</span><span class="params">(self, age)</span>:</span> <span class="comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ä½œä¸ºå®ä¾‹æ–¹æ³•</span></span><br><span class="line"><span class="meta">... </span>  self.age = age</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> types <span class="keyword">import</span> MethodType</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.set_age = MethodType(set_age, s) <span class="comment"># ç»™å®ä¾‹ç»‘å®šä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.set_age(<span class="number">25</span>) <span class="comment"># è°ƒç”¨å®ä¾‹æ–¹æ³•</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.age <span class="comment"># æµ‹è¯•ç»“æœ</span></span><br><span class="line"><span class="number">25</span></span><br></pre></td></tr></table></figure>
<p>ç»™ç±»åŠ¨æ€ç»‘å®šæ–¹æ³•ï¼Œä¼šå³æ—¶å½±å“åˆ°å·²åˆ›å»ºçš„å®ä¾‹ï¼Œå®ƒä»¬ä¹Ÿä¼šå…·æœ‰è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦é™åˆ¶å®ä¾‹çš„å±æ€§æ€ä¹ˆåŠï¼Ÿæ¯”å¦‚ï¼Œåªç»™Studentå®ä¾‹æ·»åŠ nameå’Œageå±æ€§ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></span><br><span class="line">  __slots__ = (<span class="string">'name'</span>, <span class="string">'age'</span>) <span class="comment"># ç”¨tupleå®šä¹‰å…è®¸ç»‘å®šçš„å±æ€§åç§°</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨ä¸€ä¸ª<strong>slots</strong>æ¥é™åˆ¶è¿™äº›å±æ€§ã€‚è¿™æ ·å¦‚æœæˆ‘ä»¬è°ƒç”¨ s.score = 99 ä¼šæŠ¥é”™ã€‚</p>
<p>æ³¨æ„å…¶å¯¹å­ç±»ä¸èµ·ä½œç”¨ã€‚é™¤éåœ¨å­ç±»ä¸­ä¹Ÿå®šä¹‰<strong>slots</strong>ï¼Œè¿™æ ·ï¼Œå­ç±»å®ä¾‹å…è®¸å®šä¹‰çš„å±æ€§å°±æ˜¯è‡ªèº«çš„<strong>slots</strong>åŠ ä¸Šçˆ¶ç±»çš„<strong>slots</strong>ã€‚</p>
<h3 id="ä½¿ç”¨-property"><a href="#ä½¿ç”¨-property" class="headerlink" title="ä½¿ç”¨@property"></a>ä½¿ç”¨@property</h3><p>ä¸ºäº†é™åˆ¶å±æ€§çš„èŒƒå›´ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ·»åŠ get_attrå’Œset_attræ–¹æ³•ã€‚</p>
<p>æœ‰æ²¡æœ‰æ—¢èƒ½æ£€æŸ¥å‚æ•°ï¼Œåˆå¯ä»¥ç”¨ç±»ä¼¼å±æ€§è¿™æ ·ç®€å•çš„æ–¹å¼æ¥è®¿é—®ç±»çš„å˜é‡å‘¢ï¼Ÿå¯¹äºè¿½æ±‚å®Œç¾çš„Pythonç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™æ˜¯å¿…é¡»è¦åšåˆ°çš„ï¼</p>
<p>Pythonå†…ç½®çš„@propertyè£…é¥°å™¨å°±æ˜¯è´Ÿè´£æŠŠä¸€ä¸ªæ–¹æ³•å˜æˆå±æ€§è°ƒç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">  @property</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">score</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> self._score</span><br><span class="line"></span><br><span class="line"><span class="meta">  @score.setter</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">score</span><span class="params">(self, value)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isinstance(value, int):</span><br><span class="line">      <span class="keyword">raise</span> ValueError(<span class="string">'score must be an integer!'</span>)</span><br><span class="line">    <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; <span class="number">100</span>:</span><br><span class="line">      <span class="keyword">raise</span> ValueError(<span class="string">'score must between 0 ~ 100!'</span>)</span><br><span class="line">    self._score = value</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = Student()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.score = <span class="number">60</span> <span class="comment"># OKï¼Œå®é™…è½¬åŒ–ä¸ºs.set_score(60)</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.score <span class="comment"># OKï¼Œå®é™…è½¬åŒ–ä¸ºs.get_score()</span></span><br><span class="line"><span class="number">60</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.score = <span class="number">9999</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  ...</span><br><span class="line">ValueError: score must between <span class="number">0</span> ~ <span class="number">100</span>!</span><br></pre></td></tr></table></figure>
<p>@propertyçš„å®ç°æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬å…ˆè€ƒå¯Ÿå¦‚ä½•ä½¿ç”¨ã€‚æŠŠä¸€ä¸ªgetteræ–¹æ³•å˜æˆå±æ€§ï¼Œåªéœ€è¦åŠ ä¸Š@propertyå°±å¯ä»¥äº†ï¼Œæ­¤æ—¶ï¼Œ@propertyæœ¬èº«åˆåˆ›å»ºäº†å¦ä¸€ä¸ªè£…é¥°å™¨@score.setterï¼Œè´Ÿè´£æŠŠä¸€ä¸ªsetteræ–¹æ³•å˜æˆå±æ€§èµ‹å€¼ã€‚</p>
<p>æ³¨æ„åˆ°è¿™ä¸ªç¥å¥‡çš„@propertyï¼Œæˆ‘ä»¬åœ¨å¯¹å®ä¾‹å±æ€§æ“ä½œçš„æ—¶å€™ï¼Œå°±çŸ¥é“è¯¥å±æ€§å¾ˆå¯èƒ½ä¸æ˜¯ç›´æ¥æš´éœ²çš„ï¼Œè€Œæ˜¯é€šè¿‡getterå’Œsetteræ–¹æ³•æ¥å®ç°çš„ã€‚</p>
<p>è¿˜å¯ä»¥å®šä¹‰åªè¯»å±æ€§ï¼Œåªå®šä¹‰getteræ–¹æ³•ï¼Œä¸å®šä¹‰setteræ–¹æ³•å°±æ˜¯ä¸€ä¸ªåªè¯»å±æ€§ã€‚</p>
<p>PS. è®¾ç½®æˆåªè¯»çš„å±æ€§ï¼Œéœ€è¦åœ¨<strong>init</strong>æ–¹æ³•é‡Œé¢è¿›è¡Œåˆå§‹åŒ–ã€‚</p>
<h3 id="å¤šé‡ç»§æ‰¿-MixInè®¾è®¡"><a href="#å¤šé‡ç»§æ‰¿-MixInè®¾è®¡" class="headerlink" title="å¤šé‡ç»§æ‰¿ (MixInè®¾è®¡)"></a>å¤šé‡ç»§æ‰¿ (MixInè®¾è®¡)</h3><p>å¯¹äºéœ€è¦RunnableåŠŸèƒ½çš„åŠ¨ç‰©ï¼Œå°±å¤šç»§æ‰¿ä¸€ä¸ªRunnableï¼Œä¾‹å¦‚Dogï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span><span class="params">(Mammal, Runnable)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>å¯¹äºéœ€è¦FlyableåŠŸèƒ½çš„åŠ¨ç‰©ï¼Œå°±å¤šç»§æ‰¿ä¸€ä¸ªFlyableï¼Œä¾‹å¦‚Batï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bat</span><span class="params">(Mammal, Flyable)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<h4 id="MixInè®¾è®¡"><a href="#MixInè®¾è®¡" class="headerlink" title="MixInè®¾è®¡"></a>MixInè®¾è®¡</h4><p>MixInçš„ç›®çš„å°±æ˜¯ç»™ä¸€ä¸ªç±»å¢åŠ å¤šä¸ªåŠŸèƒ½ï¼Œè¿™æ ·ï¼Œåœ¨è®¾è®¡ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘é€šè¿‡å¤šé‡ç»§æ‰¿æ¥ç»„åˆå¤šä¸ªMixInçš„åŠŸèƒ½ï¼Œè€Œä¸æ˜¯è®¾è®¡å¤šå±‚æ¬¡çš„å¤æ‚çš„ç»§æ‰¿å…³ç³»ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯”å¦‚ï¼Œç¼–å†™ä¸€ä¸ªå¤šè¿›ç¨‹æ¨¡å¼çš„TCPæœåŠ¡ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTCPServer</span><span class="params">(TCPServer, ForkingMixIn)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># ç¼–å†™ä¸€ä¸ªå¤šçº¿ç¨‹æ¨¡å¼çš„UDPæœåŠ¡ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUDPServer</span><span class="params">(UDPServer, ThreadingMixIn)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># å¦‚æœä½ æ‰“ç®—æä¸€ä¸ªæ›´å…ˆè¿›çš„åç¨‹æ¨¡å‹ï¼Œå¯ä»¥ç¼–å†™ä¸€ä¸ªCoroutineMixInï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTCPServer</span><span class="params">(TCPServer, CoroutineMixIn)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¤æ‚è€Œåºå¤§çš„ç»§æ‰¿é“¾ï¼Œåªè¦é€‰æ‹©ç»„åˆä¸åŒçš„ç±»çš„åŠŸèƒ½ï¼Œå°±å¯ä»¥å¿«é€Ÿæ„é€ å‡ºæ‰€éœ€çš„å­ç±»ã€‚</span></span><br></pre></td></tr></table></figure>
<h3 id="å®šåˆ¶ç±»"><a href="#å®šåˆ¶ç±»" class="headerlink" title="å®šåˆ¶ç±»"></a>å®šåˆ¶ç±»</h3><p><strong>str</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Student object (name: %s)'</span> % self.name</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(Student(<span class="string">'Michael'</span>))</span><br><span class="line">Student object (name: Michael)</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ç»†å¿ƒçš„æœ‹å‹ä¼šå‘ç°ç›´æ¥æ•²å˜é‡ä¸ç”¨printï¼Œæ‰“å°å‡ºæ¥çš„å®ä¾‹è¿˜æ˜¯ä¸å¥½çœ‹ï¼</p>
<p>è¿™æ˜¯å› ä¸ºç›´æ¥æ˜¾ç¤ºå˜é‡è°ƒç”¨çš„ä¸æ˜¯<strong>str</strong>()ï¼Œè€Œæ˜¯<strong>repr</strong>()ï¼Œä¸¤è€…çš„åŒºåˆ«æ˜¯<strong>str</strong>()è¿”å›ç”¨æˆ·çœ‹åˆ°çš„å­—ç¬¦ä¸²ï¼Œè€Œ<strong>repr</strong>()è¿”å›ç¨‹åºå¼€å‘è€…çœ‹åˆ°çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>repr</strong>()æ˜¯ä¸ºè°ƒè¯•æœåŠ¡çš„ã€‚åœ¨åé¢åŠ ä¸Šè¿™ä¸€å¥å°±å¥½äº†ï¼š<strong>repr</strong> = <strong>str</strong>ã€‚</p>
<p><strong>getattr</strong></p>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ç±»çš„æ–¹æ³•æˆ–å±æ€§æ—¶ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šæŠ¥é”™ã€‚æ¯”å¦‚å®šä¹‰Studentç±»ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.name = <span class="string">'Michael'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.score</span><br><span class="line">Traceback</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, attr)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> attr==<span class="string">'score'</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="number">99</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ç±»ä¸­åŠ ä¸Šè¿™ä¸ªçš„æ—¶å€™ï¼Œå½“è°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼ŒPythonè§£é‡Šå™¨ä¼šè¯•å›¾è°ƒç”¨<strong>getattr</strong>(self, â€˜scoreâ€™)</p>
<p>è¿”å›å‡½æ•°ä¹Ÿæ˜¯å®Œå…¨å¯ä»¥çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, attr)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> attr==<span class="string">'age'</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">lambda</span>: <span class="number">25</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.age()</span><br><span class="line"><span class="number">25</span></span><br></pre></td></tr></table></figure>
<p>ä½“ä¼šä¸€ä¸‹å¦‚ä¸‹å¥½å¤„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chain</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, path=<span class="string">''</span>)</span>:</span></span><br><span class="line">    self._path = path</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, path)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> Chain(<span class="string">'%s/%s'</span> % (self._path, path))</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> self._path</span><br><span class="line"></span><br><span class="line">  __repr__ = __str__</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Chain().status.user.timeline.list</span><br><span class="line"><span class="string">'/status/user/timeline/list'</span></span><br></pre></td></tr></table></figure>
<p><strong>call</strong></p>
<p>åœ¨å®ä¾‹è‡ªèº«è°ƒç”¨ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ª<strong>call</strong>æ–¹æ³•ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = Student(<span class="string">'Happy'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s()</span><br><span class="line">OUTPUT</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡callable()å‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯â€œå¯è°ƒç”¨â€å¯¹è±¡ã€‚</p>
<h3 id="ä½¿ç”¨æšä¸¾ç±»"><a href="#ä½¿ç”¨æšä¸¾ç±»" class="headerlink" title="ä½¿ç”¨æšä¸¾ç±»"></a>ä½¿ç”¨æšä¸¾ç±»</h3><p>å½“æˆ‘ä»¬éœ€è¦å®šä¹‰å¸¸é‡æ—¶ï¼Œä¸€ä¸ªåŠæ³•æ˜¯ç”¨å¤§å†™å˜é‡é€šè¿‡æ•´æ•°æ¥å®šä¹‰ï¼Œä¾‹å¦‚æœˆä»½ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯ä¸ºè¿™æ ·çš„æšä¸¾ç±»å‹å®šä¹‰ä¸€ä¸ªclassç±»å‹ï¼Œç„¶åï¼Œæ¯ä¸ªå¸¸é‡éƒ½æ˜¯classçš„ä¸€ä¸ªå”¯ä¸€å®ä¾‹ã€‚Pythonæä¾›äº†Enumç±»æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"></span><br><span class="line">Month = Enum(<span class="string">'Month'</span>, (<span class="string">'Jan'</span>, <span class="string">'Feb'</span>, <span class="string">'Mar'</span>, <span class="string">'Apr'</span>, <span class="string">'May'</span>, <span class="string">'Jun'</span>, <span class="string">'Jul'</span>, <span class="string">'Aug'</span>, <span class="string">'Sep'</span>, <span class="string">'Oct'</span>, <span class="string">'Nov'</span>, <span class="string">'Dec'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Month.Jan</span><br><span class="line">&lt;Month.Jan: <span class="number">1</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Month.Jan.name</span><br><span class="line"><span class="string">'Jan'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Month.Jan.value</span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name, member <span class="keyword">in</span> Month.__members__.items():</span><br><span class="line">  print(name, <span class="string">'=&gt;'</span>, member, <span class="string">','</span>, member.value)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦æ›´ç²¾ç¡®åœ°æ§åˆ¶æšä¸¾ç±»å‹ï¼Œå¯ä»¥ä»Enumæ´¾ç”Ÿå‡ºè‡ªå®šä¹‰ç±»ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum, unique</span><br><span class="line"></span><br><span class="line"><span class="meta">@unique     # uniqueè£…é¥°å™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ£€æŸ¥æ²¡æœ‰é‡å¤å€¼</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Weekday</span><span class="params">(Enum)</span>:</span></span><br><span class="line">  Sun = <span class="number">0</span> <span class="comment"># Sunçš„valueè¢«è®¾å®šä¸º0</span></span><br><span class="line">  Mon = <span class="number">1</span></span><br><span class="line">  Tue = <span class="number">2</span></span><br><span class="line">  Wed = <span class="number">3</span></span><br><span class="line">  Thu = <span class="number">4</span></span><br><span class="line">  Fri = <span class="number">5</span></span><br><span class="line">  Sat = <span class="number">6</span></span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨å…ƒç±»"><a href="#ä½¿ç”¨å…ƒç±»" class="headerlink" title="ä½¿ç”¨å…ƒç±»???"></a>ä½¿ç”¨å…ƒç±»???</h3><p>åŠ¨æ€è¯­è¨€å’Œé™æ€è¯­è¨€æœ€å¤§çš„ä¸åŒï¼Œå°±æ˜¯å‡½æ•°å’Œç±»çš„å®šä¹‰ï¼Œä¸æ˜¯ç¼–è¯‘æ—¶å®šä¹‰çš„ï¼Œè€Œæ˜¯è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºçš„ã€‚</p>
<p>type()æ—¢å¯ä»¥è¿”å›ä¸€ä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œåˆå¯ä»¥åˆ›å»ºå‡ºæ–°çš„ç±»å‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(self, name=<span class="string">'world'</span>)</span>:</span> <span class="comment"># å…ˆå®šä¹‰å‡½æ•°</span></span><br><span class="line"><span class="meta">... </span>  print(<span class="string">'Hello, %s.'</span> % name)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Hello = type(<span class="string">'Hello'</span>, (object,), dict(hello=fn)) <span class="comment"># åˆ›å»ºHello class</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>h = Hello()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>h.hello()</span><br><span class="line">Hello, world.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(Hello))</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">type</span>'&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">print</span><span class="params">(type<span class="params">(h)</span>)</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">__main__</span>.<span class="title">Hello</span>'&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¦åˆ›å»ºä¸€ä¸ªclasså¯¹è±¡ï¼Œtype()å‡½æ•°ä¾æ¬¡ä¼ å…¥3ä¸ªå‚æ•°ï¼š</p>
<ol>
<li>classçš„åç§°ï¼›</li>
<li>ç»§æ‰¿çš„çˆ¶ç±»é›†åˆï¼Œæ³¨æ„Pythonæ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªçˆ¶ç±»ï¼Œåˆ«å¿˜äº†tupleçš„å•å…ƒç´ å†™æ³•ï¼›</li>
<li>classçš„æ–¹æ³•åç§°ä¸å‡½æ•°ç»‘å®šï¼Œè¿™é‡Œæˆ‘ä»¬æŠŠå‡½æ•°fnç»‘å®šåˆ°æ–¹æ³•åhelloä¸Šã€‚</li>
</ol>
<p>é€šè¿‡type()å‡½æ•°åˆ›å»ºçš„ç±»å’Œç›´æ¥å†™classæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œå› ä¸ºPythonè§£é‡Šå™¨é‡åˆ°classå®šä¹‰æ—¶ï¼Œä»…ä»…æ˜¯æ‰«æä¸€ä¸‹classå®šä¹‰çš„è¯­æ³•ï¼Œç„¶åè°ƒç”¨type()å‡½æ•°åˆ›å»ºå‡ºclassã€‚</p>
<h4 id="Metaclass"><a href="#Metaclass" class="headerlink" title="Metaclass"></a>Metaclass</h4><p>é™¤äº†ä½¿ç”¨type()åŠ¨æ€åˆ›å»ºç±»ä»¥å¤–ï¼Œè¦æ§åˆ¶ç±»çš„åˆ›å»ºè¡Œä¸ºï¼Œè¿˜å¯ä»¥ä½¿ç”¨metaclassã€‚</p>
<p>metaclassï¼Œç›´è¯‘ä¸ºå…ƒç±»ï¼Œç®€å•çš„è§£é‡Šå°±æ˜¯ï¼š</p>
<p>å½“æˆ‘ä»¬å®šä¹‰äº†ç±»ä»¥åï¼Œå°±å¯ä»¥æ ¹æ®è¿™ä¸ªç±»åˆ›å»ºå‡ºå®ä¾‹ï¼Œæ‰€ä»¥ï¼šå…ˆå®šä¹‰ç±»ï¼Œç„¶ååˆ›å»ºå®ä¾‹ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºå‡ºç±»å‘¢ï¼Ÿé‚£å°±å¿…é¡»æ ¹æ®metaclassåˆ›å»ºå‡ºç±»ï¼Œæ‰€ä»¥ï¼šå…ˆå®šä¹‰metaclassï¼Œç„¶ååˆ›å»ºç±»ã€‚</p>
<p>è¿æ¥èµ·æ¥å°±æ˜¯ï¼šå…ˆå®šä¹‰metaclassï¼Œå°±å¯ä»¥åˆ›å»ºç±»ï¼Œæœ€ååˆ›å»ºå®ä¾‹ã€‚</p>
<p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014319106919344c4ef8b1e04c48778bb45796e0335839000" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014319106919344c4ef8b1e04c48778bb45796e0335839000</a></p>
<h2 id="é”™è¯¯ã€è°ƒè¯•å’Œæµ‹è¯•"><a href="#é”™è¯¯ã€è°ƒè¯•å’Œæµ‹è¯•" class="headerlink" title="é”™è¯¯ã€è°ƒè¯•å’Œæµ‹è¯•"></a>é”™è¯¯ã€è°ƒè¯•å’Œæµ‹è¯•</h2><h3 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  print(<span class="string">'try...'</span>)</span><br><span class="line">  r = <span class="number">10</span> / int(<span class="string">'2'</span>)</span><br><span class="line">  print(<span class="string">'result:'</span>, r)</span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">  print(<span class="string">'ValueError:'</span>, e)</span><br><span class="line"><span class="keyword">except</span> ZeroDivisionError <span class="keyword">as</span> e:</span><br><span class="line">  print(<span class="string">'ZeroDivisionError:'</span>, e)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  print(<span class="string">'no error!'</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">  print(<span class="string">'finally...'</span>)</span><br><span class="line">print(<span class="string">'END'</span>)</span><br></pre></td></tr></table></figure>
<p>Pythonçš„é”™è¯¯å…¶å®ä¹Ÿæ˜¯classï¼Œæ‰€æœ‰çš„é”™è¯¯ç±»å‹éƒ½ç»§æ‰¿è‡ªBaseExceptionï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨exceptæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒä¸ä½†æ•è·è¯¥ç±»å‹çš„é”™è¯¯ï¼Œè¿˜æŠŠå…¶å­ç±»ä¹Ÿâ€œä¸€ç½‘æ‰“å°½â€ã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  foo()</span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">  print(<span class="string">'ValueError'</span>)</span><br><span class="line"><span class="keyword">except</span> UnicodeError <span class="keyword">as</span> e:</span><br><span class="line">  print(<span class="string">'UnicodeError'</span>)</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒä¸ªexceptæ°¸è¿œä¹Ÿæ•è·ä¸åˆ°UnicodeErrorï¼Œå› ä¸ºUnicodeErroræ˜¯ValueErrorçš„å­ç±»ï¼Œå¦‚æœæœ‰ï¼Œä¹Ÿè¢«ç¬¬ä¸€ä¸ªexceptç»™æ•è·äº†ã€‚</p>
<p>è°ƒç”¨æ ˆ</p>
<p>å¦‚æœé”™è¯¯æ²¡æœ‰è¢«æ•è·ï¼Œå®ƒå°±ä¼šä¸€ç›´å¾€ä¸ŠæŠ›ï¼Œæœ€åè¢«Pythonè§£é‡Šå™¨æ•è·ï¼Œæ‰“å°ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œç„¶åç¨‹åºé€€å‡ºã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ python3 err.py</span><br><span class="line">Traceback (most recent call last):   <span class="comment"># é”™è¯¯çš„è·Ÿè¸ªä¿¡æ¯</span></span><br><span class="line">  File <span class="string">"err.py"</span>, line <span class="number">11</span>, <span class="keyword">in</span> &lt;module&gt;   <span class="comment"># mainå‡ºé”™äº†</span></span><br><span class="line">  main()</span><br><span class="line">  File <span class="string">"err.py"</span>, line <span class="number">9</span>, <span class="keyword">in</span> main</span><br><span class="line">  bar(<span class="string">'0'</span>)</span><br><span class="line">  File <span class="string">"err.py"</span>, line <span class="number">6</span>, <span class="keyword">in</span> bar</span><br><span class="line">  <span class="keyword">return</span> foo(s) * <span class="number">2</span></span><br><span class="line">  File <span class="string">"err.py"</span>, line <span class="number">3</span>, <span class="keyword">in</span> foo</span><br><span class="line">  <span class="keyword">return</span> <span class="number">10</span> / int(s)</span><br><span class="line">ZeroDivisionError: division by zero</span><br></pre></td></tr></table></figure>
<p>å‡ºé”™çš„æ—¶å€™ï¼Œä¸€å®šè¦åˆ†æé”™è¯¯çš„è°ƒç”¨æ ˆä¿¡æ¯ï¼Œæ‰èƒ½å®šä½é”™è¯¯çš„ä½ç½®ã€‚</p>
<h4 id="è®°å½•é”™è¯¯"><a href="#è®°å½•é”™è¯¯" class="headerlink" title="è®°å½•é”™è¯¯"></a>è®°å½•é”™è¯¯</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    bar(<span class="string">'0'</span>)</span><br><span class="line">  <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    logging.exception(e)</span><br></pre></td></tr></table></figure>
<h4 id="è‡ªå®šä¹‰æŠ›å‡ºé”™è¯¯"><a href="#è‡ªå®šä¹‰æŠ›å‡ºé”™è¯¯" class="headerlink" title="è‡ªå®šä¹‰æŠ›å‡ºé”™è¯¯"></a>è‡ªå®šä¹‰æŠ›å‡ºé”™è¯¯</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># err_raise.py</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FooError</span><span class="params">(ValueError)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(s)</span>:</span></span><br><span class="line">  n = int(s)</span><br><span class="line">  <span class="keyword">if</span> n==<span class="number">0</span>:</span><br><span class="line">    <span class="keyword">raise</span> FooError(<span class="string">'invalid value: %s'</span> % s)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">10</span> / n</span><br><span class="line"></span><br><span class="line">foo(<span class="string">'0'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><p>æ–­è¨€</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> n != <span class="number">0</span>, <span class="string">'n is zero!'</span></span><br><span class="line"><span class="comment"># å¦‚æœæ–­è¨€å¤±è´¥ï¼Œä¼šæŠ›å‡ºAssertionError</span></span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨Pythonè§£é‡Šå™¨æ—¶å¯ä»¥ç”¨ -O å‚æ•°æ¥å…³é—­æ–­è¨€ã€‚ï¼ˆç›¸å½“äºå…¨éƒ¨å˜æˆpassï¼‰</p>
<p>logging</p>
<p>è¾“å‡ºä¸€æ®µæ–‡æœ¬ï¼Œä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè€Œä¸”å¯ä»¥è¾“å‡ºåˆ°æ–‡ä»¶ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.basicConfig(level=logging.INFO)</span><br><span class="line"></span><br><span class="line">s = <span class="string">'0'</span></span><br><span class="line">n = int(s)</span><br><span class="line">logging.info(<span class="string">'n = %d'</span> % n)</span><br><span class="line">print(<span class="number">10</span> / n)</span><br></pre></td></tr></table></figure>
<p>è¿™å°±æ˜¯loggingçš„å¥½å¤„ï¼Œå®ƒå…è®¸ä½ æŒ‡å®šè®°å½•ä¿¡æ¯çš„çº§åˆ«ï¼Œæœ‰ï¼š</p>
<p>debugï¼Œinfoï¼Œwarningï¼Œerrorç­‰å‡ ä¸ªçº§åˆ«ã€‚</p>
<p>å½“æˆ‘ä»¬æŒ‡å®šlevel=INFOæ—¶ï¼Œlogging.debugå°±ä¸èµ·ä½œç”¨äº†ã€‚åŒç†ï¼ŒæŒ‡å®šlevel=WARNINGåï¼Œdebugå’Œinfoå°±ä¸èµ·ä½œç”¨äº†ã€‚è¿™æ ·ä¸€æ¥ï¼Œä½ å¯ä»¥æ”¾å¿ƒåœ°è¾“å‡ºä¸åŒçº§åˆ«çš„ä¿¡æ¯ï¼Œä¹Ÿä¸ç”¨åˆ é™¤ï¼Œæœ€åç»Ÿä¸€æ§åˆ¶è¾“å‡ºå“ªä¸ªçº§åˆ«çš„ä¿¡æ¯ã€‚</p>
<p>pdb</p>
<p>å¯åŠ¨ï¼špython -m pdb err.py</p>
<p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431915578556ad30ab3933ae4e82a03ee2e9a4f70871000" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431915578556ad30ab3933ae4e82a03ee2e9a4f70871000</a></p>
<h3 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h3><p>ä¸ºäº†ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥Pythonè‡ªå¸¦çš„unittestæ¨¡å—ï¼Œç¼–å†™mydict_test.pyå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> mydict <span class="keyword">import</span> Dict</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDict</span><span class="params">(unittest.TestCase)</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test_init</span><span class="params">(self)</span>:</span></span><br><span class="line">    d = Dict(a=<span class="number">1</span>, b=<span class="string">'test'</span>)</span><br><span class="line">    self.assertEqual(d.a, <span class="number">1</span>)</span><br><span class="line">    self.assertEqual(d.b, <span class="string">'test'</span>)</span><br><span class="line">    self.assertTrue(isinstance(d, dict))</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test_key</span><span class="params">(self)</span>:</span></span><br><span class="line">    d = Dict()</span><br><span class="line">    d[<span class="string">'key'</span>] = <span class="string">'value'</span></span><br><span class="line">    self.assertEqual(d.key, <span class="string">'value'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test_attr</span><span class="params">(self)</span>:</span></span><br><span class="line">    d = Dict()</span><br><span class="line">    d.key = <span class="string">'value'</span></span><br><span class="line">    self.assertTrue(<span class="string">'key'</span> <span class="keyword">in</span> d)</span><br><span class="line">    self.assertEqual(d[<span class="string">'key'</span>], <span class="string">'value'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test_keyerror</span><span class="params">(self)</span>:</span></span><br><span class="line">    d = Dict()</span><br><span class="line">    <span class="keyword">with</span> self.assertRaises(KeyError):</span><br><span class="line">      value = d[<span class="string">'empty'</span>]</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test_attrerror</span><span class="params">(self)</span>:</span></span><br><span class="line">    d = Dict()</span><br><span class="line">    <span class="keyword">with</span> self.assertRaises(AttributeError):</span><br><span class="line">      value = d.empty</span><br><span class="line"></span><br><span class="line">  <span class="comment"># è¿™ä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«åœ¨æ¯è°ƒç”¨ä¸€ä¸ªæµ‹è¯•æ–¹æ³•çš„å‰ååˆ†åˆ«è¢«æ‰§è¡Œï¼Œä¸ç”¨é‡å¤å†™ä»£ç äº†ã€‚</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></span><br><span class="line">    print(<span class="string">'setUp...'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(self)</span>:</span></span><br><span class="line">    print(<span class="string">'tearDown...'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">  unittest.main()</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>python mydict_test.py</span><br><span class="line"><span class="keyword">or</span> &gt;&gt;&gt; python -m unittest mydict_test (recommended)</span><br><span class="line"></span><br><span class="line">.....</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">Ran <span class="number">5</span> tests <span class="keyword">in</span> <span class="number">0.000</span>s</span><br><span class="line"></span><br><span class="line">OK</span><br></pre></td></tr></table></figure>
<h3 id="æ–‡æ¡£æµ‹è¯•-doctest"><a href="#æ–‡æ¡£æµ‹è¯•-doctest" class="headerlink" title="æ–‡æ¡£æµ‹è¯• doctest"></a>æ–‡æ¡£æµ‹è¯• doctest</h3><p>è‡ªåŠ¨æ‰§è¡Œå†™åœ¨æ³¨é‡Šä¸­çš„è¿™äº›ä»£ç ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">abs</span><span class="params">(n)</span>:</span></span><br><span class="line">  <span class="string">'''</span></span><br><span class="line"><span class="string">  Function to get absolute value of number.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Example:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &gt;&gt;&gt; abs(1)</span></span><br><span class="line"><span class="string">  1</span></span><br><span class="line"><span class="string">  &gt;&gt;&gt; abs(-1)</span></span><br><span class="line"><span class="string">  1</span></span><br><span class="line"><span class="string">  &gt;&gt;&gt; abs(0)</span></span><br><span class="line"><span class="string">  0</span></span><br><span class="line"><span class="string">  '''</span></span><br><span class="line">  <span class="keyword">return</span> n <span class="keyword">if</span> n &gt;= <span class="number">0</span> <span class="keyword">else</span> (-n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">  <span class="keyword">import</span> doctest</span><br><span class="line">  doctest.testmod()</span><br><span class="line"><span class="comment">#æ³¨æ„åˆ°æœ€å3è¡Œä»£ç ã€‚å½“æ¨¡å—æ­£å¸¸å¯¼å…¥æ—¶ï¼Œdoctestä¸ä¼šè¢«æ‰§è¡Œã€‚åªæœ‰åœ¨å‘½ä»¤è¡Œç›´æ¥è¿è¡Œæ—¶ï¼Œæ‰æ‰§è¡Œdoctestã€‚æ‰€ä»¥ï¼Œä¸å¿…æ‹…å¿ƒdoctestä¼šåœ¨éæµ‹è¯•ç¯å¢ƒä¸‹æ‰§è¡Œã€‚</span></span><br></pre></td></tr></table></figure>
<p>Pythonå†…ç½®çš„â€œæ–‡æ¡£æµ‹è¯•â€ï¼ˆdoctestï¼‰æ¨¡å—å¯ä»¥ç›´æ¥æå–æ³¨é‡Šä¸­çš„ä»£ç å¹¶æ‰§è¡Œæµ‹è¯•ã€‚</p>
<h2 id="IOç¼–ç¨‹"><a href="#IOç¼–ç¨‹" class="headerlink" title="IOç¼–ç¨‹"></a>IOç¼–ç¨‹</h2><h3 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h3><h3 id="StringIOå’ŒBytesIO"><a href="#StringIOå’ŒBytesIO" class="headerlink" title="StringIOå’ŒBytesIO"></a>StringIOå’ŒBytesIO</h3><h3 id="æ“ä½œæ–‡ä»¶å’Œç›®å½•"><a href="#æ“ä½œæ–‡ä»¶å’Œç›®å½•" class="headerlink" title="æ“ä½œæ–‡ä»¶å’Œç›®å½•"></a>æ“ä½œæ–‡ä»¶å’Œç›®å½•</h3><p>æŠŠä¸¤ä¸ªè·¯å¾„åˆæˆä¸€ä¸ªæ—¶ï¼Œä¸è¦ç›´æ¥æ‹¼å­—ç¬¦ä¸²ï¼Œè€Œè¦é€šè¿‡os.path.join()å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æ­£ç¡®å¤„ç†ä¸åŒæ“ä½œç³»ç»Ÿçš„è·¯å¾„åˆ†éš”ç¬¦ã€‚åœ¨Linux/Unix/Macä¸‹ï¼Œos.path.join()è¿”å›è¿™æ ·çš„å­—ç¬¦ä¸²ï¼š</p>
<p>part-1/part-2</p>
<p>åŒæ ·çš„é“ç†ï¼Œè¦æ‹†åˆ†è·¯å¾„æ—¶ï¼Œä¹Ÿä¸è¦ç›´æ¥å»æ‹†å­—ç¬¦ä¸²ï¼Œè€Œè¦é€šè¿‡os.path.split()å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æŠŠä¸€ä¸ªè·¯å¾„æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåä¸€éƒ¨åˆ†æ€»æ˜¯æœ€åçº§åˆ«çš„ç›®å½•æˆ–æ–‡ä»¶åï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.path.split(<span class="string">'/Users/michael/testdir/file.txt'</span>)</span><br><span class="line">(<span class="string">'/Users/michael/testdir'</span>, <span class="string">'file.txt'</span>)</span><br></pre></td></tr></table></figure>
<p>os.path.splitext()å¯ä»¥ç›´æ¥è®©ä½ å¾—åˆ°æ–‡ä»¶æ‰©å±•åï¼Œå¾ˆå¤šæ—¶å€™éå¸¸æ–¹ä¾¿ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.path.splitext(<span class="string">'/path/to/file.txt'</span>)</span><br><span class="line">(<span class="string">'/path/to/file'</span>, <span class="string">'.txt'</span>)</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯å¤åˆ¶æ–‡ä»¶çš„å‡½æ•°å±…ç„¶åœ¨osæ¨¡å—ä¸­ä¸å­˜åœ¨ï¼åŸå› æ˜¯å¤åˆ¶æ–‡ä»¶å¹¶éç”±æ“ä½œç³»ç»Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨ã€‚ç†è®ºä¸Šè®²ï¼Œæˆ‘ä»¬é€šè¿‡ä¸Šä¸€èŠ‚çš„è¯»å†™æ–‡ä»¶å¯ä»¥å®Œæˆæ–‡ä»¶å¤åˆ¶ï¼Œåªä¸è¿‡è¦å¤šå†™å¾ˆå¤šä»£ç ã€‚</p>
<p>å¹¸è¿çš„æ˜¯shutilæ¨¡å—æä¾›äº†copyfile()çš„å‡½æ•°ï¼Œä½ è¿˜å¯ä»¥åœ¨shutilæ¨¡å—ä¸­æ‰¾åˆ°å¾ˆå¤šå®ç”¨å‡½æ•°ï¼Œå®ƒä»¬å¯ä»¥çœ‹åšæ˜¯osæ¨¡å—çš„è¡¥å……ã€‚</p>
<p>æœ€åçœ‹çœ‹å¦‚ä½•åˆ©ç”¨Pythonçš„ç‰¹æ€§æ¥è¿‡æ»¤æ–‡ä»¶ã€‚æ¯”å¦‚æˆ‘ä»¬è¦åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•ï¼Œåªéœ€è¦ä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[x <span class="keyword">for</span> x <span class="keyword">in</span> os.listdir(<span class="string">'.'</span>) <span class="keyword">if</span> os.path.isdir(x)]</span><br><span class="line">[<span class="string">'.lein'</span>, <span class="string">'.local'</span>, <span class="string">'.m2'</span>, <span class="string">'.npm'</span>, <span class="string">'.ssh'</span>, <span class="string">'.Trash'</span>, <span class="string">'.vim'</span>, <span class="string">'Applications'</span>, <span class="string">'Desktop'</span>, ...]</span><br></pre></td></tr></table></figure>
<h3 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h3><p>æˆ‘ä»¬æŠŠå˜é‡ä»å†…å­˜ä¸­å˜æˆå¯å­˜å‚¨æˆ–ä¼ è¾“çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºåºåˆ—åŒ–ï¼Œåœ¨Pythonä¸­å«picklingï¼Œåœ¨å…¶ä»–è¯­è¨€ä¸­ä¹Ÿè¢«ç§°ä¹‹ä¸ºserializationï¼Œmarshallingï¼Œflatteningç­‰ç­‰ï¼Œéƒ½æ˜¯ä¸€ä¸ªæ„æ€ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pickle</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = dict(name=<span class="string">'Bob'</span>, age=<span class="number">20</span>, score=<span class="number">88</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pickle.dumps(d)</span><br><span class="line"><span class="string">b'\x80\x03&#125;q\x00(X\x03\x00\x00\x00ageq\x01K\x14X\x05\x00\x00\x00scoreq\x02KXX\x04\x00\x00\x00nameq\x03X\x03\x00\x00\x00Bobq\x04u.'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># write</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'dump.txt'</span>, <span class="string">'wb'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pickle.dump(d, f)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># read</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'dump.txt'</span>, <span class="string">'rb'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = pickle.load(f)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="number">20</span>, <span class="string">'score'</span>: <span class="number">88</span>, <span class="string">'name'</span>: <span class="string">'Bob'</span>&#125;</span><br></pre></td></tr></table></figure>
<p>JSON</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> json</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = dict(name=<span class="string">'Bob'</span>, age=<span class="number">20</span>, score=<span class="number">88</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>json.dumps(d)</span><br><span class="line"><span class="string">'&#123;"age": 20, "score": 88, "name": "Bob"&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>json_str = <span class="string">'&#123;"age": 20, "score": 88, "name": "Bob"&#125;'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>json.loads(json_str)</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="number">20</span>, <span class="string">'score'</span>: <span class="number">88</span>, <span class="string">'name'</span>: <span class="string">'Bob'</span>&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦å¯¹Studentç±»åºåˆ—åŒ–ï¼Œå†™ä¸€ä¸ªè½¬æ¢å‡½æ•°æŠŠå¯¹è±¡è½¬ä¸ºå­—å…¸ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">student2dict</span><span class="params">(std)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="string">'name'</span>: std.name,</span><br><span class="line">    <span class="string">'age'</span>: std.age,</span><br><span class="line">    <span class="string">'score'</span>: std.score</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(json.dumps(s, default=student2dict))</span><br><span class="line">&#123;<span class="string">"age"</span>: <span class="number">20</span>, <span class="string">"name"</span>: <span class="string">"Bob"</span>, <span class="string">"score"</span>: <span class="number">88</span>&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡ï¼Œä¸‹æ¬¡å¦‚æœé‡åˆ°ä¸€ä¸ªTeacherç±»çš„å®ä¾‹ï¼Œç…§æ ·æ— æ³•åºåˆ—åŒ–ä¸ºJSONã€‚æˆ‘ä»¬å¯ä»¥å·ä¸ªæ‡’ï¼ŒæŠŠä»»æ„classçš„å®ä¾‹å˜ä¸ºdictï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json.dumps(s, default=<span class="keyword">lambda</span> obj: obj.__dict__)</span><br></pre></td></tr></table></figure>
<p>å¯¹ä¸­æ–‡è¿›è¡ŒJSONåºåˆ—åŒ–æ—¶ï¼Œjson.dumps()æä¾›äº†ä¸€ä¸ªensure_asciiå‚æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = dict(name=<span class="string">'å°æ˜'</span>, age=<span class="number">20</span>)</span><br><span class="line">s = json.dumps(obj, ensure_ascii=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<h2 id="è¿›ç¨‹å’Œçº¿ç¨‹"><a href="#è¿›ç¨‹å’Œçº¿ç¨‹" class="headerlink" title="è¿›ç¨‹å’Œçº¿ç¨‹"></a>è¿›ç¨‹å’Œçº¿ç¨‹</h2><h3 id="å¤šè¿›ç¨‹"><a href="#å¤šè¿›ç¨‹" class="headerlink" title="å¤šè¿›ç¨‹"></a>å¤šè¿›ç¨‹</h3><p>Unix/Linuxæ“ä½œç³»ç»Ÿæä¾›äº†ä¸€ä¸ªfork()ç³»ç»Ÿè°ƒç”¨ï¼Œå®ƒéå¸¸ç‰¹æ®Šã€‚æ™®é€šçš„å‡½æ•°è°ƒç”¨ï¼Œè°ƒç”¨ä¸€æ¬¡ï¼Œè¿”å›ä¸€æ¬¡ï¼Œä½†æ˜¯fork()è°ƒç”¨ä¸€æ¬¡ï¼Œè¿”å›ä¸¤æ¬¡ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿè‡ªåŠ¨æŠŠå½“å‰è¿›ç¨‹ï¼ˆç§°ä¸ºçˆ¶è¿›ç¨‹ï¼‰å¤åˆ¶äº†ä¸€ä»½ï¼ˆç§°ä¸ºå­è¿›ç¨‹ï¼‰ï¼Œç„¶åï¼Œåˆ†åˆ«åœ¨çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å†…è¿”å›ã€‚</p>
<p>å­è¿›ç¨‹æ°¸è¿œè¿”å›0ï¼Œè€Œçˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹çš„IDã€‚è¿™æ ·åšçš„ç†ç”±æ˜¯ï¼Œä¸€ä¸ªçˆ¶è¿›ç¨‹å¯ä»¥forkå‡ºå¾ˆå¤šå­è¿›ç¨‹ï¼Œæ‰€ä»¥ï¼Œçˆ¶è¿›ç¨‹è¦è®°ä¸‹æ¯ä¸ªå­è¿›ç¨‹çš„IDï¼Œè€Œå­è¿›ç¨‹åªéœ€è¦è°ƒç”¨getppid()å°±å¯ä»¥æ‹¿åˆ°çˆ¶è¿›ç¨‹çš„IDã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">print(<span class="string">'Process (%s) start...'</span> % os.getpid())</span><br><span class="line"><span class="comment"># Only works on Unix/Linux/Mac:</span></span><br><span class="line">pid = os.fork()</span><br><span class="line"><span class="keyword">if</span> pid == <span class="number">0</span>:</span><br><span class="line">  print(<span class="string">'I am child process (%s) and my parent is %s.'</span> % (os.getpid(), os.getppid()))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  print(<span class="string">'I (%s) just created a child process (%s).'</span> % (os.getpid(), pid))</span><br></pre></td></tr></table></figure>
<p>multiprocessingæ¨¡å—å°±æ˜¯è·¨å¹³å°ç‰ˆæœ¬çš„å¤šè¿›ç¨‹æ¨¡å—ã€‚multiprocessingæ¨¡å—æä¾›äº†ä¸€ä¸ªProcessç±»æ¥ä»£è¡¨ä¸€ä¸ªè¿›ç¨‹å¯¹è±¡ï¼Œä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹å¹¶ç­‰å¾…å…¶ç»“æŸï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_proc</span><span class="params">(name)</span>:</span></span><br><span class="line">  print(<span class="string">'Run child process %s (%s)...'</span> % (name, os.getpid()))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">  print(<span class="string">'Parent process %s.'</span> % os.getpid())</span><br><span class="line">  p = Process(target=run_proc, args=(<span class="string">'test'</span>,))</span><br><span class="line">  print(<span class="string">'Child process will start.'</span>)</span><br><span class="line">  p.start()</span><br><span class="line">  p.join()</span><br><span class="line">  print(<span class="string">'Child process end.'</span>)</span><br><span class="line"></span><br><span class="line">Parent process <span class="number">928.</span></span><br><span class="line">Process will start.</span><br><span class="line">Run child process test (<span class="number">929</span>)...</span><br><span class="line">Process end.</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ‰§è¡Œå‡½æ•°å’Œå‡½æ•°çš„å‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªProcesså®ä¾‹ï¼Œç”¨start()æ–¹æ³•å¯åŠ¨ï¼Œè¿™æ ·åˆ›å»ºè¿›ç¨‹æ¯”fork()è¿˜è¦ç®€å•ã€‚</p>
<p>join()æ–¹æ³•å¯ä»¥ç­‰å¾…å­è¿›ç¨‹ç»“æŸåå†ç»§ç»­å¾€ä¸‹è¿è¡Œï¼Œé€šå¸¸ç”¨äºè¿›ç¨‹é—´çš„åŒæ­¥ã€‚</p>
<h4 id="Pool"><a href="#Pool" class="headerlink" title="Pool"></a>Pool</h4><p>å¦‚æœè¦å¯åŠ¨å¤§é‡çš„å­è¿›ç¨‹ï¼Œå¯ä»¥ç”¨è¿›ç¨‹æ± çš„æ–¹å¼æ‰¹é‡åˆ›å»ºå­è¿›ç¨‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="keyword">import</span> os, time, random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">long_time_task</span><span class="params">(name)</span>:</span></span><br><span class="line">  print(<span class="string">'Run task %s (%s)...'</span> % (name, os.getpid()))</span><br><span class="line">  start = time.time()</span><br><span class="line">  time.sleep(random.random() * <span class="number">3</span>)</span><br><span class="line">  end = time.time()</span><br><span class="line">  print(<span class="string">'Task %s runs %0.2f seconds.'</span> % (name, (end - start)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">  print(<span class="string">'Parent process %s.'</span> % os.getpid())</span><br><span class="line">  p = Pool(<span class="number">4</span>)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    p.apply_async(long_time_task, args=(i,))</span><br><span class="line">  print(<span class="string">'Waiting for all subprocesses done...'</span>)</span><br><span class="line">  p.close()</span><br><span class="line">  p.join()</span><br><span class="line">  print(<span class="string">'All subprocesses done.'</span>)</span><br></pre></td></tr></table></figure>
<p>å¯¹Poolå¯¹è±¡è°ƒç”¨join()æ–¹æ³•ä¼šç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œè°ƒç”¨join()ä¹‹å‰å¿…é¡»å…ˆè°ƒç”¨close()ï¼Œè°ƒç”¨close()ä¹‹åå°±ä¸èƒ½ç»§ç»­æ·»åŠ æ–°çš„Processäº†ã€‚</p>
<p>è¯·æ³¨æ„è¾“å‡ºçš„ç»“æœï¼Œtask 0ï¼Œ1ï¼Œ2ï¼Œ3æ˜¯ç«‹åˆ»æ‰§è¡Œçš„ï¼Œè€Œtask 4è¦ç­‰å¾…å‰é¢æŸä¸ªtaskå®Œæˆåæ‰æ‰§è¡Œï¼Œè¿™æ˜¯å› ä¸ºPoolçš„é»˜è®¤å¤§å°åœ¨æˆ‘çš„ç”µè„‘ä¸Šæ˜¯4ï¼Œå› æ­¤ï¼Œæœ€å¤šåŒæ—¶æ‰§è¡Œ4ä¸ªè¿›ç¨‹ã€‚è¿™æ˜¯Poolæœ‰æ„è®¾è®¡çš„é™åˆ¶ï¼Œå¹¶ä¸æ˜¯æ“ä½œç³»ç»Ÿçš„é™åˆ¶ã€‚</p>
<h4 id="è¿›ç¨‹é—´é€šä¿¡"><a href="#è¿›ç¨‹é—´é€šä¿¡" class="headerlink" title="è¿›ç¨‹é—´é€šä¿¡"></a>è¿›ç¨‹é—´é€šä¿¡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue</span><br><span class="line"><span class="keyword">import</span> os, time, random</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™æ•°æ®è¿›ç¨‹æ‰§è¡Œçš„ä»£ç :</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(q)</span>:</span></span><br><span class="line">  print(<span class="string">'Process to write: %s'</span> % os.getpid())</span><br><span class="line">  <span class="keyword">for</span> value <span class="keyword">in</span> [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>]:</span><br><span class="line">    print(<span class="string">'Put %s to queue...'</span> % value)</span><br><span class="line">    q.put(value)</span><br><span class="line">    time.sleep(random.random())</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»æ•°æ®è¿›ç¨‹æ‰§è¡Œçš„ä»£ç :</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(q)</span>:</span></span><br><span class="line">  print(<span class="string">'Process to read: %s'</span> % os.getpid())</span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    value = q.get(<span class="literal">True</span>)</span><br><span class="line">    print(<span class="string">'Get %s from queue.'</span> % value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">  <span class="comment"># çˆ¶è¿›ç¨‹åˆ›å»ºQueueï¼Œå¹¶ä¼ ç»™å„ä¸ªå­è¿›ç¨‹ï¼š</span></span><br><span class="line">  q = Queue()</span><br><span class="line">  pw = Process(target=write, args=(q,))</span><br><span class="line">  pr = Process(target=read, args=(q,))</span><br><span class="line">  <span class="comment"># å¯åŠ¨å­è¿›ç¨‹pwï¼Œå†™å…¥:</span></span><br><span class="line">  pw.start()</span><br><span class="line">  <span class="comment"># å¯åŠ¨å­è¿›ç¨‹prï¼Œè¯»å–:</span></span><br><span class="line">  pr.start()</span><br><span class="line">  <span class="comment"># ç­‰å¾…pwç»“æŸ:</span></span><br><span class="line">  pw.join()</span><br><span class="line">  <span class="comment"># prè¿›ç¨‹é‡Œæ˜¯æ­»å¾ªç¯ï¼Œæ— æ³•ç­‰å¾…å…¶ç»“æŸï¼Œåªèƒ½å¼ºè¡Œç»ˆæ­¢:</span></span><br><span class="line">  pr.terminate()</span><br></pre></td></tr></table></figure>
<h4 id="å¤–éƒ¨å­è¿›ç¨‹"><a href="#å¤–éƒ¨å­è¿›ç¨‹" class="headerlink" title="å¤–éƒ¨å­è¿›ç¨‹"></a>å¤–éƒ¨å­è¿›ç¨‹</h4><p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431927781401bb47ccf187b24c3b955157bb12c5882d000" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431927781401bb47ccf187b24c3b955157bb12c5882d000</a></p>
<h3 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h3><p>ç”±äºçº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿç›´æ¥æ”¯æŒçš„æ‰§è¡Œå•å…ƒï¼Œå› æ­¤ï¼Œé«˜çº§è¯­è¨€é€šå¸¸éƒ½å†…ç½®å¤šçº¿ç¨‹çš„æ”¯æŒï¼ŒPythonä¹Ÿä¸ä¾‹å¤–ï¼Œå¹¶ä¸”ï¼ŒPythonçš„çº¿ç¨‹æ˜¯çœŸæ­£çš„Posix Threadï¼Œè€Œä¸æ˜¯æ¨¡æ‹Ÿå‡ºæ¥çš„çº¿ç¨‹ã€‚</p>
<p>Pythonçš„æ ‡å‡†åº“æä¾›äº†ä¸¤ä¸ªæ¨¡å—ï¼š_threadå’Œthreadingï¼Œ_threadæ˜¯ä½çº§æ¨¡å—ï¼Œthreadingæ˜¯é«˜çº§æ¨¡å—ï¼Œå¯¹_threadè¿›è¡Œäº†å°è£…ã€‚ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨threadingè¿™ä¸ªé«˜çº§æ¨¡å—ã€‚</p>
<p>å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å°±æ˜¯æŠŠä¸€ä¸ªå‡½æ•°ä¼ å…¥å¹¶åˆ›å»ºThreadå®ä¾‹ï¼Œç„¶åè°ƒç”¨start()å¼€å§‹æ‰§è¡Œï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time, threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°çº¿ç¨‹æ‰§è¡Œçš„ä»£ç :</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loop</span><span class="params">()</span>:</span></span><br><span class="line">  print(<span class="string">'thread %s is running...'</span> % threading.current_thread().name)</span><br><span class="line">  n = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> n &lt; <span class="number">5</span>:</span><br><span class="line">    n = n + <span class="number">1</span></span><br><span class="line">    print(<span class="string">'thread %s &gt;&gt;&gt; %s'</span> % (threading.current_thread().name, n))</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">  print(<span class="string">'thread %s ended.'</span> % threading.current_thread().name)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'thread %s is running...'</span> % threading.current_thread().name)</span><br><span class="line">t = threading.Thread(target=loop, name=<span class="string">'LoopThread'</span>)</span><br><span class="line">t.start()</span><br><span class="line">t.join()</span><br><span class="line">print(<span class="string">'thread %s ended.'</span> % threading.current_thread().name)</span><br></pre></td></tr></table></figure>
<h4 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h4><p>å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹æœ€å¤§çš„ä¸åŒåœ¨äºï¼Œå¤šè¿›ç¨‹ä¸­ï¼ŒåŒä¸€ä¸ªå˜é‡ï¼Œå„è‡ªæœ‰ä¸€ä»½æ‹·è´å­˜åœ¨äºæ¯ä¸ªè¿›ç¨‹ä¸­ï¼Œäº’ä¸å½±å“ï¼Œè€Œå¤šçº¿ç¨‹ä¸­ï¼Œæ‰€æœ‰å˜é‡éƒ½ç”±æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œæ‰€ä»¥ï¼Œä»»ä½•ä¸€ä¸ªå˜é‡éƒ½å¯ä»¥è¢«ä»»ä½•ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹ï¼Œå› æ­¤ï¼Œçº¿ç¨‹ä¹‹é—´å…±äº«æ•°æ®æœ€å¤§çš„å±é™©åœ¨äºå¤šä¸ªçº¿ç¨‹åŒæ—¶æ”¹ä¸€ä¸ªå˜é‡ï¼ŒæŠŠå†…å®¹ç»™æ”¹ä¹±äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time, threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡å®šè¿™æ˜¯ä½ çš„é“¶è¡Œå­˜æ¬¾:</span></span><br><span class="line">balance = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_it</span><span class="params">(n)</span>:</span></span><br><span class="line">  <span class="comment"># å…ˆå­˜åå–ï¼Œç»“æœåº”è¯¥ä¸º0:</span></span><br><span class="line">  <span class="keyword">global</span> balance</span><br><span class="line">  balance = balance + n   </span><br><span class="line">  <span class="comment"># åŸå› æ˜¯å› ä¸ºé«˜çº§è¯­è¨€çš„ä¸€æ¡è¯­å¥åœ¨CPUæ‰§è¡Œæ—¶æ˜¯è‹¥å¹²æ¡è¯­å¥</span></span><br><span class="line">  balance = balance - n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_thread</span><span class="params">(n)</span>:</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>):</span><br><span class="line">    change_it(n)</span><br><span class="line"></span><br><span class="line">t1 = threading.Thread(target=run_thread, args=(<span class="number">5</span>,))</span><br><span class="line">t2 = threading.Thread(target=run_thread, args=(<span class="number">8</span>,))</span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t1.join()</span><br><span class="line">t2.join()</span><br><span class="line">print(balance)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬è¦ç¡®ä¿balanceè®¡ç®—æ­£ç¡®ï¼Œå°±è¦ç»™change_it()ä¸Šä¸€æŠŠé”ï¼Œå½“æŸä¸ªçº¿ç¨‹å¼€å§‹æ‰§è¡Œchange_it()æ—¶ï¼Œæˆ‘ä»¬è¯´ï¼Œè¯¥çº¿ç¨‹å› ä¸ºè·å¾—äº†é”ï¼Œå› æ­¤å…¶ä»–çº¿ç¨‹ä¸èƒ½åŒæ—¶æ‰§è¡Œchange_it()ï¼Œåªèƒ½ç­‰å¾…ï¼Œç›´åˆ°é”è¢«é‡Šæ”¾åï¼Œè·å¾—è¯¥é”ä»¥åæ‰èƒ½æ”¹ã€‚ç”±äºé”åªæœ‰ä¸€ä¸ªï¼Œæ— è®ºå¤šå°‘çº¿ç¨‹ï¼ŒåŒä¸€æ—¶åˆ»æœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹æŒæœ‰è¯¥é”ï¼Œæ‰€ä»¥ï¼Œä¸ä¼šé€ æˆä¿®æ”¹çš„å†²çªã€‚åˆ›å»ºä¸€ä¸ªé”å°±æ˜¯é€šè¿‡threading.Lock()æ¥å®ç°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">balance = <span class="number">0</span></span><br><span class="line">lock = threading.Lock()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_thread</span><span class="params">(n)</span>:</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>):</span><br><span class="line">    <span class="comment"># å…ˆè¦è·å–é”:</span></span><br><span class="line">    lock.acquire()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      <span class="comment"># æ”¾å¿ƒåœ°æ”¹å§:</span></span><br><span class="line">      change_it(n)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">      <span class="comment"># æ”¹å®Œäº†ä¸€å®šè¦é‡Šæ”¾é”:</span></span><br><span class="line">      lock.release()</span><br></pre></td></tr></table></figure>
<p>è¯•è¯•ç”¨Pythonå†™ä¸ªæ­»å¾ªç¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading, multiprocessing</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loop</span><span class="params">()</span>:</span></span><br><span class="line">  x = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    x = x ^ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(multiprocessing.cpu_count()):</span><br><span class="line">  t = threading.Thread(target=loop)</span><br><span class="line">  t.start()</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨ä¸CPUæ ¸å¿ƒæ•°é‡ç›¸åŒçš„Nä¸ªçº¿ç¨‹ï¼Œåœ¨4æ ¸CPUä¸Šå¯ä»¥ç›‘æ§åˆ°CPUå ç”¨ç‡ä»…æœ‰102%ï¼Œä¹Ÿå°±æ˜¯ä»…ä½¿ç”¨äº†ä¸€æ ¸ã€‚</p>
<p>ä½†æ˜¯ç”¨Cã€C++æˆ–Javaæ¥æ”¹å†™ç›¸åŒçš„æ­»å¾ªç¯ï¼Œç›´æ¥å¯ä»¥æŠŠå…¨éƒ¨æ ¸å¿ƒè·‘æ»¡ï¼Œ4æ ¸å°±è·‘åˆ°400%ï¼Œ8æ ¸å°±è·‘åˆ°800%ï¼Œä¸ºä»€ä¹ˆPythonä¸è¡Œå‘¢ï¼Ÿ</p>
<p>å› ä¸ºPythonçš„çº¿ç¨‹è™½ç„¶æ˜¯çœŸæ­£çš„çº¿ç¨‹ï¼Œä½†è§£é‡Šå™¨æ‰§è¡Œä»£ç æ—¶ï¼Œæœ‰ä¸€ä¸ªGILé”ï¼šGlobal Interpreter Lockï¼Œä»»ä½•Pythonçº¿ç¨‹æ‰§è¡Œå‰ï¼Œå¿…é¡»å…ˆè·å¾—GILé”ï¼Œç„¶åï¼Œæ¯æ‰§è¡Œ100æ¡å­—èŠ‚ç ï¼Œè§£é‡Šå™¨å°±è‡ªåŠ¨é‡Šæ”¾GILé”ï¼Œè®©åˆ«çš„çº¿ç¨‹æœ‰æœºä¼šæ‰§è¡Œã€‚è¿™ä¸ªGILå…¨å±€é”å®é™…ä¸ŠæŠŠæ‰€æœ‰çº¿ç¨‹çš„æ‰§è¡Œä»£ç éƒ½ç»™ä¸Šäº†é”ï¼Œæ‰€ä»¥ï¼Œå¤šçº¿ç¨‹åœ¨Pythonä¸­åªèƒ½äº¤æ›¿æ‰§è¡Œï¼Œå³ä½¿100ä¸ªçº¿ç¨‹è·‘åœ¨100æ ¸CPUä¸Šï¼Œä¹Ÿåªèƒ½ç”¨åˆ°1ä¸ªæ ¸ã€‚</p>
<p>GILæ˜¯Pythonè§£é‡Šå™¨è®¾è®¡çš„å†å²é—ç•™é—®é¢˜ï¼Œé€šå¸¸æˆ‘ä»¬ç”¨çš„è§£é‡Šå™¨æ˜¯å®˜æ–¹å®ç°çš„CPythonï¼Œè¦çœŸæ­£åˆ©ç”¨å¤šæ ¸ï¼Œé™¤éé‡å†™ä¸€ä¸ªä¸å¸¦GILçš„è§£é‡Šå™¨ã€‚</p>
<p>æ‰€ä»¥ï¼Œåœ¨Pythonä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œä½†ä¸è¦æŒ‡æœ›èƒ½æœ‰æ•ˆåˆ©ç”¨å¤šæ ¸ã€‚å¦‚æœä¸€å®šè¦é€šè¿‡å¤šçº¿ç¨‹åˆ©ç”¨å¤šæ ¸ï¼Œé‚£åªèƒ½é€šè¿‡Cæ‰©å±•æ¥å®ç°ï¼Œä¸è¿‡è¿™æ ·å°±å¤±å»äº†Pythonç®€å•æ˜“ç”¨çš„ç‰¹ç‚¹ã€‚</p>
<p>ä¸è¿‡ï¼Œä¹Ÿä¸ç”¨è¿‡äºæ‹…å¿ƒï¼ŒPythonè™½ç„¶ä¸èƒ½åˆ©ç”¨å¤šçº¿ç¨‹å®ç°å¤šæ ¸ä»»åŠ¡ï¼Œä½†å¯ä»¥é€šè¿‡å¤šè¿›ç¨‹å®ç°å¤šæ ¸ä»»åŠ¡ã€‚å¤šä¸ªPythonè¿›ç¨‹æœ‰å„è‡ªç‹¬ç«‹çš„GILé”ï¼Œäº’ä¸å½±å“ã€‚</p>
<h3 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h3><p>åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æ•°æ®ã€‚ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨è‡ªå·±çš„å±€éƒ¨å˜é‡æ¯”ä½¿ç”¨å…¨å±€å˜é‡å¥½ï¼Œå› ä¸ºå±€éƒ¨å˜é‡åªæœ‰çº¿ç¨‹è‡ªå·±èƒ½çœ‹è§ï¼Œä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹ï¼Œè€Œå…¨å±€å˜é‡çš„ä¿®æ”¹å¿…é¡»åŠ é”ã€‚</p>
<p>ä½†æ˜¯å±€éƒ¨å˜é‡ä¹Ÿæœ‰é—®é¢˜ï¼Œå°±æ˜¯åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œä¼ é€’èµ·æ¥å¾ˆéº»çƒ¦ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå…¨å±€ThreadLocalå¯¹è±¡:</span></span><br><span class="line">local_school = threading.local()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_student</span><span class="params">()</span>:</span></span><br><span class="line">  <span class="comment"># è·å–å½“å‰çº¿ç¨‹å…³è”çš„student:</span></span><br><span class="line">  std = local_school.student</span><br><span class="line">  print(<span class="string">'Hello, %s (in %s)'</span> % (std, threading.current_thread().name))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_thread</span><span class="params">(name)</span>:</span></span><br><span class="line">  <span class="comment"># ç»‘å®šThreadLocalçš„student:</span></span><br><span class="line">  local_school.student = name</span><br><span class="line">  process_student()</span><br><span class="line"></span><br><span class="line">t1 = threading.Thread(target= process_thread, args=(<span class="string">'Alice'</span>,), name=<span class="string">'Thread-A'</span>)</span><br><span class="line">t2 = threading.Thread(target= process_thread, args=(<span class="string">'Bob'</span>,), name=<span class="string">'Thread-B'</span>)</span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t1.join()</span><br><span class="line">t2.join()</span><br></pre></td></tr></table></figure>
<h3 id="è¿›ç¨‹-vs-çº¿ç¨‹"><a href="#è¿›ç¨‹-vs-çº¿ç¨‹" class="headerlink" title="è¿›ç¨‹ vs. çº¿ç¨‹"></a>è¿›ç¨‹ vs. çº¿ç¨‹</h3><p>å¤šè¿›ç¨‹æ¨¡å¼æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ç¨³å®šæ€§é«˜ï¼Œå› ä¸ºä¸€ä¸ªå­è¿›ç¨‹å´©æºƒäº†ï¼Œä¸ä¼šå½±å“ä¸»è¿›ç¨‹å’Œå…¶ä»–å­è¿›ç¨‹ã€‚ï¼ˆå½“ç„¶ä¸»è¿›ç¨‹æŒ‚äº†æ‰€æœ‰è¿›ç¨‹å°±å…¨æŒ‚äº†ï¼Œä½†æ˜¯Masterè¿›ç¨‹åªè´Ÿè´£åˆ†é…ä»»åŠ¡ï¼ŒæŒ‚æ‰çš„æ¦‚ç‡ä½ï¼‰è‘—åçš„Apacheæœ€æ—©å°±æ˜¯é‡‡ç”¨å¤šè¿›ç¨‹æ¨¡å¼ã€‚</p>
<p>å¤šè¿›ç¨‹æ¨¡å¼çš„ç¼ºç‚¹æ˜¯åˆ›å»ºè¿›ç¨‹çš„ä»£ä»·å¤§ï¼Œåœ¨Unix/Linuxç³»ç»Ÿä¸‹ï¼Œç”¨forkè°ƒç”¨è¿˜è¡Œï¼Œåœ¨Windowsä¸‹åˆ›å»ºè¿›ç¨‹å¼€é”€å·¨å¤§ã€‚å¦å¤–ï¼Œæ“ä½œç³»ç»Ÿèƒ½åŒæ—¶è¿è¡Œçš„è¿›ç¨‹æ•°ä¹Ÿæ˜¯æœ‰é™çš„ï¼Œåœ¨å†…å­˜å’ŒCPUçš„é™åˆ¶ä¸‹ï¼Œå¦‚æœæœ‰å‡ åƒä¸ªè¿›ç¨‹åŒæ—¶è¿è¡Œï¼Œæ“ä½œç³»ç»Ÿè¿è°ƒåº¦éƒ½ä¼šæˆé—®é¢˜ã€‚</p>
<p>å¤šçº¿ç¨‹æ¨¡å¼é€šå¸¸æ¯”å¤šè¿›ç¨‹å¿«ä¸€ç‚¹ï¼Œä½†æ˜¯ä¹Ÿå¿«ä¸åˆ°å“ªå»ï¼Œè€Œä¸”ï¼Œå¤šçº¿ç¨‹æ¨¡å¼è‡´å‘½çš„ç¼ºç‚¹å°±æ˜¯ä»»ä½•ä¸€ä¸ªçº¿ç¨‹æŒ‚æ‰éƒ½å¯èƒ½ç›´æ¥é€ æˆæ•´ä¸ªè¿›ç¨‹å´©æºƒï¼Œå› ä¸ºæ‰€æœ‰çº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ã€‚åœ¨Windowsä¸Šï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„ä»£ç å‡ºäº†é—®é¢˜ï¼Œä½ ç»å¸¸å¯ä»¥çœ‹åˆ°è¿™æ ·çš„æç¤ºï¼šâ€œè¯¥ç¨‹åºæ‰§è¡Œäº†éæ³•æ“ä½œï¼Œå³å°†å…³é—­â€ï¼Œå…¶å®å¾€å¾€æ˜¯æŸä¸ªçº¿ç¨‹å‡ºäº†é—®é¢˜ï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿä¼šå¼ºåˆ¶ç»“æŸæ•´ä¸ªè¿›ç¨‹ã€‚</p>
<h4 id="è¿›ç¨‹-vs-çº¿ç¨‹-1"><a href="#è¿›ç¨‹-vs-çº¿ç¨‹-1" class="headerlink" title="è¿›ç¨‹ vs. çº¿ç¨‹"></a>è¿›ç¨‹ vs. çº¿ç¨‹</h4><p>é¦–å…ˆï¼Œè¦å®ç°å¤šä»»åŠ¡ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šè®¾è®¡Master-Workeræ¨¡å¼ï¼ŒMasterè´Ÿè´£åˆ†é…ä»»åŠ¡ï¼ŒWorkerè´Ÿè´£æ‰§è¡Œä»»åŠ¡ï¼Œå› æ­¤ï¼Œå¤šä»»åŠ¡ç¯å¢ƒä¸‹ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªMasterï¼Œå¤šä¸ªWorkerã€‚</p>
<p>å¦‚æœç”¨å¤šè¿›ç¨‹å®ç°Master-Workerï¼Œä¸»è¿›ç¨‹å°±æ˜¯Masterï¼Œå…¶ä»–è¿›ç¨‹å°±æ˜¯Workerã€‚</p>
<p>å¦‚æœç”¨å¤šçº¿ç¨‹å®ç°Master-Workerï¼Œä¸»çº¿ç¨‹å°±æ˜¯Masterï¼Œå…¶ä»–çº¿ç¨‹å°±æ˜¯Workerã€‚</p>
<p>å¤šè¿›ç¨‹æ¨¡å¼æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ç¨³å®šæ€§é«˜ï¼Œå› ä¸ºä¸€ä¸ªå­è¿›ç¨‹å´©æºƒäº†ï¼Œä¸ä¼šå½±å“ä¸»è¿›ç¨‹å’Œå…¶ä»–å­è¿›ç¨‹ã€‚ï¼ˆå½“ç„¶ä¸»è¿›ç¨‹æŒ‚äº†æ‰€æœ‰è¿›ç¨‹å°±å…¨æŒ‚äº†ï¼Œä½†æ˜¯Masterè¿›ç¨‹åªè´Ÿè´£åˆ†é…ä»»åŠ¡ï¼ŒæŒ‚æ‰çš„æ¦‚ç‡ä½ï¼‰è‘—åçš„Apacheæœ€æ—©å°±æ˜¯é‡‡ç”¨å¤šè¿›ç¨‹æ¨¡å¼ã€‚</p>
<p>å¤šè¿›ç¨‹æ¨¡å¼çš„ç¼ºç‚¹æ˜¯åˆ›å»ºè¿›ç¨‹çš„ä»£ä»·å¤§ï¼Œåœ¨Unix/Linuxç³»ç»Ÿä¸‹ï¼Œç”¨forkè°ƒç”¨è¿˜è¡Œï¼Œåœ¨Windowsä¸‹åˆ›å»ºè¿›ç¨‹å¼€é”€å·¨å¤§ã€‚å¦å¤–ï¼Œæ“ä½œç³»ç»Ÿèƒ½åŒæ—¶è¿è¡Œçš„è¿›ç¨‹æ•°ä¹Ÿæ˜¯æœ‰é™çš„ï¼Œåœ¨å†…å­˜å’ŒCPUçš„é™åˆ¶ä¸‹ï¼Œå¦‚æœæœ‰å‡ åƒä¸ªè¿›ç¨‹åŒæ—¶è¿è¡Œï¼Œæ“ä½œç³»ç»Ÿè¿è°ƒåº¦éƒ½ä¼šæˆé—®é¢˜ã€‚</p>
<p>å¤šçº¿ç¨‹æ¨¡å¼é€šå¸¸æ¯”å¤šè¿›ç¨‹å¿«ä¸€ç‚¹ï¼Œä½†æ˜¯ä¹Ÿå¿«ä¸åˆ°å“ªå»ï¼Œè€Œä¸”ï¼Œå¤šçº¿ç¨‹æ¨¡å¼è‡´å‘½çš„ç¼ºç‚¹å°±æ˜¯ä»»ä½•ä¸€ä¸ªçº¿ç¨‹æŒ‚æ‰éƒ½å¯èƒ½ç›´æ¥é€ æˆæ•´ä¸ªè¿›ç¨‹å´©æºƒï¼Œå› ä¸ºæ‰€æœ‰çº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ã€‚åœ¨Windowsä¸Šï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„ä»£ç å‡ºäº†é—®é¢˜ï¼Œä½ ç»å¸¸å¯ä»¥çœ‹åˆ°è¿™æ ·çš„æç¤ºï¼šâ€œè¯¥ç¨‹åºæ‰§è¡Œäº†éæ³•æ“ä½œï¼Œå³å°†å…³é—­â€ï¼Œå…¶å®å¾€å¾€æ˜¯æŸä¸ªçº¿ç¨‹å‡ºäº†é—®é¢˜ï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿä¼šå¼ºåˆ¶ç»“æŸæ•´ä¸ªè¿›ç¨‹ã€‚</p>
<p>åœ¨Windowsä¸‹ï¼Œå¤šçº¿ç¨‹çš„æ•ˆç‡æ¯”å¤šè¿›ç¨‹è¦é«˜ï¼Œæ‰€ä»¥å¾®è½¯çš„IISæœåŠ¡å™¨é»˜è®¤é‡‡ç”¨å¤šçº¿ç¨‹æ¨¡å¼ã€‚ç”±äºå¤šçº¿ç¨‹å­˜åœ¨ç¨³å®šæ€§çš„é—®é¢˜ï¼ŒIISçš„ç¨³å®šæ€§å°±ä¸å¦‚Apacheã€‚ä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼ŒIISå’ŒApacheç°åœ¨åˆæœ‰å¤šè¿›ç¨‹+å¤šçº¿ç¨‹çš„æ··åˆæ¨¡å¼ï¼ŒçœŸæ˜¯æŠŠé—®é¢˜è¶Šæè¶Šå¤æ‚ã€‚</p>
<h4 id="è®¡ç®—å¯†é›†å‹-vs-IOå¯†é›†å‹"><a href="#è®¡ç®—å¯†é›†å‹-vs-IOå¯†é›†å‹" class="headerlink" title="è®¡ç®—å¯†é›†å‹ vs. IOå¯†é›†å‹"></a>è®¡ç®—å¯†é›†å‹ vs. IOå¯†é›†å‹</h4><p>æ˜¯å¦é‡‡ç”¨å¤šä»»åŠ¡çš„ç¬¬äºŒä¸ªè€ƒè™‘æ˜¯ä»»åŠ¡çš„ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä»»åŠ¡åˆ†ä¸ºè®¡ç®—å¯†é›†å‹å’ŒIOå¯†é›†å‹ã€‚</p>
<p>è®¡ç®—å¯†é›†å‹ä»»åŠ¡çš„ç‰¹ç‚¹æ˜¯è¦è¿›è¡Œå¤§é‡çš„è®¡ç®—ï¼Œæ¶ˆè€—CPUèµ„æºï¼Œæ¯”å¦‚è®¡ç®—åœ†å‘¨ç‡ã€å¯¹è§†é¢‘è¿›è¡Œé«˜æ¸…è§£ç ç­‰ç­‰ï¼Œå…¨é CPUçš„è¿ç®—èƒ½åŠ›ã€‚è¿™ç§è®¡ç®—å¯†é›†å‹ä»»åŠ¡è™½ç„¶ä¹Ÿå¯ä»¥ç”¨å¤šä»»åŠ¡å®Œæˆï¼Œä½†æ˜¯ä»»åŠ¡è¶Šå¤šï¼ŒèŠ±åœ¨ä»»åŠ¡åˆ‡æ¢çš„æ—¶é—´å°±è¶Šå¤šï¼ŒCPUæ‰§è¡Œä»»åŠ¡çš„æ•ˆç‡å°±è¶Šä½ï¼Œæ‰€ä»¥ï¼Œè¦æœ€é«˜æ•ˆåœ°åˆ©ç”¨CPUï¼Œè®¡ç®—å¯†é›†å‹ä»»åŠ¡åŒæ—¶è¿›è¡Œçš„æ•°é‡åº”å½“ç­‰äºCPUçš„æ ¸å¿ƒæ•°ã€‚</p>
<p>è®¡ç®—å¯†é›†å‹ä»»åŠ¡ç”±äºä¸»è¦æ¶ˆè€—CPUèµ„æºï¼Œå› æ­¤ï¼Œä»£ç è¿è¡Œæ•ˆç‡è‡³å…³é‡è¦ã€‚Pythonè¿™æ ·çš„è„šæœ¬è¯­è¨€è¿è¡Œæ•ˆç‡å¾ˆä½ï¼Œå®Œå…¨ä¸é€‚åˆè®¡ç®—å¯†é›†å‹ä»»åŠ¡ã€‚å¯¹äºè®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œæœ€å¥½ç”¨Cè¯­è¨€ç¼–å†™ã€‚</p>
<p>ç¬¬äºŒç§ä»»åŠ¡çš„ç±»å‹æ˜¯IOå¯†é›†å‹ï¼Œæ¶‰åŠåˆ°ç½‘ç»œã€ç£ç›˜IOçš„ä»»åŠ¡éƒ½æ˜¯IOå¯†é›†å‹ä»»åŠ¡ï¼Œè¿™ç±»ä»»åŠ¡çš„ç‰¹ç‚¹æ˜¯CPUæ¶ˆè€—å¾ˆå°‘ï¼Œä»»åŠ¡çš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ç­‰å¾…IOæ“ä½œå®Œæˆï¼ˆå› ä¸ºIOçš„é€Ÿåº¦è¿œè¿œä½äºCPUå’Œå†…å­˜çš„é€Ÿåº¦ï¼‰ã€‚å¯¹äºIOå¯†é›†å‹ä»»åŠ¡ï¼Œä»»åŠ¡è¶Šå¤šï¼ŒCPUæ•ˆç‡è¶Šé«˜ï¼Œä½†ä¹Ÿæœ‰ä¸€ä¸ªé™åº¦ã€‚å¸¸è§çš„å¤§éƒ¨åˆ†ä»»åŠ¡éƒ½æ˜¯IOå¯†é›†å‹ä»»åŠ¡ï¼Œæ¯”å¦‚Webåº”ç”¨ã€‚</p>
<p>IOå¯†é›†å‹ä»»åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œ99%çš„æ—¶é—´éƒ½èŠ±åœ¨IOä¸Šï¼ŒèŠ±åœ¨CPUä¸Šçš„æ—¶é—´å¾ˆå°‘ï¼Œå› æ­¤ï¼Œç”¨è¿è¡Œé€Ÿåº¦æå¿«çš„Cè¯­è¨€æ›¿æ¢ç”¨Pythonè¿™æ ·è¿è¡Œé€Ÿåº¦æä½çš„è„šæœ¬è¯­è¨€ï¼Œå®Œå…¨æ— æ³•æå‡è¿è¡Œæ•ˆç‡ã€‚å¯¹äºIOå¯†é›†å‹ä»»åŠ¡ï¼Œæœ€åˆé€‚çš„è¯­è¨€å°±æ˜¯å¼€å‘æ•ˆç‡æœ€é«˜ï¼ˆä»£ç é‡æœ€å°‘ï¼‰çš„è¯­è¨€ï¼Œè„šæœ¬è¯­è¨€æ˜¯é¦–é€‰ï¼ŒCè¯­è¨€æœ€å·®ã€‚</p>
<h4 id="å¼‚æ­¥IO"><a href="#å¼‚æ­¥IO" class="headerlink" title="å¼‚æ­¥IO"></a>å¼‚æ­¥IO</h4><p>è€ƒè™‘åˆ°CPUå’ŒIOä¹‹é—´å·¨å¤§çš„é€Ÿåº¦å·®å¼‚ï¼Œä¸€ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ç­‰å¾…IOæ“ä½œï¼Œå•è¿›ç¨‹å•çº¿ç¨‹æ¨¡å‹ä¼šå¯¼è‡´åˆ«çš„ä»»åŠ¡æ— æ³•å¹¶è¡Œæ‰§è¡Œï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æ‰éœ€è¦å¤šè¿›ç¨‹æ¨¡å‹æˆ–è€…å¤šçº¿ç¨‹æ¨¡å‹æ¥æ”¯æŒå¤šä»»åŠ¡å¹¶å‘æ‰§è¡Œã€‚</p>
<p>ç°ä»£æ“ä½œç³»ç»Ÿå¯¹IOæ“ä½œå·²ç»åšäº†å·¨å¤§çš„æ”¹è¿›ï¼Œæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯æ”¯æŒå¼‚æ­¥IOã€‚å¦‚æœå……åˆ†åˆ©ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„å¼‚æ­¥IOæ”¯æŒï¼Œå°±å¯ä»¥ç”¨å•è¿›ç¨‹å•çº¿ç¨‹æ¨¡å‹æ¥æ‰§è¡Œå¤šä»»åŠ¡ï¼Œè¿™ç§å…¨æ–°çš„æ¨¡å‹ç§°ä¸ºäº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼ŒNginxå°±æ˜¯æ”¯æŒå¼‚æ­¥IOçš„WebæœåŠ¡å™¨ï¼Œå®ƒåœ¨å•æ ¸CPUä¸Šé‡‡ç”¨å•è¿›ç¨‹æ¨¡å‹å°±å¯ä»¥é«˜æ•ˆåœ°æ”¯æŒå¤šä»»åŠ¡ã€‚åœ¨å¤šæ ¸CPUä¸Šï¼Œå¯ä»¥è¿è¡Œå¤šä¸ªè¿›ç¨‹ï¼ˆæ•°é‡ä¸CPUæ ¸å¿ƒæ•°ç›¸åŒï¼‰ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸CPUã€‚ç”±äºç³»ç»Ÿæ€»çš„è¿›ç¨‹æ•°é‡ååˆ†æœ‰é™ï¼Œå› æ­¤æ“ä½œç³»ç»Ÿè°ƒåº¦éå¸¸é«˜æ•ˆã€‚ç”¨å¼‚æ­¥IOç¼–ç¨‹æ¨¡å‹æ¥å®ç°å¤šä»»åŠ¡æ˜¯ä¸€ä¸ªä¸»è¦çš„è¶‹åŠ¿ã€‚</p>
<h3 id="åˆ†å¸ƒå¼è¿›ç¨‹"><a href="#åˆ†å¸ƒå¼è¿›ç¨‹" class="headerlink" title="åˆ†å¸ƒå¼è¿›ç¨‹"></a>åˆ†å¸ƒå¼è¿›ç¨‹</h3><p>åœ¨Threadå’ŒProcessä¸­ï¼Œåº”å½“ä¼˜é€‰Processï¼Œå› ä¸ºProcessæ›´ç¨³å®šï¼Œè€Œä¸”ï¼ŒProcesså¯ä»¥åˆ†å¸ƒåˆ°å¤šå°æœºå™¨ä¸Šï¼Œè€ŒThreadæœ€å¤šåªèƒ½åˆ†å¸ƒåˆ°åŒä¸€å°æœºå™¨çš„å¤šä¸ªCPUä¸Šã€‚</p>
<p>Pythonçš„multiprocessingæ¨¡å—ä¸ä½†æ”¯æŒå¤šè¿›ç¨‹ï¼Œå…¶ä¸­managerså­æ¨¡å—è¿˜æ”¯æŒæŠŠå¤šè¿›ç¨‹åˆ†å¸ƒåˆ°å¤šå°æœºå™¨ä¸Šã€‚ä¸€ä¸ªæœåŠ¡è¿›ç¨‹å¯ä»¥ä½œä¸ºè°ƒåº¦è€…ï¼Œå°†ä»»åŠ¡åˆ†å¸ƒåˆ°å…¶ä»–å¤šä¸ªè¿›ç¨‹ä¸­ï¼Œä¾é ç½‘ç»œé€šä¿¡ã€‚ç”±äºmanagersæ¨¡å—å°è£…å¾ˆå¥½ï¼Œä¸å¿…äº†è§£ç½‘ç»œé€šä¿¡çš„ç»†èŠ‚ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°ç¼–å†™åˆ†å¸ƒå¼å¤šè¿›ç¨‹ç¨‹åºã€‚</p>
<p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431929340191970154d52b9d484b88a7b343708fcc60000" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431929340191970154d52b9d484b88a7b343708fcc60000</a></p>
<h2 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h2><p>\d ä¸€ä¸ªæ•°å­—<br>\w ä¸€ä¸ªå­—æ¯æˆ–æ•°å­—<br>.  ä»»æ„å­—ç¬¦<br>\s ä¸€ä¸ªç©ºæ ¼ï¼ˆåŒ…æ‹¬Tabç­‰ç©ºç™½ç¬¦ï¼‰<br>[0-9a-zA-Z_]</p>
<p>è¦åŒ¹é…å˜é•¿çš„å­—ç¬¦ï¼Œåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç”¨*è¡¨ç¤ºä»»æ„ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬0ä¸ªï¼‰ï¼Œç”¨+è¡¨ç¤ºè‡³å°‘ä¸€ä¸ªå­—ç¬¦ï¼Œç”¨?è¡¨ç¤º0ä¸ªæˆ–1ä¸ªå­—ç¬¦ï¼Œç”¨{n}è¡¨ç¤ºnä¸ªå­—ç¬¦ï¼Œç”¨{n,m}è¡¨ç¤ºn~mä¸ªå­—ç¬¦</p>
<p>A|Bå¯ä»¥åŒ¹é…Aæˆ–Bï¼Œæ‰€ä»¥(P|p)ythonå¯ä»¥åŒ¹é…â€™Pythonâ€™æˆ–è€…â€™pythonâ€™ã€‚</p>
<p>^è¡¨ç¤ºè¡Œçš„å¼€å¤´ï¼Œ\^\dè¡¨ç¤ºå¿…é¡»ä»¥æ•°å­—å¼€å¤´ã€‚</p>
<p>$è¡¨ç¤ºè¡Œçš„ç»“æŸï¼Œ\d$è¡¨ç¤ºå¿…é¡»ä»¥æ•°å­—ç»“æŸã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># s = 'ABC\\-001'</span></span><br><span class="line">s = <span class="string">r'ABC\-001'</span> <span class="comment"># Pythonçš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment"># å¯¹åº”çš„æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²ä¸å˜ï¼š</span></span><br><span class="line"><span class="comment"># 'ABC\-001'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">test = <span class="string">'ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²'</span></span><br><span class="line"><span class="keyword">if</span> re.match(<span class="string">r'æ­£åˆ™è¡¨è¾¾å¼'</span>, test):</span><br><span class="line">  print(<span class="string">'ok'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  print(<span class="string">'failed'</span>)</span><br></pre></td></tr></table></figure>
<p>åˆ‡åˆ†å­—ç¬¦ä¸²</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'a b   c'</span>.split(<span class="string">' '</span>)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">'c'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># a better way</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">r'\s+'</span>, <span class="string">'a b   c'</span>)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br></pre></td></tr></table></figure>
<p>åˆ†ç»„</p>
<p>é™¤äº†ç®€å•åœ°åˆ¤æ–­æ˜¯å¦åŒ¹é…ä¹‹å¤–ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¿˜æœ‰æå–å­ä¸²çš„å¼ºå¤§åŠŸèƒ½ã€‚ç”¨()è¡¨ç¤ºçš„å°±æ˜¯è¦æå–çš„åˆ†ç»„ï¼ˆGroupï¼‰ã€‚æ¯”å¦‚ï¼š</p>
<p>^(\d{3})-(\d{3,8})$åˆ†åˆ«å®šä¹‰äº†ä¸¤ä¸ªç»„ï¼Œå¯ä»¥ç›´æ¥ä»åŒ¹é…çš„å­—ç¬¦ä¸²ä¸­æå–å‡ºåŒºå·å’Œæœ¬åœ°å·ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = re.match(<span class="string">r'^(\d&#123;3&#125;)-(\d&#123;3,8&#125;)$'</span>, <span class="string">'010-12345'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m</span><br><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">9</span>), match=<span class="string">'010-12345'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.group(<span class="number">0</span>)</span><br><span class="line"><span class="string">'010-12345'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.group(<span class="number">1</span>)</span><br><span class="line"><span class="string">'010'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.group(<span class="number">2</span>)</span><br><span class="line"><span class="string">'12345'</span></span><br></pre></td></tr></table></figure>
<p>è´ªå©ªåŒ¹é…</p>
<p>æœ€åéœ€è¦ç‰¹åˆ«æŒ‡å‡ºçš„æ˜¯ï¼Œæ­£åˆ™åŒ¹é…é»˜è®¤æ˜¯è´ªå©ªåŒ¹é…ï¼Œä¹Ÿå°±æ˜¯åŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼ŒåŒ¹é…å‡ºæ•°å­—åé¢çš„0ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.match(<span class="string">r'^(\d+)(0*)$'</span>, <span class="string">'102300'</span>).groups()</span><br><span class="line">(<span class="string">'102300'</span>, <span class="string">''</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ ä¸ª?å°±ä¸è´ªå©ªäº†</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.match(<span class="string">r'^(\d+?)(0*)$'</span>, <span class="string">'102300'</span>).groups()</span><br><span class="line">(<span class="string">'1023'</span>, <span class="string">'00'</span>)</span><br></pre></td></tr></table></figure>

        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/handsomecat.jpg" alt="Junhao Wang">
            
              <p class="site-author-name" itemprop="name">Junhao Wang</p>
              <p class="site-description motion-element" itemprop="description">Debug the old world, bug the new world!</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">49</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">114</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://www.facebook.com/chuckwangg" target="_blank" title="Facebook">
                      
                        <i class="fa fa-fw fa-facebook"></i>Facebook</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/junhaowww" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.linkedin.com/in/junhaowww/" target="_blank" title="LinkedIn">
                      
                        <i class="fa fa-fw fa-linkedin"></i>LinkedIn</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.douban.com/people/maodai/" target="_blank" title="è±†ç“£ (Book)">
                      
                        <i class="fa fa-fw fa-book"></i>è±†ç“£ (Book)</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.jianshu.com/u/41865efdad5d/" title="Xiaofud" target="_blank">Xiaofud</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.davex.pw/" title="DaveX" target="_blank">DaveX</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://alexfan.xyz/" title="alexfan.xyz" target="_blank">alexfan.xyz</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Python-åŸºç¡€"><span class="nav-number">1.</span> <span class="nav-text">Python åŸºç¡€</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¼–ç é—®é¢˜"><span class="nav-number">1.1.</span> <span class="nav-text">ç¼–ç é—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tuple-amp-list-amp-dict-amp-set"><span class="nav-number">1.2.</span> <span class="nav-text">tuple &amp; list &amp; dict &amp; set</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡½æ•°"><span class="nav-number">2.</span> <span class="nav-text">å‡½æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å‡½æ•°åå…¶å®å°±æ˜¯æŒ‡å‘ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„å¼•ç”¨ï¼Œå®Œå…¨å¯ä»¥æŠŠå‡½æ•°åèµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œç›¸å½“äºèµ·äº†ä¸ªåˆ«å"><span class="nav-number">2.1.</span> <span class="nav-text">å‡½æ•°åå…¶å®å°±æ˜¯æŒ‡å‘ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„å¼•ç”¨ï¼Œå®Œå…¨å¯ä»¥æŠŠå‡½æ•°åèµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œç›¸å½“äºèµ·äº†ä¸ªåˆ«å</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å‚æ•°æ£€æŸ¥ï¼Œå¦‚æœå‚æ•°ç±»å‹ä¸å¯¹ï¼Œè‡ªå®šä¹‰çš„å‡½æ•°ä¸ä¼šæ£€æŸ¥"><span class="nav-number">2.2.</span> <span class="nav-text">å‚æ•°æ£€æŸ¥ï¼Œå¦‚æœå‚æ•°ç±»å‹ä¸å¯¹ï¼Œè‡ªå®šä¹‰çš„å‡½æ•°ä¸ä¼šæ£€æŸ¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é»˜è®¤å‚æ•°çš„å¤§å‘"><span class="nav-number">2.3.</span> <span class="nav-text">é»˜è®¤å‚æ•°çš„å¤§å‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯å˜å‚æ•°"><span class="nav-number">2.4.</span> <span class="nav-text">å¯å˜å‚æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å…³é”®å­—å‚æ•°ï¼ˆå‚æ•°åæœªå®šï¼‰"><span class="nav-number">2.5.</span> <span class="nav-text">å…³é”®å­—å‚æ•°ï¼ˆå‚æ•°åæœªå®šï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å‚æ•°ç»„åˆ"><span class="nav-number">2.6.</span> <span class="nav-text">å‚æ•°ç»„åˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å°¾é€’å½’"><span class="nav-number">2.7.</span> <span class="nav-text">å°¾é€’å½’</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é«˜çº§ç‰¹æ€§"><span class="nav-number">3.</span> <span class="nav-text">é«˜çº§ç‰¹æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ‡ç‰‡"><span class="nav-number">3.1.</span> <span class="nav-text">åˆ‡ç‰‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿­ä»£"><span class="nav-number">3.2.</span> <span class="nav-text">è¿­ä»£</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ—è¡¨ç”Ÿæˆå¼-Lisp-Comprehensions"><span class="nav-number">3.3.</span> <span class="nav-text">åˆ—è¡¨ç”Ÿæˆå¼ Lisp Comprehensions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç”Ÿæˆå™¨"><span class="nav-number">3.4.</span> <span class="nav-text">ç”Ÿæˆå™¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿­ä»£å™¨"><span class="nav-number">3.5.</span> <span class="nav-text">è¿­ä»£å™¨</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡½æ•°å¼ç¼–ç¨‹"><span class="nav-number">4.</span> <span class="nav-text">å‡½æ•°å¼ç¼–ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#é«˜é˜¶å‡½æ•°"><span class="nav-number">4.1.</span> <span class="nav-text">é«˜é˜¶å‡½æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#map-reduce"><span class="nav-number">4.1.1.</span> <span class="nav-text">map/reduce</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#filter"><span class="nav-number">4.1.2.</span> <span class="nav-text">filter</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ç­›é€‰ç´ æ•°"><span class="nav-number">4.1.2.1.</span> <span class="nav-text">ç­›é€‰ç´ æ•°</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç­›é€‰å›æ•°"><span class="nav-number">4.1.2.2.</span> <span class="nav-text">ç­›é€‰å›æ•°</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sorted"><span class="nav-number">4.1.3.</span> <span class="nav-text">sorted</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿”å›å‡½æ•°"><span class="nav-number">4.2.</span> <span class="nav-text">è¿”å›å‡½æ•° ???</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åŒ¿åå‡½æ•°-lambda"><span class="nav-number">4.3.</span> <span class="nav-text">åŒ¿åå‡½æ•° lambda</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è£…é¥°å™¨"><span class="nav-number">4.4.</span> <span class="nav-text">è£…é¥°å™¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åå‡½æ•°"><span class="nav-number">4.5.</span> <span class="nav-text">åå‡½æ•°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¨¡å—"><span class="nav-number">5.</span> <span class="nav-text">æ¨¡å—</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åŒ…-Package"><span class="nav-number">5.1.</span> <span class="nav-text">åŒ… Package</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯¼å…¥"><span class="nav-number">5.2.</span> <span class="nav-text">å¯¼å…¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½œç”¨åŸŸ"><span class="nav-number">5.3.</span> <span class="nav-text">ä½œç”¨åŸŸ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¨¡å—æœç´¢"><span class="nav-number">5.4.</span> <span class="nav-text">æ¨¡å—æœç´¢</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é¢å‘å¯¹è±¡ç¼–ç¨‹"><span class="nav-number">6.</span> <span class="nav-text">é¢å‘å¯¹è±¡ç¼–ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç±»å’Œå®ä¾‹"><span class="nav-number">6.1.</span> <span class="nav-text">ç±»å’Œå®ä¾‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è®¿é—®é™åˆ¶"><span class="nav-number">6.2.</span> <span class="nav-text">è®¿é—®é™åˆ¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç»§æ‰¿å’Œå¤šæ€"><span class="nav-number">6.3.</span> <span class="nav-text">ç»§æ‰¿å’Œå¤šæ€</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#é™æ€è¯­è¨€-vs-åŠ¨æ€è¯­è¨€"><span class="nav-number">6.3.1.</span> <span class="nav-text">é™æ€è¯­è¨€ vs åŠ¨æ€è¯­è¨€</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è·å–å¯¹è±¡ä¿¡æ¯"><span class="nav-number">6.4.</span> <span class="nav-text">è·å–å¯¹è±¡ä¿¡æ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®ä¾‹å±æ€§å’Œç±»å±æ€§"><span class="nav-number">6.5.</span> <span class="nav-text">å®ä¾‹å±æ€§å’Œç±»å±æ€§</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹"><span class="nav-number">7.</span> <span class="nav-text">é¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨slots"><span class="nav-number">7.1.</span> <span class="nav-text">ä½¿ç”¨slots</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨-property"><span class="nav-number">7.2.</span> <span class="nav-text">ä½¿ç”¨@property</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤šé‡ç»§æ‰¿-MixInè®¾è®¡"><span class="nav-number">7.3.</span> <span class="nav-text">å¤šé‡ç»§æ‰¿ (MixInè®¾è®¡)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MixInè®¾è®¡"><span class="nav-number">7.3.1.</span> <span class="nav-text">MixInè®¾è®¡</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®šåˆ¶ç±»"><span class="nav-number">7.4.</span> <span class="nav-text">å®šåˆ¶ç±»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨æšä¸¾ç±»"><span class="nav-number">7.5.</span> <span class="nav-text">ä½¿ç”¨æšä¸¾ç±»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨å…ƒç±»"><span class="nav-number">7.6.</span> <span class="nav-text">ä½¿ç”¨å…ƒç±»???</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Metaclass"><span class="nav-number">7.6.1.</span> <span class="nav-text">Metaclass</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é”™è¯¯ã€è°ƒè¯•å’Œæµ‹è¯•"><span class="nav-number">8.</span> <span class="nav-text">é”™è¯¯ã€è°ƒè¯•å’Œæµ‹è¯•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#é”™è¯¯å¤„ç†"><span class="nav-number">8.1.</span> <span class="nav-text">é”™è¯¯å¤„ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è®°å½•é”™è¯¯"><span class="nav-number">8.1.1.</span> <span class="nav-text">è®°å½•é”™è¯¯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è‡ªå®šä¹‰æŠ›å‡ºé”™è¯¯"><span class="nav-number">8.1.2.</span> <span class="nav-text">è‡ªå®šä¹‰æŠ›å‡ºé”™è¯¯</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è°ƒè¯•"><span class="nav-number">8.2.</span> <span class="nav-text">è°ƒè¯•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å•å…ƒæµ‹è¯•"><span class="nav-number">8.3.</span> <span class="nav-text">å•å…ƒæµ‹è¯•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ–‡æ¡£æµ‹è¯•-doctest"><span class="nav-number">8.4.</span> <span class="nav-text">æ–‡æ¡£æµ‹è¯• doctest</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IOç¼–ç¨‹"><span class="nav-number">9.</span> <span class="nav-text">IOç¼–ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ–‡ä»¶è¯»å–"><span class="nav-number">9.1.</span> <span class="nav-text">æ–‡ä»¶è¯»å–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#StringIOå’ŒBytesIO"><span class="nav-number">9.2.</span> <span class="nav-text">StringIOå’ŒBytesIO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ“ä½œæ–‡ä»¶å’Œç›®å½•"><span class="nav-number">9.3.</span> <span class="nav-text">æ“ä½œæ–‡ä»¶å’Œç›®å½•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åºåˆ—åŒ–"><span class="nav-number">9.4.</span> <span class="nav-text">åºåˆ—åŒ–</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è¿›ç¨‹å’Œçº¿ç¨‹"><span class="nav-number">10.</span> <span class="nav-text">è¿›ç¨‹å’Œçº¿ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤šè¿›ç¨‹"><span class="nav-number">10.1.</span> <span class="nav-text">å¤šè¿›ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Pool"><span class="nav-number">10.1.1.</span> <span class="nav-text">Pool</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è¿›ç¨‹é—´é€šä¿¡"><span class="nav-number">10.1.2.</span> <span class="nav-text">è¿›ç¨‹é—´é€šä¿¡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¤–éƒ¨å­è¿›ç¨‹"><span class="nav-number">10.1.3.</span> <span class="nav-text">å¤–éƒ¨å­è¿›ç¨‹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤šçº¿ç¨‹"><span class="nav-number">10.2.</span> <span class="nav-text">å¤šçº¿ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Lock"><span class="nav-number">10.2.1.</span> <span class="nav-text">Lock</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ThreadLocal"><span class="nav-number">10.3.</span> <span class="nav-text">ThreadLocal</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿›ç¨‹-vs-çº¿ç¨‹"><span class="nav-number">10.4.</span> <span class="nav-text">è¿›ç¨‹ vs. çº¿ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è¿›ç¨‹-vs-çº¿ç¨‹-1"><span class="nav-number">10.4.1.</span> <span class="nav-text">è¿›ç¨‹ vs. çº¿ç¨‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è®¡ç®—å¯†é›†å‹-vs-IOå¯†é›†å‹"><span class="nav-number">10.4.2.</span> <span class="nav-text">è®¡ç®—å¯†é›†å‹ vs. IOå¯†é›†å‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¼‚æ­¥IO"><span class="nav-number">10.4.3.</span> <span class="nav-text">å¼‚æ­¥IO</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ†å¸ƒå¼è¿›ç¨‹"><span class="nav-number">10.5.</span> <span class="nav-text">åˆ†å¸ƒå¼è¿›ç¨‹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ­£åˆ™è¡¨è¾¾å¼"><span class="nav-number">11.</span> <span class="nav-text">æ­£åˆ™è¡¨è¾¾å¼</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Junhao Wang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>








        
<div class="busuanzi-count">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://junhaow.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://www.junhaow.com/studynotes/python/Python å»–é›ªå³°ç½‘ç«™å­¦ä¹ ç¬”è®°.html';
          this.page.identifier = 'studynotes/python/Python å»–é›ªå³°ç½‘ç«™å­¦ä¹ ç¬”è®°.html';
          this.page.title = 'Python å»–é›ªå³°ç½‘ç«™å­¦ä¹ ç¬”è®°';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://junhaow.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
    
      flOptions = {};
      
          flOptions.iconStyle = "box";
      
          flOptions.boxForm = "horizontal";
      
          flOptions.position = "middleRight";
      
          flOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

  

  
  


  

  


</body>
</html>
